# Warmup

## Encoding

### Description

I have no idea what this message means, can you help me decipher it? ðŸ‘¨â€ðŸ’»

`Author: CryptoCat`

[enc.txt](https://ctf.intigriti.io/files/9bb365164e20069ff325786db4428ef9/enc.txt?token=eyJ1c2VyX2lkIjo2MzksInRlYW1faWQiOjQ2NiwiZmlsZV9pZCI6MTl9.ZVsL_A.2HsIA-v2yoWpArTjPU3PC92VkAk)

### Solution

Given encryption: 

```
EUZEKJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERJFGJCSKMSEEUZEIJJSGASTERJFGJCSKMSFEUZEKJJSIUSTEMBFGJCSKMSFEUZEKJJSIUSTERJFGIYCKMSFEUZEKJJSIUSTERBFGJCCKMRQEUZEKJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERJFGJCSKMSFEUZEKJJSGASTERJFGJCSKMSFEUZEKJJSIUSTEMBFGJCSKMSFEUZEKJJSIUSTERJFGIYCKMSFEUZEKJJSIUSTERBFGJCCKMRQEUZEKJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERJFGJCSKMSFEUZEKJJSGASTERBFGJCSKMSFEUZEKJJSIUSTEMBFGJCSKMSFEUZEKJJSIUSTERBFGIYCKMSFEUZEKJJSIUSTERJFGJCSKMRQEUZEKJJSIUSTERJFGJCCKMSEEUZDAJJSIUSTERJFGJCSKMSFEUZEKJJSGASTERJFGJCSKMSFEUZEIJJSIQSTEMBFGJCSKMSFEUZEKJJSIUSTERJFGIYCKMSEEUZEKJJSIUSTERJFGJCSKMRQEUZEKJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERJFGJCCKMSEEUZEIJJSGASTERJFGJCSKMSFEUZEKJJSIQSTEMBFGJCSKMSEEUZDAJJSIQSTERJFGJCSKMSFEUZEKJJSGASTERJFGJCSKMSFEUZEKJJSIUSTEMBFGJCCKMSEEUZEKJJSIUSTERJFGIYCKMSFEUZEIJJSGASTERBFGJCSKMSFEUZEKJJSIUSTEMBFGJCSKMSFEUZEKJJSIUSTERBFGIYCKMSEEUZEKJJSIUSTERJFGJCSKMRQEUZEKJJSIUSTERBFGJCSKMRQEUZEKJJSIUSTERJFGJCSKMSEEUZDAJJSIUSTEMBFGJCSKMSFEUZEKJJSIUSTERBFGIYCKMSFEUZEKJJSIUSTERJFGJCCKMRQEUZEIJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERJFGJCSKMSFEUZEIJJSGASTERBFGJCSKMSFEUZEKJJSIUSTEMBFGJCCKMSFEUZEKJJSIUSTERJFGIYCKMSEEUZEKJJSIUSTERJFGJCSKMRQEUZEKJJSIUSTERJFGJCSKMSEEUZDAJJSIQSTERBFGJCSKMSFEUZEKJJSGASTERJFGJCCKMRQEUZEKJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERBFGJCCKMSEEUZEIJJSGASTERJFGJCSKMSFEUZEIJJSIQSTEMBFGJCSKMSEEUZEIJJSIQSTERBFGIYCKMSFEUZEKJJSIUSTERJFGJCSKMRQEUZEIJJSIQSTERBFGJCSKMSFEUZDAJJSIQSTERBFGJCSKMSFEUZEKJJSGASTERJFGJCCKMRQEUZEKJJSIUSTERJFGJCSKMSEEUZDAJJSIQSTERJFGJCSKMRQEUZEKJJSIUSTERJFGJCCKMSEEUZDAJJSIQSTERBFGJCCKMSEEUZEIJJSGASTERJFGJCSKMSFEUZEKJJSIQSTEMBFGJCSKMRQEUZEKJJSIUSTERJFGJCSKMSFEUZDAJJSIQSTERBFGJCCKMSFEUZEKJJSGASTERBFGJCSKMSFEUZEKJJSIUSTEMBFGJCCKMSFEUZEIJJSIUSTEMBFGJCCKMSFEUZEKJJSIUSTERJFGIYCKMSEEUZEKJJSIUSTERJFGJCSKMRQEUZEIJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERJFGJCSKMSEEUZEIJJSGASTERBFGJCSKMSFEUZEKJJSIUSTEMBFGJCSKMSEEUZDAJJSIUSTERJFGJCSKMSFEUZEIJJSGASTERJFGJCSKMSFEUZEKJJSIUSTEMBFGJCSKMSFEUZEKJJSIQSTERBFGIYCKMSFEUZEKJJSIQSTERBFGJCCKMRQEUZEIJJSIUSTERJFGJCSKMSFEUZDAJJSIUSTERBFGJCCKMSEEUZEIJJSGASTERJFGJCSKMSFEUZEKJJSIQSTEMBFGJCSKMSFEUZEKJJSIUSTERBFGIYCKMSEEUZEKJJSIUSTERJFGJCSKMRQEUZEKJJSIUSTERJFGJCCKMSEEUZDAJJSIUSTERJFGJCCKMSEEUZEIJJSGASTERJFGJCSKMSEEUZEKJJSGASTERBFGJCSKMSFEUZEKJJSIUSTEMBFGJCCKMSFEUZEKJJSIUSTERJFGIYCKMSFEUZEKJJSIUSTERJFGJCSKMRQEUZEKJJSIQSTERBFGJCCKMSEEUZDAJJSIUSTERJFGJCSKMSEEUZEIJJSGASTERBFGJCSKMSFEUZDAJJSIUSTERJFGJCSKMSEEUZEIJJSGASTERBFGJCSKMSF
```

Cyberchef Magic [recipe](https://gchq.github.io/CyberChef/#recipe=Magic(3,false,false,'')&input=RVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJCRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJCRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNJUVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJUVNURU1CRkdKQ1NLTVNFRVVaREFKSlNJUVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNFRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJCRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNFRVVaREFKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVJRRVVaRUlKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNFRVVaREFKSlNJUVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJCRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNJUVNURU1CRkdKQ1NLTVNFRVVaRUlKSlNJUVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUlKSlNJUVNURVJCRkdKQ1NLTVNGRVVaREFKSlNJUVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNFRVVaREFKSlNJUVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVNFRVVaREFKSlNJUVNURVJCRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJUVNURU1CRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJUVNURVJCRkdKQ0NLTVNGRVVaRUtKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUlKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUlKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJUVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJUVNURVJCRkdKQ0NLTVJRRVVaRUlKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJCRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJUVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNFRVVaRUtKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJUVNURVJCRkdKQ0NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNG) shows that its most likely `Base32 -> URLDecode -> Morse Decode`

![encoding-1](/assets/ctf/intigriti/encoding-1.png)

Decode Hex -> Base64 -> Flag. [Final Recipe](https://gchq.github.io/CyberChef/#recipe=From_Base32('A-Z2-7%3D',false)URL_Decode()From_Morse_Code('Space','Line%20feed')From_Hex('Auto')From_Base64('A-Za-z0-9%2B/%3D',true,false)&input=RVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJCRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJCRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNJUVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJUVNURU1CRkdKQ1NLTVNFRVVaREFKSlNJUVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNFRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJCRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNFRVVaREFKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVJRRVVaRUlKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNFRVVaREFKSlNJUVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJCRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNJUVNURU1CRkdKQ1NLTVNFRVVaRUlKSlNJUVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUlKSlNJUVNURVJCRkdKQ1NLTVNGRVVaREFKSlNJUVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNHQVNURVJKRkdKQ0NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNFRVVaREFKSlNJUVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVNFRVVaREFKSlNJUVNURVJCRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJUVNURU1CRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJUVNURVJCRkdKQ0NLTVNGRVVaRUtKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUlKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUlKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNGRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJUVNURVJCRkdJWUNLTVNGRVVaRUtKSlNJUVNURVJCRkdKQ0NLTVJRRVVaRUlKSlNJVVNURVJKRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJCRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNGRVVaRUtKSlNJUVNURU1CRkdKQ1NLTVNGRVVaRUtKSlNJVVNURVJCRkdJWUNLTVNFRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJVVNURVJKRkdKQ0NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ0NLTVNFRVVaRUlKSlNHQVNURVJKRkdKQ1NLTVNFRVVaRUtKSlNHQVNURVJCRkdKQ1NLTVNGRVVaRUtKSlNJVVNURU1CRkdKQ0NLTVNGRVVaRUtKSlNJVVNURVJKRkdJWUNLTVNGRVVaRUtKSlNJVVNURVJKRkdKQ1NLTVJRRVVaRUtKSlNJUVNURVJCRkdKQ0NLTVNFRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNGRVVaREFKSlNJVVNURVJKRkdKQ1NLTVNFRVVaRUlKSlNHQVNURVJCRkdKQ1NLTVNG)

![encoding-2](/assets/ctf/intigriti/encoding-2.png)
::: tip Flag
`INTIGRITI{7h47_w45_345y_r16h7?}`
:::

## Flag Extraction

### Description

They told me I just need to extract flag but I don't know what that means?!

`Author: CryptoCat`

[flag.rar](https://ctf.intigriti.io/files/14b7f59f7f7d5f501ece1e57fa3b7add/flag.rar?token=eyJ1c2VyX2lkIjo2MzksInRlYW1faWQiOjQ2NiwiZmlsZV9pZCI6NDF9.ZVsnWg.7GotJz-WDHzQ6pHGLhXjOQLQgdE)

### Solution

Given `rar` contains different types of zip files which you should extract, I used `7zip` to easily dig the zip.

Path to last file: 
```
Flag Extraction
|_flag.rar
|___flag.tar.xz
|_____flag.tar
|_______flag.tar.bz2
|_________flag.tar
|___________flag.tar.gz
|_____________flag.tar
|_______________flag.zip
|_________________flag.gif
```

```bash
$ strings .\flag.gif | grep INTIGRITI

INTIGRITI{fl46_3x7r4c710n_c0mpl373}
```
::: tip Flag
`INTIGRITI{fl46_3x7r4c710n_c0mpl373}`
:::

## Over the Wire (part 1)

### Description

I'm not sure how secure this protocol is but as long as we update the password, I'm sure everything will be fine ðŸ˜Š

`Author: CryptoCat`

[otw_pt1.pcapng](https://ctf.intigriti.io/files/d9f2b65087ea8a737caf3ccbe3d7739e/otw_pt1.pcapng?token=eyJ1c2VyX2lkIjo2MzksInRlYW1faWQiOjQ2NiwiZmlsZV9pZCI6Mjh9.ZVsp6g.LKSE2A9ZdJK_Wne1fp43wBnKLsI)

### Solution

First of all review the protocol hierarchy:

![overthewire-1-1](/assets/ctf/intigriti/overthewire-1-1.png)

FTP traffic looks interesting. Filter for `ftp` -> Follow TCP Stream (first ftp packet) -> 

```bash
220 pyftpdlib 1.5.9 ready.
USER cat
331 Username ok, send password.
PASS 5up3r_53cur3_p455w0rd_2022
230 Login successful.
SYST
215 UNIX Type: L8
PORT 192,168,16,131,179,47
200 Active data connection established.
LIST
125 Data connection already open. Transfer starting.
226 Transfer complete.
TYPE I
200 Type set to: Binary.
PORT 192,168,16,131,203,181
200 Active data connection established.
RETR flag.zip
125 Data connection already open. Transfer starting.
226 Transfer complete.
PORT 192,168,16,131,132,11
200 Active data connection established.
RETR reminder.txt
125 Data connection already open. Transfer starting.
226 Transfer complete.
PORT 192,168,16,131,162,139
200 Active data connection established.
RETR README.md
125 Data connection already open. Transfer starting.
226 Transfer complete.
QUIT
221 Goodbye.
```

Wireshark didnt have the zip file in Export Objects, so we have to manually find it.

Filter for packets after `flag.zip` was requested via ftp.

`frame.number >= 1927`

![overthewire-1-2](/assets/ctf/intigriti/overthewire-1-2.png)

File starts with `PK` meaning its a zip file. 
::: info :information_source:
[Magic Bytes (or File Signatures)](https://www.wikiwand.com/en/List_of_file_signatures)
:::

I viewed it as `yaml` which gives binary as Base64.

![overthewire-1-3](/assets/ctf/intigriti/overthewire-1-3.png)

```bash
â””â”€$ cat flag.zip.base64 | base64 -d -i > flag.zip

â””â”€$ unzip -P 5up3r_53cur3_p455w0rd_2022 flag.zip
Archive:  flag.zip
   skipping: flag.txt                incorrect password     
```

Using FTP password didnt work.

FTP had a `remainded.txt`, let's take a look:

```
Hi cat,

This flag is really important so I had to encrypt it in case it falls into the wrong hands.

You already know the FTP password.. Just use the same here, but update it accordingly ;)
```

```bash
â””â”€$ unzip -P 5up3r_53cur3_p455w0rd_2023 flag.zip
Archive:  flag.zip
 extracting: flag.txt   

â””â”€$ cat flag.txt 
INTIGRITI{1f_0nly_7h3r3_w45_4_53cur3_FTP}
```
::: tip Flag
`INTIGRITI{1f_0nly_7h3r3_w45_4_53cur3_FTP}`
:::

## Over the Wire (part 2)

### Description

Learning the lessons from the previous failed secure file transfer attempts, CryptoCat and 0xM4hm0ud found a new [definitely secure] way to share information ðŸ˜Š

`Author: 0xM4hm0ud`

[otw_pt2.pcapng](https://ctf.intigriti.io/files/5eae9a3d5e1fc8ca9d659131e211b2b0/otw_pt2.pcapng?token=eyJ1c2VyX2lkIjo2MzksInRlYW1faWQiOjQ2NiwiZmlsZV9pZCI6MzF9.ZVsweg.LHp7IzZ0MM71jqSyi0eVsb-nSuA)

### Solution

Protocol hierarchy:

![overthewire-2-1](/assets/ctf/intigriti/overthewire-2-1.png)

Viewing `smtp` packets we see some convesation in plaintext. We can export all objects using `File -> Export Objects -> IMF`

![overthewire-2-2](/assets/ctf/intigriti/overthewire-2-2.png)

In the last conversation CryptoCat sends says:

```
Hey 0xM4hm0ud,

I love all kind of cats, but I prefer this cat. 

CryptoCat
```

Decode the image:

```bash
â””â”€$ cat cat.png.base64 | base64 -d -i > cat.png
```

![overthewire-2-cat](/assets/ctf/intigriti/overthewire-2-cat.png)

```bash
â””â”€$ strings cat.png | grep INTI -i
                                                                                                            
â””â”€$ zsteg cat.png 
imagedata           .. file: Tower/XP rel 2 object not stripped - version 258
b1,r,msb,xy         .. file: OpenPGP Public Key
b1,rgb,lsb,xy       .. text: "INTIGRITI{H1dd3n_Crypt0Cat_Purr}\n"
b1,rgba,lsb,xy      .. text: "YUY{UU[S3}"
b4,r,lsb,xy         .. text: "34TBEDVF"
b4,g,lsb,xy         .. text: "hwwhwfwVfVFwh"
b4,b,lsb,xy         .. text: "#\"3#!#2#EUDEeDvgdR\r"
b4,rgb,msb,xy       .. text: "O|\"(Bj(\n"
b4,bgr,msb,xy       .. text: "|L(B\"h\n*"
b4,rgba,lsb,xy      .. text: "?y/i?h?yOx?x?x?F"
b4,abgr,msb,xy      .. text: "o</<o|oz/z"
```
::: tip Flag
`INTIGRITI{H1dd3n_Crypt0Cat_Purr}`
:::