# 005

## Description

Hey! I got the /etc/shadow file from the machine, but I don't know how to crack the root password. 

> I think it is the flag in `HMV{rootpassword}` format.

[Download](https://downloads.hackmyvm.eu/challenges/005.zip)

## Solution

```powershell
➜ curl -LOs https://downloads.hackmyvm.eu/challenges/005.zip       
➜ 7z x .\005.zip
➜ ((cat .\shadow.txt) -match "^root:") -split ":" | select -Index 1 | tee -filepath "\Users\Public\hashes.txt"
$6$xyz$ZGQOqL77wiYAgPxsNEv2Kz3INjzK4JdG29RbaHaW5lrkH8bA8W7kC3GK4CctGrFO7.E2va7kSgF3eQXNWYQee.

➜ vim C:\Program Files\john-1.9.0-jumbo-1-win64\run\john-local.conf
...
[List.Rules:HMV]
A0"HVM{" Az"}"
...

➜ john.exe --wordlist=\Users\Public\sample.txt --rules=HMV --stdout | select -First 10
Using default input encoding: UTF-8
Press 'q' or Ctrl-C to abort, almost any other key for status 
50p 0:00:00:00 100.00% (2025-08-22 18:26) 657.8p/s HVM{hannah}
HVM{123456}
HVM{12345}
HVM{123456789}
HVM{password}
HVM{iloveyou}
HVM{princess}
HVM{1234567} 
HVM{rockyou} 
HVM{12345678}
HVM{abc123}  

➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt --rules=HMV         
Warning: detected hash type "sha512crypt", but the string is also recognized as "sha512crypt-opencl"
Use the "--format=sha512crypt-opencl" option to force loading these as that type instead       
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:04:53 7.44% (ETA: 19:32:35) 0g/s 3626p/s 3626c/s 3626C/s HVM{888188}..HVM{852456000}
0g 0:00:05:16 7.99% (ETA: 19:32:52) 0g/s 3613p/s 3613c/s 3613C/s HVM{yungluv06}..HVM{ysidora1}
0g 0:00:05:49 8.69% (ETA: 19:33:49) 0g/s 3568p/s 3568c/s 3568C/s HVM{sweet890}..HVM{suzieq28}
Session aborted
```

> [John: Wordlist rules syntax](https://www.openwall.com/john/doc/RULES.shtml)

I read the task wrong, I thought the password was surrounded with `HMV`... but nope
```
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt            
Warning: detected hash type "sha512crypt", but the string is also recognized as "sha512crypt-opencl"
Use the "--format=sha512crypt-opencl" option to force loading these as that type instead       
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
reddragon        (?)
1g 0:00:00:02 DONE (2025-08-22 18:32) 0.3542g/s 3627p/s 3627c/s 3627C/s robinhood..11221122    
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

> Flag: `HMV{reddragon}`