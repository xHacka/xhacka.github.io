# Transmission

## Recon

::: details nmap_scan.log
```log
Open 10.0.2.29:22
Open 10.0.2.29:80
Open 10.0.2.29:8080
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.29

PORT     STATE SERVICE    REASON  VERSION
22/tcp   open  ssh        syn-ack OpenSSH 9.9 (protocol 2.0)
| ssh-hostkey: 
|   256 7b:35:dc:60:ae:a2:6d:79:b2:0a:bc:4c:0b:39:89:9e (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBB4NxOqxe8+dcHrR4spEEPII1qK4E2KSlJ+RCnObsTy0yCJhJPC/XHCfLp0eXGtgHHhdaZvc/LQh4MR66r7eoc=
|   256 8f:0f:96:f1:85:49:ca:22:f5:bb:29:6e:e5:02:21:7c (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFv+mhKTnJ0mdUC41wzvMJSbp0LVI3LIwNw4yKHGnXwR
80/tcp   open  http       syn-ack OpenResty web app server 1.27.1.2
|_http-server-header: openresty/1.27.1.2
|_http-favicon: Unknown favicon MD5: 452ECFBF499875298D3EA5E0256A704D
|_http-generator: NexusPHP
| http-title: The Secret Garden :: Login - Powered by NexusPHP
|_Requested resource was http://10.0.2.29/login.php
| http-methods: 
|_  Supported Methods: GET HEAD POST
8080/tcp open  http-proxy syn-ack WebSockify Python/3.11.2
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: WebSockify Python/3.11.2
|_http-title: noVNC
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 200 OK
|     Server: WebSockify Python/3.11.2
|     Date: Sun, 31 Aug 2025 07:38:26 GMT
|     Content-type: text/html
|     Content-Length: 17810
|     Last-Modified: Wed, 07 May 2025 10:32:11 GMT
|     <!DOCTYPE html>
|     <html lang="en" class="noVNC_loading">
|     <head>
|     <!--
|     noVNC example: simple example using default UI
|     Copyright (C) 2019 The noVNC authors
|     noVNC is licensed under the MPL 2.0 (see LICENSE.txt)
|     This file is licensed under the 2-Clause BSD license (see LICENSE.txt).
|     Connect parameters are provided in query string:
|     http://example.com/?host=HOST&port=PORT&encrypt=1
|     fragment:
|     http://example.com/#host=HOST&port=PORT&encrypt=1
|     <title>noVNC</title>
|     <link rel="icon" type="image/x-icon" href="app/images/icons/novnc.ico">
|     <meta name="theme-color" content="#313131">
|     <!-- Apple iOS Safari settings -->
|     <meta name="viewport" con
|   HTTPOptions: 
|     HTTP/1.1 501 Unsupported method ('OPTIONS')
|     Server: WebSockify Python/3.11.2
|     Date: Sun, 31 Aug 2025 07:38:27 GMT
|     Connection: close
|     Content-Type: text/html;charset=utf-8
|     Content-Length: 360
|     <!DOCTYPE HTML>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error response</title>
|     </head>
|     <body>
|     <h1>Error response</h1>
|     <p>Error code: 501</p>
|     <p>Message: Unsupported method ('OPTIONS').</p>
|     <p>Error code explanation: 501 - Server does not support this operation.</p>
|     </body>
|_    </html>
```
:::

## HTTP (80) (Recon)

The HTTP is serving a file sharing software, we only have 10 valid guesses until we are banned..

![writeup.png](/assets/pentest/hackmyvm/transmission/writeup.png)

Registration is disabled

![writeup-1.png](/assets/pentest/hackmyvm/transmission/writeup-1.png)

Potential username: `lilix`. The page has a search bar, but doesn't seem SQL injectable.

![writeup-2.png](/assets/pentest/hackmyvm/transmission/writeup-2.png)

Backend is NexusPHP version 1.9.6 which doesn't seem to have any public CVEs right now.

![writeup-3.png](/assets/pentest/hackmyvm/transmission/writeup-3.png)

## HTTP (8080)

This port is running VNC server which connects us to a docker container as `user`

![writeup-4.png](/assets/pentest/hackmyvm/transmission/writeup-4.png)

### Root

I thought I had to do a Docker Breakout, but nope. There's a Python binary with SUID bit set 

![writeup-5.png](/assets/pentest/hackmyvm/transmission/writeup-5.png)

[https://gtfobins.github.io/gtfobins/python/#suid](https://gtfobins.github.io/gtfobins/python/#suid)

Brainfuck indeed... The copy/paste doesn't work from or to VNC so this is going to be a hassle...................

![writeup-6.png](/assets/pentest/hackmyvm/transmission/writeup-6.png)

### Exfiltrate Secret

Either I had to write script inside and debug or minimize the file as much as possible and extract it

![writeup-7.png](/assets/pentest/hackmyvm/transmission/writeup-7.png)

Using [https://www.imagetotext.info](https://www.imagetotext.info) I was able to extract without too much hassle, only thing was that it couldn't differentiate between 0 (zero) and O (big o) so had  to proof check that.

```bash
H4sIAAAAAAACA+1WCw7DIAg9kJETmF5k2f2vMX8UUMS2WbZm0yzpAkUe8KA4V87Db/WfC8/NQRDSJKqnaKoiv+rjAa5JgqghGZNX
XX4KJfce7Q6bcltXvfZQrsIInRlaeWlLpixXlLCiRhXYweG9RVWkBkjmKv5aU5gEcXtP3FSy0zak8iGaDNKA2LIGI2KO27Kf5JPK
BifJ7OV9dqzAK5KromBsW2SWmg5JR3sPE+7/5/xQEg12dc3y2hW8SvOua5trNKAmSqWkfSOJdladaoPwzMj4wKw+154/wUE1JWEw
JvJ9gO1spBwuntA41aZS63rSPPg6NxvN5xGziufyhH0YT3gHpFHi4SHsdg34ES7ALwKYNwzDAvqwgIhAB2JFcdWQipkySulMSXOH
86Ky/XYEXZ/PtX6v9Xut329cv60JshbjtRivxfhbi3F4AXFnxIdxEwAA
```

![writeup-8.png](/assets/pentest/hackmyvm/transmission/writeup-8.png)

[https://www.dcode.fr/brainfuck-language](https://www.dcode.fr/brainfuck-language)

```
# Transalted from French
Absorb what it is, world, world, miserable and fortunate
Absorb what you desire to become, that's what you are

=============================================================

lilix:32691ca63c0677d0394b7e746569423c

==============================================================

Absorb what it is, world, world, miserable and fortunate
What you desire to become, that's what you is
```

Either we are given a password hash or password itself, because hash is not in rockyou, crackstation, cmd5 or md5hashing databases.

### Alternative Exfiltration

I later learned that there was a `qr` binary which can transform STDIN to QR codes. Screenshot -> [https://qrcode-decoder.com](https://qrcode-decoder.com) -> Decode Base64 -> Decode Gzip -> Decode Brainfuck

![writeup-12.png](/assets/pentest/hackmyvm/transmission/writeup-12.png)

## HTTP (80)

> Creds: `lilix:32691ca63c0677d0394b7e746569423c`

It said `lilix` user is disabled, but we are able to login with following credentials.

![writeup-9.png](/assets/pentest/hackmyvm/transmission/writeup-9.png)

In subtitles we can see example torrent view

![writeup-10.png](/assets/pentest/hackmyvm/transmission/writeup-10.png)

Fuzz for IDOR

```bash
└─$ ffuf -u 'http://transmittion.hmv/details.php?id=FUZZ' -w <(seq 1 50) -b 'c_secure_pass=eyJ1c2VyX2lkIjoiMTAwMDIiLCJleHBpcmVzIjoxNzg4MTY2ODI0fS42MDA5MTY0MTI0NjE0YTMzNGY1MTNmNTk3N2UyODQzMmRiMjI1NTZlMjllMGU0MmQ4ZTk3MGQ5ZGM3NmIzNWIy' -fw 739
4                       [Status: 200, Size: 20478, Words: 1456, Lines: 104, Duration: 368ms]
5                       [Status: 200, Size: 20481, Words: 1455, Lines: 104, Duration: 583ms]
```

![writeup-11.png](/assets/pentest/hackmyvm/transmission/writeup-11.png)

Sooo I have been trying to download the torrents from server, but nothing was working. Later on I realized that if there's no seeders you can never download from server...
```bash
└─$ sudo apt install transmission-cli -y
# └─$ sed -i 's/192.168.11.34/10.0.2.29/g' *.torrent # Doesnt work!
└─$ transmission-edit '[Nexus].pass.txt.torrent' -s 10.0.2.29 -r 192.168.11.34 10.0.2.29
[Nexus].pass.txt.torrent
        Replaced in 'announce': 'http://192.168.11.34//announce.php?passkey=a526a6a590d4dfdaafa838ecbb52fa7a' --> 'http://10.0.2.29//announce.php?passkey=a526a6a590d4dfdaafa838ecbb52fa7a'
        Added '10.0.2.29' as source
Changed 1 files
```

We can't download the torrents so let's fuzz for something we can maybe target
```bash
└─$ feroxbuster -u http://transmittion.hmv/ -w /usr/share/seclists/Discovery/Web-Content/common.txt --thorough -D -C 404,400,403 --dont-scan js,css,png,jpeg,jpg,gif -n -x .php -b 'c_secure_pass=eyJ1c2VyX2lkIjoiMTAwMDIiLCJleHBpcmVzIjoxNzg4MTY2ODI0fS42MDA5MTY0MTI0NjE0YTMzNGY1MTNmNTk3N2UyODQzMmRiMjI1NTZlMjllMGU0MmQ4ZTk3MGQ5ZGM3NmIzNWIy'
200      GET        0l        0w        0c http://transmittion.hmv/edit.php
200      GET        0l        0w        0c http://transmittion.hmv/ok.php
200      GET        0l        0w        0c http://transmittion.hmv/suggest.php
200      GET        0l        0w     1183c http://transmittion.hmv/web.config
200      GET        1l        1w        5c http://transmittion.hmv/bookmark.php
200      GET        1l        2w       14c http://transmittion.hmv/image.php
200      GET        1l        2w       14c http://transmittion.hmv/location.php
200      GET        1l        2w       15c http://transmittion.hmv/torrentrss.php
200      GET        1l        3w       18c http://transmittion.hmv/downloadsubs.php
200      GET        1l        3w       24c http://transmittion.hmv/cron.php
200      GET        1l        3w       99c http://transmittion.hmv/ajax.php
200      GET        1l       10w    46015c http://transmittion.hmv/pic/misc/qBittorrent.ico
200      GET        1l       15w     8820c http://transmittion.hmv/favicon.ico
200      GET        1l      319w     4677c http://transmittion.hmv/pic/misc/chrome-logo.svg
200      GET        1l      838w    10572c http://transmittion.hmv/pic/misc/firefox-logo.svg
200      GET        2l        3w       24c http://transmittion.hmv/robots.txt
200      GET        2l       10w      117c http://transmittion.hmv/preview.php
200      GET        9l       28w      513c http://transmittion.hmv/fun.php
200      GET       11l       53w      824c http://transmittion.hmv/attachment.php
200      GET       11l       83w     1117c http://transmittion.hmv/invite.php
200      GET       24l      159w    14927c http://transmittion.hmv/flvplayer.swf
200      GET       33l       83w     7359c http://transmittion.hmv/opensearch.php
200      GET       43l       80w     1449c http://transmittion.hmv/shoutbox.php
200      GET       81l      413w     6514c http://transmittion.hmv/comment.php
200      GET       82l      415w     6543c http://transmittion.hmv/donated.php
200      GET       82l      415w     6543c http://transmittion.hmv/warned.php
200      GET       82l      415w     6544c http://transmittion.hmv/report.php
200      GET       82l      415w     6544c http://transmittion.hmv/report.php
200      GET       82l      415w     6547c http://transmittion.hmv/fields.php
200      GET       82l      415w     6547c http://transmittion.hmv/linksmanage.php
200      GET       82l      415w     6547c http://transmittion.hmv/settings.php
200      GET       82l      415w     6547c http://transmittion.hmv/stats.php
200      GET       82l      416w     6548c http://transmittion.hmv/thanks.php
200      GET       82l      416w     6564c http://transmittion.hmv/bitbucket-upload.php
200      GET       82l      416w     6564c http://transmittion.hmv/uploaders.php
200      GET       82l      417w     6552c http://transmittion.hmv/magic.php
200      GET       82l      417w     6567c http://transmittion.hmv/reset.php
200      GET       82l      418w     6567c http://transmittion.hmv/claim.php
200      GET       82l      419w     6569c http://transmittion.hmv/login.php
200      GET       82l      419w     6569c http://transmittion.hmv/signup.php
200      GET       82l      420w     6573c http://transmittion.hmv/donate.php
200      GET       82l      423w     6589c http://transmittion.hmv/sendmessage.php
200      GET       82l      423w     6589c http://transmittion.hmv/userhistory.php
200      GET       82l      447w     6817c http://transmittion.hmv/upload.php
200      GET       82l      449w     6814c http://transmittion.hmv/reports.php
200      GET       82l      449w     6814c http://transmittion.hmv/reports.php
200      GET       82l      449w     6814c http://transmittion.hmv/staff.php
200      GET       82l      449w     6822c http://transmittion.hmv/delete.php
200      GET       82l      449w     6822c http://transmittion.hmv/news.php
200      GET       82l      450w     6815c http://transmittion.hmv/users.php
200      GET       82l      451w     6820c http://transmittion.hmv/log.php
200      GET       83l      420w     6642c http://transmittion.hmv/offers.php
200      GET       83l      428w     6684c http://transmittion.hmv/details.php
200      GET       83l      428w     6684c http://transmittion.hmv/userdetails.php
200      GET       84l      455w     7127c http://transmittion.hmv/friends.php
200      GET       84l      457w     6952c http://transmittion.hmv/forums.php
200      GET       89l      431w     6693c http://transmittion.hmv/staffbox.php
200      GET       91l      450w     6926c http://transmittion.hmv/search.php
200      GET       93l     2021w    22178c http://transmittion.hmv/mybonus.php
200      GET       94l      692w     9851c http://transmittion.hmv/promotionlink.php
200      GET       96l      481w     7520c http://transmittion.hmv/viewrequests.php
200      GET       96l      561w     8198c http://transmittion.hmv/confirm_resend.php
200      GET       97l      524w     7770c http://transmittion.hmv/recover.php
200      GET      104l      482w     7456c http://transmittion.hmv/messages.php
200      GET      115l      595w    11229c http://transmittion.hmv/attendance.php
200      GET      124l      519w     8088c http://transmittion.hmv/task.php
200      GET      128l      791w    11414c http://transmittion.hmv/
200      GET      128l      791w    11414c http://transmittion.hmv/index.php
200      GET      140l      723w    11853c http://transmittion.hmv/usercp.php
200      GET      142l      573w     8558c http://transmittion.hmv/medal.php
200      GET      165l     1220w    18103c http://transmittion.hmv/aboutnexus.php
200      GET      171l    19076w   124534c http://transmittion.hmv/useragreement.php
200      GET      190l      367w     4873c http://transmittion.hmv/error
200      GET      204l     1110w    16530c http://transmittion.hmv/getrss.php
200      GET      215l      938w    14002c http://transmittion.hmv/subtitles.php
200      GET      275l     1190w    22036c http://transmittion.hmv/smilies.php
200      GET      275l     2086w    15816c http://transmittion.hmv/videoformats.php
200      GET      279l     1700w    15864c http://transmittion.hmv/formats.php
200      GET      287l     1605w    22130c http://transmittion.hmv/tags.php
200      GET      330l     1528w    24660c http://transmittion.hmv/torrents.php
200      GET      343l     4595w    41163c http://transmittion.hmv/rules.php
200      GET      419l     2407w    35792c http://transmittion.hmv/contactstaff.php
200      GET      635l     7278w    55734c http://transmittion.hmv/faq.php
301      GET        7l       11w      175c http://transmittion.hmv/attachments => http://transmittion.hmv/attachments/
301      GET        7l       11w      175c http://transmittion.hmv/bitbucket => http://transmittion.hmv/bitbucket/
301      GET        7l       11w      175c http://transmittion.hmv/install => http://transmittion.hmv/install/
301      GET        7l       11w      175c http://transmittion.hmv/pic => http://transmittion.hmv/pic/
301      GET        7l       11w      175c http://transmittion.hmv/styles => http://transmittion.hmv/styles/
301      GET        7l       11w      175c http://transmittion.hmv/vendor => http://transmittion.hmv/vendor/
302      GET        0l        0w        0c http://transmittion.hmv/logout.php => http://transmittion.hmv/
302      GET       12l       22w      418c http://transmittion.hmv/nexus.php => http://transmittion.hmv/nexus.php/index.php
302      GET       12l       22w      418c http://transmittion.hmv/nexus.php/ => http://transmittion.hmv/nexus.php/index.php
405      GET       24l      117w     1011c http://transmittion.hmv/oauth/token
405      GET       24l      117w     1011c http://transmittion.hmv/web/token/add
405      GET       24l      117w     1011c http://transmittion.hmv/web/token/del
500      GET        0l        0w        0c http://transmittion.hmv/page.php
500      GET       32l      137w     6609c http://transmittion.hmv/oauth/authorize
```

Most of the links require higher level of access and are locked out, 300 codes are Forbidden and 400 codes fail without proper request

![writeup-13.png](/assets/pentest/hackmyvm/transmission/writeup-13.png)